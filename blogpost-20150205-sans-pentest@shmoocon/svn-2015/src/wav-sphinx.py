#!/usr/bin/env python
#-*- coding: utf-8 -*-

import os
import sys
import pocketsphinx as ps
import sphinxbase

def decodeSpeech(hmmd, lmdir, dictp, wavfile):
	speechRec = ps.Decoder(hmm = hmmd, lm = lmdir, dict = dictp)
	wavFile = file(wavfile, 'rb')
	wavFile.seek(44)
	speechRec.decode_raw(wavFile)
	result = speechRec.get_hyp()
	return result[0]

if __name__ == "__main__":
	basedir = "/usr/share/pocketsphinx/model"
	hmdir = "%s/hmm/wsj1"%basedir
	lmd = "%s/lm/wsj/wlist5o.3e-7.vp.tg.lm.DMP"%basedir
	dictd = "%s/lm/wsj/wlist5o.dic"%basedir
	wavfile = sys.argv[1]
	print decodeSpeech(hmdir,lmd,dictd,wavfile)
