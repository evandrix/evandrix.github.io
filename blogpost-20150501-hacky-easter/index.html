<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta http-equiv="content-type" content="text/html; charset=UTF-8">
	<title>20150501: Hacky Easter - writeup</title>
	<link rel="stylesheet" type="text/css" href="../all.min.css">
	<link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Ubuntu+Mono:400">
	<link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Open+Sans">
	<link rel="stylesheet" type="text/css" href="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/styles/default.min.css">
	<style type="text/css">
		ul >li:before {content: '-';position: absolute;margin-left: -.7em;}
		.qn>a>u {color: #000;}
		a {color: blue !important;}
	</style>
</head>
<body>
	<div id="content">
		<div id="post">
		<h1><a href="http://www.timeanddate.com/worldclock/fixedtime.html?iso=20150430T1600">20150501</a>: <a href="http://hackyeaster.hacking-lab.com/hackyeaster/challenges.html">Hacky Easter 2015</a> - writeup</h1>
		<div id="postinfo">
			<div id="postdate"></div>
			<div id="posttags">tags: netsec, ctf, hacking-lab, 2015</div>
		</div>
		<div id="postbody">
<center>
	<i>QR code decoder <a href="http://zxing.org/w/decode.jspx">online</a></i>
	<br>
	<i>keys are all in lowercase only</i>
</center>
<ol>
	<li id="qn1" class="qn"><u>Puzzword</u></li>
<pre style="padding:.5em;">
Search out the password in the image
</pre>
<img src="img/lvl01.jpg">
	<ul>
		<li class="dash">anagram(missing letters {<code>a,c,e,h,k,r,z</code>}) = <code class="ans">hackerz</code></li>
	</ul>

	<hr class="print-hidden"><li id="qn2" class="qn print-before"><a href="http://hackyeaster.hacking-lab.com/hackyeaster/challenge02.html"><u>It's in the Media</u></a></li>
<pre class="wrap" style="padding:.5em;">
New York Times, March 12 2015
An Easter Egg of the famous Hacky Easter white-hat hacking competition, was leaked last Tuesday by the famous hacker group "Bunnonymous". Experts confirmed its authenticity, but could not crack the code hidden it in yet.

Can you do better?
</pre>
<style type="text/css">
.mediaEgg {background-image: url("img/egg_02_plain.png");}
.eggImage {height: 240px;width: 240px;background-size: 240px 240px;}
.h {display: none;}
.o2 {height: 4%; width: 4%; background: #000;}
.i3 {height: 4%; width: 4%; background: #fff;}
.l1 {height: 4%; width: 4%; background: #000;}
.x5 {height: 4%; width: 4%; background: #fff;/*#000;*/}
@media print {
	body {-webkit-print-color-adjust: exact;}
	.h {display: block;}
	.x5 {height: 4%; width: 4%; background: #000;}
}
</style>
<div class="eggImage mediaEgg"><table style="position: relative; left: 82px; top: 108px; width:75px; height:75px;"><tr><td class="o2"></td><td class="o2"></td><td class="o2"></td><td class="o2"></td><td class="o2"></td><td class="o2"></td><td class="o2"></td><td class="i3"></td><td class="o2"></td><td class="i3"></td><td class="i3"></td><td class="o2"></td><td class="o2"></td><td class="i3"></td><td class="o2"></td><td class="o2"></td><td class="i3"></td><td class="i3"></td><td class="o2"></td><td class="o2"></td><td class="o2"></td><td class="o2"></td><td class="o2"></td><td class="o2"></td><td class="o2"></td></tr><tr><td class="o2"></td><td class="i3"></td><td class="i3"></td><td class="i3"></td><td class="i3"></td><td class="i3"></td><td class="o2"></td><td class="i3"></td><td class="i3"></td><td class="o2"></td><td class="o2"></td><td class="o2"></td><td class="o2"></td><td class="o2"></td><td class="i3"></td><td class="i3"></td><td class="o2"></td><td class="i3"></td><td class="o2"></td><td class="i3"></td><td class="i3"></td><td class="i3"></td><td class="i3"></td><td class="i3"></td><td class="o2"></td></tr><tr><td class="o2"></td><td class="i3"></td><td class="o2"></td><td class="o2"></td><td class="o2"></td><td class="i3"></td><td class="o2"></td><td class="i3"></td><td class="o2"></td><td class="i3"></td><td class="o2"></td><td class="i3"></td><td class="o2"></td><td class="o2"></td><td class="i3"></td><td class="i3"></td><td class="i3"></td><td class="i3"></td><td class="o2"></td><td class="i3"></td><td class="o2"></td><td class="o2"></td><td class="o2"></td><td class="i3"></td><td class="o2"></td></tr><tr><td class="o2"></td><td class="i3"></td><td class="o2"></td><td class="o2"></td><td class="o2"></td><td class="i3"></td><td class="o2"></td><td class="i3"></td><td class="i3"></td><td class="i3"></td><td class="o2"></td><td class="i3"></td><td class="i3"></td><td class="o2"></td><td class="i3"></td><td class="i3"></td><td class="o2"></td><td class="i3"></td><td class="o2"></td><td class="i3"></td><td class="o2"></td><td class="o2"></td><td class="o2"></td><td class="i3"></td><td class="o2"></td></tr><tr><td class="o2"></td><td class="i3"></td><td class="o2"></td><td class="o2"></td><td class="o2"></td><td class="i3"></td><td class="o2"></td><td class="i3"></td><td class="i3"></td><td class="i3"></td><td class="i3"></td><td class="o2"></td><td class="o2"></td><td class="o2"></td><td class="i3"></td><td class="o2"></td><td class="i3"></td><td class="i3"></td><td class="o2"></td><td class="i3"></td><td class="o2"></td><td class="o2"></td><td class="o2"></td><td class="i3"></td><td class="o2"></td></tr><tr><td class="o2"></td><td class="i3"></td><td class="i3"></td><td class="i3"></td><td class="i3"></td><td class="i3"></td><td class="o2"></td><td class="i3"></td><td class="o2"></td><td class="i3"></td><td class="i3"></td><td class="o2"></td><td class="i3"></td><td class="o2"></td><td class="o2"></td><td class="i3"></td><td class="i3"></td><td class="i3"></td><td class="o2"></td><td class="i3"></td><td class="i3"></td><td class="i3"></td><td class="i3"></td><td class="i3"></td><td class="o2"></td></tr><tr><td class="o2"></td><td class="o2"></td><td class="o2"></td><td class="o2"></td><td class="o2"></td><td class="o2"></td><td class="o2"></td><td class="i3"></td><td class="x5"></td><td class="i3"></td><td class="x5"></td><td class="i3"></td><td class="x5"></td><td class="i3"></td><td class="x5"></td><td class="i3"></td><td class="x5"></td><td class="i3"></td><td class="o2"></td><td class="o2"></td><td class="o2"></td><td class="o2"></td><td class="o2"></td><td class="o2"></td><td class="o2"></td></tr><tr><td class="i3"></td><td class="i3"></td><td class="i3"></td><td class="i3"></td><td class="i3"></td><td class="i3"></td><td class="i3"></td><td class="i3"></td><td class="i3"></td><td class="o2"></td><td class="i3"></td><td class="i3"></td><td class="l1"></td><td class="i3"></td><td class="i3"></td><td class="l1"></td><td class="o2"></td><td class="i3"></td><td class="i3"></td><td class="i3"></td><td class="i3"></td><td class="i3"></td><td class="i3"></td><td class="i3"></td><td class="i3"></td></tr><tr><td class="o2"></td><td class="i3"></td><td class="o2"></td><td class="i3"></td><td class="i3"></td><td class="i3"></td><td class="o2"></td><td class="o2"></td><td class="i3"></td><td class="l1"></td><td class="o2"></td><td class="i3"></td><td class="o2"></td><td class="i3"></td><td class="l1"></td><td class="i3"></td><td class="x5"></td><td class="l1"></td><td class="i3"></td><td class="o2"></td><td class="i3"></td><td class="i3"></td><td class="o2"></td><td class="i3"></td><td class="o2"></td></tr><tr><td class="i3"></td><td class="o2"></td><td class="o2"></td><td class="o2"></td><td class="i3"></td><td class="o2"></td><td class="i3"></td><td class="o2"></td><td class="x5"></td><td class="l1"></td><td class="i3"></td><td class="l1"></td><td class="o2"></td><td class="x5"></td><td class="l1"></td><td class="i3"></td><td class="x5"></td><td class="o2"></td><td class="x5"></td><td class="o2"></td><td class="i3"></td><td class="i3"></td><td class="i3"></td><td class="o2"></td><td class="o2"></td></tr><tr><td class="o2"></td><td class="i3"></td><td class="o2"></td><td class="o2"></td><td class="i3"></td><td class="o2"></td><td class="o2"></td><td class="o2"></td><td class="i3"></td><td class="l1"></td><td class="i3"></td><td class="x5"></td><td class="l1"></td><td class="x5"></td><td class="i3"></td><td class="o2"></td><td class="l1"></td><td class="x5"></td><td class="i3"></td><td class="o2"></td><td class="o2"></td><td class="i3"></td><td class="o2"></td><td class="o2"></td><td class="o2"></td></tr><tr><td class="o2"></td><td class="o2"></td><td class="o2"></td><td class="o2"></td><td class="i3"></td><td class="o2"></td><td class="i3"></td><td class="o2"></td><td class="x5"></td><td class="x5"></td><td class="x5"></td><td class="i3"></td><td class="i3"></td><td class="i3"></td><td class="x5"></td><td class="i3"></td><td class="i3"></td><td class="x5"></td><td class="i3"></td><td class="o2"></td><td class="i3"></td><td class="o2"></td><td class="i3"></td><td class="o2"></td><td class="o2"></td></tr><tr><td class="o2"></td><td class="i3"></td><td class="o2"></td><td class="i3"></td><td class="i3"></td><td class="i3"></td><td class="o2"></td><td class="o2"></td><td class="i3"></td><td class="o2"></td><td class="o2"></td><td class="o2"></td><td class="i3"></td><td class="o2"></td><td class="o2"></td><td class="i3"></td><td class="o2"></td><td class="o2"></td><td class="o2"></td><td class="i3"></td><td class="i3"></td><td class="o2"></td><td class="i3"></td><td class="o2"></td><td class="o2"></td></tr><tr><td class="i3"></td><td class="i3"></td><td class="o2"></td><td class="i3"></td><td class="o2"></td><td class="o2"></td><td class="i3"></td><td class="o2"></td><td class="i3"></td><td class="i3"></td><td class="i3"></td><td class="i3"></td><td class="i3"></td><td class="o2"></td><td class="i3"></td><td class="o2"></td><td class="o2"></td><td class="o2"></td><td class="o2"></td><td class="i3"></td><td class="i3"></td><td class="o2"></td><td class="o2"></td><td class="i3"></td><td class="o2"></td></tr><tr><td class="o2"></td><td class="o2"></td><td class="o2"></td><td class="o2"></td><td class="i3"></td><td class="i3"></td><td class="o2"></td><td class="i3"></td><td class="i3"></td><td class="o2"></td><td class="o2"></td><td class="o2"></td><td class="i3"></td><td class="i3"></td><td class="i3"></td><td class="o2"></td><td class="o2"></td><td class="o2"></td><td class="i3"></td><td class="o2"></td><td class="i3"></td><td class="o2"></td><td class="o2"></td><td class="i3"></td><td class="o2"></td></tr><tr><td class="i3"></td><td class="i3"></td><td class="o2"></td><td class="o2"></td><td class="i3"></td><td class="i3"></td><td class="i3"></td><td class="i3"></td><td class="i3"></td><td class="o2"></td><td class="o2"></td><td class="i3"></td><td class="i3"></td><td class="o2"></td><td class="i3"></td><td class="i3"></td><td class="o2"></td><td class="i3"></td><td class="i3"></td><td class="i3"></td><td class="o2"></td><td class="o2"></td><td class="i3"></td><td class="o2"></td><td class="o2"></td></tr><tr><td class="o2"></td><td class="o2"></td><td class="o2"></td><td class="i3"></td><td class="o2"></td><td class="o2"></td><td class="o2"></td><td class="i3"></td><td class="i3"></td><td class="i3"></td><td class="o2"></td><td class="o2"></td><td class="o2"></td><td class="o2"></td><td class="i3"></td><td class="o2"></td><td class="o2"></td><td class="o2"></td><td class="o2"></td><td class="o2"></td><td class="o2"></td><td class="o2"></td><td class="o2"></td><td class="i3"></td><td class="o2"></td></tr><tr><td class="i3"></td><td class="i3"></td><td class="i3"></td><td class="i3"></td><td class="i3"></td><td class="i3"></td><td class="i3"></td><td class="i3"></td><td class="o2"></td><td class="i3"></td><td class="i3"></td><td class="i3"></td><td class="o2"></td><td class="i3"></td><td class="i3"></td><td class="o2"></td><td class="o2"></td><td class="i3"></td><td class="i3"></td><td class="i3"></td><td class="o2"></td><td class="o2"></td><td class="i3"></td><td class="i3"></td><td class="i3"></td></tr><tr><td class="o2"></td><td class="o2"></td><td class="o2"></td><td class="o2"></td><td class="o2"></td><td class="o2"></td><td class="o2"></td><td class="i3"></td><td class="o2"></td><td class="i3"></td><td class="o2"></td><td class="i3"></td><td class="o2"></td><td class="o2"></td><td class="o2"></td><td class="o2"></td><td class="o2"></td><td class="i3"></td><td class="o2"></td><td class="i3"></td><td class="o2"></td><td class="i3"></td><td class="o2"></td><td class="i3"></td><td class="o2"></td></tr><tr><td class="o2"></td><td class="i3"></td><td class="i3"></td><td class="i3"></td><td class="i3"></td><td class="i3"></td><td class="o2"></td><td class="i3"></td><td class="i3"></td><td class="i3"></td><td class="o2"></td><td class="o2"></td><td class="o2"></td><td class="i3"></td><td class="o2"></td><td class="o2"></td><td class="o2"></td><td class="i3"></td><td class="i3"></td><td class="i3"></td><td class="o2"></td><td class="o2"></td><td class="i3"></td><td class="i3"></td><td class="i3"></td></tr><tr><td class="o2"></td><td class="i3"></td><td class="o2"></td><td class="o2"></td><td class="o2"></td><td class="i3"></td><td class="o2"></td><td class="i3"></td><td class="i3"></td><td class="o2"></td><td class="o2"></td><td class="i3"></td><td class="i3"></td><td class="o2"></td><td class="o2"></td><td class="o2"></td><td class="o2"></td><td class="o2"></td><td class="o2"></td><td class="o2"></td><td class="o2"></td><td class="o2"></td><td class="i3"></td><td class="i3"></td><td class="o2"></td></tr><tr><td class="o2"></td><td class="i3"></td><td class="o2"></td><td class="o2"></td><td class="o2"></td><td class="i3"></td><td class="o2"></td><td class="i3"></td><td class="i3"></td><td class="o2"></td><td class="o2"></td><td class="i3"></td><td class="i3"></td><td class="o2"></td><td class="o2"></td><td class="o2"></td><td class="o2"></td><td class="i3"></td><td class="i3"></td><td class="i3"></td><td class="o2"></td><td class="i3"></td><td class="i3"></td><td class="o2"></td><td class="i3"></td></tr><tr><td class="o2"></td><td class="i3"></td><td class="o2"></td><td class="o2"></td><td class="o2"></td><td class="i3"></td><td class="o2"></td><td class="i3"></td><td class="o2"></td><td class="i3"></td><td class="o2"></td><td class="o2"></td><td class="i3"></td><td class="i3"></td><td class="i3"></td><td class="o2"></td><td class="o2"></td><td class="i3"></td><td class="i3"></td><td class="i3"></td><td class="o2"></td><td class="i3"></td><td class="i3"></td><td class="o2"></td><td class="o2"></td></tr><tr><td class="o2"></td><td class="i3"></td><td class="i3"></td><td class="i3"></td><td class="i3"></td><td class="i3"></td><td class="o2"></td><td class="i3"></td><td class="i3"></td><td class="o2"></td><td class="o2"></td><td class="i3"></td><td class="i3"></td><td class="o2"></td><td class="i3"></td><td class="o2"></td><td class="o2"></td><td class="i3"></td><td class="o2"></td><td class="o2"></td><td class="o2"></td><td class="i3"></td><td class="i3"></td><td class="i3"></td><td class="i3"></td></tr><tr><td class="o2"></td><td class="o2"></td><td class="o2"></td><td class="o2"></td><td class="o2"></td><td class="o2"></td><td class="o2"></td><td class="i3"></td><td class="o2"></td><td class="i3"></td><td class="i3"></td><td class="o2"></td><td class="o2"></td><td class="o2"></td><td class="i3"></td><td class="i3"></td><td class="o2"></td><td class="i3"></td><td class="o2"></td><td class="i3"></td><td class="o2"></td><td class="i3"></td><td class="i3"></td><td class="i3"></td><td class="o2"></td></table></div>
	<ul>
		<li class="dash">QR code != <code>img</code>, but = HTML <code>table</code></li>
		<li class="dash">clue in puzzle title: &quot;<u>media</u>&quot; ie. CSS <code>@media</code></li>
		<li class="dash">inspect CSS styling in HTML src <code>style</code>: <code>class='h5'</code> styled differently when page is printed</li>
<pre><code>&#8230;
.x5 { height: 4%; width: 4%; background: <font color=red>#fff</font>;}
@media print {
	&#x2026;
	.x5 { height: 4%; width: 4%; background: <font color=red>#000</font>;}
}</code></pre>
		<li class="dash ans">simply <u>print</u> the page to reveal QR code for this level</li>
	</ul>

	<hr class="print-hidden"><li id="qn3" class="qn print-before"><a href="http://hackyeaster.hacking-lab.com/hackyeaster/challenge03.html"><u>Lego Stego</u></a></li>
<pre class="wrap" style="padding:.5em;">
You intercepted a message sent by a nerd from the office nearby. On first sight, there's nothing suspicious in it. However, you are almost sure that something secret must be hidden in it. Can you find out what?

<a href="file/legostego.lxf">legostego.lxf</a>
</pre>
	<ul>
		<li class="dash">fmt: <code>.lxf</code> &dash; open-with: <a href="http://ldd.lego.com/en-us/download">LEGO Digital Designer</a></li>
		<li class="dash">obs. 3 layers present <a href="file/legostego-blank.lxf"><img src="img/lvl03-3layers.png"></a></li>
		<li class="dash ans">QR code in *mid* layer ie. strip off top layer</li>
		<li class="dash none"><a href="file/legostego-qrcode.lxf"><img src="img/challenge03-vpmP0wgxXAdKDGAjdbn6.png"></a></li>
	</ul>

	<hr class="print-hidden"><li id="qn4" class="qn print-before"><a href="http://hackyeaster.hacking-lab.com/hackyeaster/challenge04.html"><u>Twisted Num63rs</u></a> (<a href="file/ps.hacking.hackyeaster.android.apk">mobile</a>)</li>
	@ <code>/assets/www/challenge04.html</code>:
	<pre class="wrap" style="padding:.5em;">
	Calculate/convert the following values, and sort them in <u>ascending</u> order
	</pre>
	<table class="full-width" cellpadding="0" cellspacing="0" height="auto"><tbody><tr>
	<td width="50%">
	<ol>
		<li>10101111000</li>
		<li>8 YiB [bytes]</li>
		<li>Speed of Light [m/s]</li>
		<li>127.0.0.1 as integer</li>
		<li>&Pi;<sup>&Pi;</sup></li>
		<li>java.lang.Integer.MAX_VALUE</li>
		<li>13 MiB [bytes]</li>
		<li>2<sup>20</sup></li>
		<li>ZmlmdHk=</li>
		<li>sqrt(1296)</li>
		<li>303240<sub>8</sub></li>
		<li>Middle C [Hz]</li>
	</ol>
	</td><td>
	<ol>
		<li data-val="1400">bin2dec: 1400</li>
		<li data-val="9671406559999999577423872">8 yobibytes = 9.67140656 &times; 10<sup>24</sup> bytes</li>
		<li data-val="299792458">299792458 m/s</li>
		<li data-val="2130706433">2130706433</li>
		<li data-val="36.4621596072">&#8776; 36.4621596072</li>
		<li data-val="2147483647">2147483647</li>
		<li data-val="13631488">13631488 bytes</li>
		<li data-val="1048576">1048576</li>
		<li data-val="50">base64_decode("ZmlmdHk=")=fifty=50</li>
		<li data-val="36">36</li>
		<li data-val="100000">100000</li>
		<li data-val="261.626">261.626 Hz</li>
	</ol>
	</td>
	</tr>
	</tbody>
	</table>
	<ul>
		<li class="dash none"><code>xs = [1400,9671406559999999577423872,299792458,2130706433,36.4621596072,2147483647,13631488,1048576,50,36,100000,261.626]</code></li>
		<li class="dash none"><code>sorted(zip(xs,xrange(1,len(xs)+1)))</code></li>
		<li class="dash">sorted in ascending order:</li>
			<ol>
				<li value="10" data-val="36">36</li>
				<li value="5" data-val="36.4621596072">36.4621596072</li>
				<li value="9" data-val="50">50</li>
				<li value="12" data-val="261.626">261.626</li>
				<li value="1" data-val="1400">1400</li>
				<li value="11" data-val="100000">100000</li>
				<li value="8" data-val="1048576">1048576</li>
				<li value="7" data-val="13631488">13631488</li>
				<li value="3" data-val="299792458">299792458</li>
				<li value="4" data-val="2130706433">2130706433</li>
				<li value="6" data-val="2147483647">2147483647</li>
				<li value="2" data-val="9671406559999999577423872">9.67140656 &times; 10<sup>24</sup></li>
			</ol>
		<li class="dash">extract original indices:</li>
		<li class="dash none"><code>map(lambda (x,y): y, sorted(zip(xs,xrange(1,len(xs)+1))))</code></li>
		<li class="dash none"><code>var h = "<font class="ans">10,5,9,12,1,11,8,7,3,4,6,2</font>";</code></li>
		<li class="dash none"><code>for (var i=0; i<10000; i++) {h = CryptoJS.SHA1(h);} decryptScrambledEggWithKey('' + h);</code>&#x2026;</li>
	</ul>

	<hr class="print-hidden"><li id="qn5" class="qn print-before"><a href="http://hackyeaster.hacking-lab.com/hackyeaster/challenge05.html"><u>Phone Fumbling</u></a> (<a href="file/ps.hacking.hackyeaster.android.apk">mobile</a>)</li>
<pre class="wrap" style="padding:.5em;">
In this challenge, you need to play with your phone a bit. Try to find out what controls the four bars, and make them reach the full width (all at the same time).
</pre>
	<ul>
		<li class="dash">extract &amp; decompile APK</li>
		<li class="dash none">@ <code>/assets/www/challenge05.html</code>:</li>
		<ul>
			<li class="dash"><code>requestLevels</code> is invoked every 1000ms to query <code>ps://sensors</code> endpt</li>
			<li class="dash"><code>sensorFeedback(json)</code> sets lvls by parsing JSON response vars <code>{l1,l2,l3,l4,k}</code></li>
		</ul>
<pre style="padding:.5em;"><code>&#8230;
function requestLevels() {
	window.location.href="<font color="red">ps://sensors</font>";
}
&#x2026;
function sensorFeedback(json) {
	var jsonResp = JSON.parse(json);
	setLevel(1, jsonResp.l1);
	setLevel(2, jsonResp.l2);
	setLevel(3, jsonResp.l3);
	setLevel(4, jsonResp.l4);
	if (jsonResp.k) {
		decryptScrambledEggWithKey(jsonResp.k);
		clearInterval(intervalId);
	}
}
var intervalId = setInterval(requestLevels, 1000);</code></pre>
		<li class="dash"><code>ps://sensors</code> is mentioned @<code>/src/ps/hacking/hackyeaster/android/c.java</code></li>
<pre style="padding:.5em;"><code>&#8230;
if ("ps://sensors".equals(s))
{
	<font color="red">Activity.e(a);</font>
	return true;
}
&#x2026;</code></pre>
		<li class="dash"><code>static e(Activity a)</code> is defined @ <code>/src/ps/hacking/hackyeaster/android/Activity.java</code></li>
<pre class="wrap" style="padding:.5em;word-wrap:break-word;"><code>private SensorManager g;
&#8230;
static void e(Activity activity)
{
	activity.d();
}
&#8230;
private void d()
{
	<font color="red">h = g.getDefaultSensor(1); //TYPE_ACCELEROMETER
	i = g.getDefaultSensor(2); //TYPE_MAGNETIC_FIELD</font>
	g.registerListener(this, h, 0);
	g.registerListener(this, i, 0);
	&#x2026;
}
&#8230;
public int c()
{
	Intent intent = registerReceiver(null, new IntentFilter("<font color="red">android.intent.action.BATTERY_CHANGED</font>")); //current battery level
	int i1 = intent.getIntExtra("level", -1);
	int j1 = intent.getIntExtra("scale", -1);
	if (i1 == -1 || j1 == -1)
	{
		return 50;
	} else
	{
		return Math.round((i1 * 100) / j1); // to %
	}
}
&#8230;
private void j()
{
	int i1 = 100;
	if (l == null || m == null) goto _L2; else goto _L1
_L1:
	float af[] = new float[9];
	if (!SensorManager.getRotationMatrix(af, new float[9], l, m)) goto _L2; else goto _L3
_L3:
	float af1[] = new float[3];
	SensorManager.getOrientation(af, af1);
	<font color="red">int j1 = 5 * (int)Math.ceil((double)((int)(System.currentTimeMillis() / 1000L) % 100) / 5D);</font>
	int k1 = Math.round(100F * (Math.abs(af1[1]) + Math.abs(af1[2])));
	int l1;
	int i2;
	int j2;
	int k2;
	String s;
	String s1;
	MessageDigest messagedigest;
	String s2;
	if (k1 &lt;= 20)
	{
		l1 = i1;
	} else
	if (k1 &gt; 300)
	{
		l1 = 0;
	} else
	{
		l1 = Math.round((100 * (300 - k1)) / 280);
	}
	i2 = Math.round(100F * Math.abs(af1[0]));
	if (i2 &lt;= 20)
	{
		j2 = i1;
	} else
	{
		j2 = 0;
		if (i2 &lt;= 300)
		{
			j2 = Math.round((100 * (300 - i2)) / 280);
		}
	}
	k2 = <font color="red">c()</font>;
	Exception exception;
	if (k2 &lt; 95)
	{
		i1 = k2;
	}
	s = "";
	if (i1 + (j2 + (j1 + l1)) != 400)
	{
		break MISSING_BLOCK_LABEL_246;
	}
	s1 = (new StringBuilder(String.valueOf(j1))).append("f").append(l1).append("u").append(j2).append("n").append(i1).toString();
	messagedigest = MessageDigest.getInstance("SHA1");
	messagedigest.update(s1.getBytes());
	s2 = Base64.encodeToString(messagedigest.digest(), 2);
	s = s2;
_L5:
	<u>a.loadUrl((new StringBuilder("javascript:sensorFeedback('{\"k\": \"")).append(s).append("\", \"l1\": ").append(j1).append(", \"l2\": ").append(l1).append(", \"l3\": ").append(j2).append(", \"l4\": ").append(i1).append("}')").toString());</u>
	l = null;
	m = null;
_L2:
	return;
	exception;
	if (true) goto _L5; else goto _L4
_L4:
}
&#8230;
public void onSensorChanged(SensorEvent sensorevent)
{
	if (sensorevent.sensor.getType() == 1) //TYPE_ACCELEROMETER
	{
		l = sensorevent.values;
		g.unregisterListener(this, h);
		h = null;
	}
	if (sensorevent.sensor.getType() == 2) //TYPE_MAGNETIC_FIELD
	{
		m = sensorevent.values;
		g.unregisterListener(this, i);
		i = null;
	}
	<font color="red">j()</font>;
}
&#x2026;</code></pre>
		<li class="dash"><code>Activity: e(a) &rarr; d() &rarr; callback-onSensorChanged() &rarr; j() &rarr; c() &rarr; ret</code></li>
		<li class="dash">mapping: <code>sensorFeedback({k: s, l1: j1, l2: l1, l3: j2, l4: i1})</code>, where:</li>
		<ul>
			<li class="dash"><code>s</code> &#61; <code>base64(SHA1(j1+&quot;f&quot;+l1+&quot;u&quot;+j2+&quot;n&quot;+i1))</code></li>
		</ul>
	</ul>
	<ol>
		<li><code class="ans">Current time</code></li>
		<li><code class="ans">Accelerometer</code></li>
		<li><code class="ans">Compass</code></li>
		<li><code class="ans">Battery percentage</code></li>
	</ol>

	<hr class="print-hidden"><li id="qn6" class="qn print-before"><a href="http://hackyeaster.hacking-lab.com/hackyeaster/challenge06.html"><u>Hack to the Future</u></a></li>
<pre class="wrap" style="padding:.5em;">
The Doc's in trouble again, and you must come to his rescue! As you jump into his time machine, you realize that a password is needed to start it. Just in that moment of despair, you receive an audio message from the Doc, through space and time:

<code>dah-dah-dit dit dah-dah-dah di-dah-dit dah-dah-dit dit dah-dah dah-di-dah-dit di-di-dah-dit di-dah-di-dit dah-di-dah-dah</code>
</pre>
	<ul>
		<li class="dash none"><u>Python Morse code decoder</u></li>
<pre class="wrap" style="padding:.5em;"><code>morse_rev = {"dah": "T", "dah-dah": "M", "dah-dah-dah": "O", "dah-dah-dit": "G", "dah-dah-dit-dah": "Q", "dah-dah-dit-dit": "Z", "dah-dit": "N", "dah-dit-dah": "K", "dah-di-dah-dah": "Y", "dah-di-dah-dit": "C", "dah-dit-dit": "D", "dah-dit-dit-dah": "X", "dah-dit-dit-dit": "B", "dit": "E", "dit-dah": "A", "dit-dah-dah": "W", "dit-dah-dah-dah": "J", "dit-dah-dah-dit": "P", "di-dah-dit": "R", "di-dah-di-dit": "L", "dit-dit": "I", "dit-dit-dah": "U", "di-di-dah-dit": "F", "dit-dit-dit": "S", "dit-dit-dit-dah": "V", "dit-dit-dit-dit": "H"}
ms = "dah-dah-dit dit dah-dah-dah di-dah-dit dah-dah-dit dit dah-dah dah-di-dah-dit di-di-dah-dit di-dah-di-dit dah-di-dah-dah"
print "".join(morse_rev[m] for m in ms.split()).lower()</code></pre>
		<li class="dash"><code>georgemcfly</code></li>
		<li class="dash">not quite done yet! enter <code>georgemcfly</code> into Egg-O-Matic performs a HTTP GET request to <a href="http://hackyeaster.hacking-lab.com/hackyeaster/time?m=4&k=georgemcfly">http://hackyeaster.hacking-lab.com/hackyeaster/time?m=4&amp;k=georgemcfly</a></li>
		<li class="dash none">rendering: <img src="img/lvl06-georgemcfly.png" style="vertical-align:middle;"></li>
		<li class="dash">so need to modify HTTP GET param <code>m</code>, according to given hint in img, by +3 ie. <code>m=7</code></li>
		<li class="dash none"><code class="ans">curl -sL "http://hackyeaster.hacking-lab.com/hackyeaster/time?m=7&amp;k=georgemcfly" | jq -r '.egg' | base64 -d</code>
	</ul>

	<hr class="print-hidden"><li id="qn7" class="qn print-before"><a href="http://hackyeaster.hacking-lab.com/hackyeaster/challenge07.html"><u>Vista de la Calle</u></a> (<a href="file/ps.hacking.hackyeaster.android.apk">mobile</a>)</li>
<pre class="wrap" style="padding:.5em;">
This egg is hidden in a street-view like viewer. Peek around the area and find it!
</pre>
	<ul>
		<li class="dash">extract &amp; decompile APK reveals:
		<ul>
			<li class="dash">query <code>ps://panorama</code> endpt</li>
			<li class="dash">usage of <a href="https://code.google.com/p/panoramagl-android/">PanoramaGL Library</a></li>
		</ul></li>
		<li class="dash">QR code @ <code class="ans">/res/raw/quito2_u.jpg</code></li>
	</ul>


	<hr class="print-hidden"><li id="qn8" class="qn print-before"><a href="http://hackyeaster.hacking-lab.com/hackyeaster/challenge08.html"><u>Spread the Sheet</u></a></li>
<pre class="wrap" style="padding:.5em;">
This egg is hidden within an online spreadsheet. Go find it's URL, and extract the egg out of it.

Spreadsheet ID:
<div style="text-indent: 1em"><code>1QPkfrnSVRAhQKL7AZx_HVXWrRXDvwCnVX2ih0jYp1CA</code></div>
<img src="img/spreadsheet.png">
</pre>
	<ul>
		<li class="dash none">@ <a href="https://docs.google.com/spreadsheets/d/1QPkfrnSVRAhQKL7AZx_HVXWrRXDvwCnVX2ih0jYp1CA">https://docs.google.com/spreadsheets/d/1QPkfrnSVRAhQKL7AZx_HVXWrRXDvwCnVX2ih0jYp1CA</a></li>
<style type="text/css">
	#lvl8 {max-width: 100%;background-color: transparent;table-layout: fixed;width: 100%;text-align: center;}
	#lvl8 th, #lvl8 td:first-child {font-weight: bold;color: red;}
	#lvl8, #lvl8 th, #lvl8 td {border: 1px solid #000;}
</style>
<table id="lvl8" border="1" cellpadding="1" cellspacing="1"><tbody><tr><th>0</th><th>19</th><th>3</th><th>22</th><th>4</th><th>11</th><th>20</th><th>6</th><th>1</th><th>9</th><th>25</th><th>10</th><th>23</th><th>5</th><th>12</th><th>13</th><th>7</th><th>15</th><th>16</th><th>17</th><th>18</th><th>14</th><th>21</th><th>8</th><th>2</th><th>24</th></tr><tr><td>3</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>0</td><td>0</td><td>1</td><td>0</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>0</td><td>1</td><td>1</td><td>0</td><td>1</td><td>0</td><td>0</td><td>1</td><td>0</td><td>0</td><td>0</td></tr><tr><td>19</td><td>1</td><td>1</td><td>0</td><td>1</td><td>0</td><td>0</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>0</td><td>1</td><td>1</td><td>1</td><td>1</td><td>0</td><td>0</td><td>1</td><td>0</td><td>0</td><td>1</td><td>0</td><td>1</td><td>1</td></tr><tr><td>10</td><td>0</td><td>1</td><td>0</td><td>1</td><td>0</td><td>1</td><td>0</td><td>1</td><td>0</td><td>0</td><td>1</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>1</td><td>0</td><td>1</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td></tr><tr><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>0</td><td>1</td><td>1</td><td>1</td><td>0</td><td>1</td><td>1</td><td>1</td><td>1</td><td>0</td><td>0</td><td>1</td><td>1</td><td>1</td><td>1</td><td>0</td><td>0</td><td>1</td><td>0</td><td>1</td><td>1</td></tr><tr><td>21</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>0</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>0</td><td>1</td><td>0</td><td>1</td><td>1</td><td>1</td><td>0</td><td>1</td><td>0</td><td>0</td><td>1</td></tr><tr><td>22</td><td>1</td><td>1</td><td>0</td><td>1</td><td>1</td><td>0</td><td>0</td><td>1</td><td>1</td><td>1</td><td>0</td><td>0</td><td>1</td><td>0</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>0</td><td>0</td><td>0</td><td>1</td></tr><tr><td>8</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>1</td><td>0</td><td>0</td><td>1</td><td>1</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td></tr><tr><td>16</td><td>0</td><td>1</td><td>0</td><td>0</td><td>1</td><td>1</td><td>0</td><td>1</td><td>1</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>1</td><td>0</td><td>0</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>0</td><td>0</td><td>0</td></tr><tr><td>4</td><td>1</td><td>1</td><td>1</td><td>1</td><td>0</td><td>0</td><td>0</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>0</td><td>1</td><td>0</td><td>1</td><td>1</td><td>0</td><td>1</td><td>1</td><td>0</td><td>0</td><td>0</td></tr><tr><td>2</td><td>1</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>1</td><td>1</td><td>1</td><td>1</td><td>0</td><td>0</td><td>1</td><td>1</td><td>1</td><td>0</td><td>1</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td></tr><tr><td>12</td><td>0</td><td>1</td><td>0</td><td>1</td><td>1</td><td>0</td><td>0</td><td>1</td><td>0</td><td>0</td><td>1</td><td>0</td><td>0</td><td>1</td><td>0</td><td>0</td><td>1</td><td>1</td><td>1</td><td>1</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td></tr><tr><td>11</td><td>1</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>1</td><td>0</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>0</td><td>1</td><td>0</td><td>0</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td></tr><tr><td>25</td><td>0</td><td>1</td><td>1</td><td>1</td><td>0</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>0</td><td>0</td><td>1</td><td>0</td><td>1</td><td>1</td><td>1</td><td>0</td><td>0</td><td>0</td><td>0</td><td>1</td><td>0</td><td>1</td><td>1</td></tr><tr><td>24</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>1</td><td>0</td><td>1</td><td>1</td><td>1</td><td>0</td><td>0</td><td>0</td><td>0</td><td>1</td><td>1</td><td>0</td><td>0</td><td>0</td><td>1</td><td>1</td><td>1</td><td>0</td><td>0</td><td>0</td></tr><tr><td>7</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>0</td><td>1</td><td>1</td><td>0</td><td>1</td><td>1</td><td>1</td><td>0</td><td>1</td><td>0</td><td>0</td><td>1</td><td>0</td><td>1</td><td>1</td></tr><tr><td>20</td><td>0</td><td>0</td><td>0</td><td>0</td><td>1</td><td>0</td><td>0</td><td>1</td><td>0</td><td>1</td><td>0</td><td>0</td><td>0</td><td>1</td><td>0</td><td>1</td><td>1</td><td>0</td><td>1</td><td>0</td><td>0</td><td>1</td><td>0</td><td>0</td><td>0</td></tr><tr><td>5</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>0</td><td>0</td><td>1</td><td>0</td><td>1</td><td>0</td><td>1</td><td>1</td><td>0</td><td>1</td><td>1</td><td>1</td><td>0</td><td>1</td><td>0</td><td>0</td><td>1</td><td>0</td><td>0</td><td>0</td></tr><tr><td>18</td><td>0</td><td>0</td><td>1</td><td>0</td><td>1</td><td>0</td><td>0</td><td>0</td><td>1</td><td>1</td><td>1</td><td>1</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>1</td><td>1</td><td>0</td><td>0</td><td>1</td><td>0</td><td>0</td><td>0</td></tr><tr><td>14</td><td>1</td><td>0</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>0</td><td>0</td><td>1</td><td>1</td><td>0</td><td>0</td><td>1</td><td>0</td><td>0</td><td>1</td><td>1</td><td>1</td><td>1</td><td>0</td><td>1</td><td>1</td><td>1</td></tr><tr><td>13</td><td>1</td><td>0</td><td>0</td><td>0</td><td>0</td><td>1</td><td>0</td><td>1</td><td>0</td><td>1</td><td>1</td><td>0</td><td>1</td><td>1</td><td>0</td><td>1</td><td>0</td><td>1</td><td>0</td><td>1</td><td>0</td><td>1</td><td>1</td><td>0</td><td>1</td></tr><tr><td>17</td><td>1</td><td>1</td><td>0</td><td>0</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>0</td><td>1</td><td>0</td><td>1</td><td>1</td><td>1</td><td>0</td><td>1</td><td>1</td><td>0</td><td>1</td><td>0</td><td>0</td><td>0</td></tr><tr><td>23</td><td>0</td><td>1</td><td>1</td><td>1</td><td>0</td><td>1</td><td>0</td><td>1</td><td>1</td><td>1</td><td>1</td><td>0</td><td>1</td><td>0</td><td>0</td><td>1</td><td>1</td><td>1</td><td>0</td><td>0</td><td>1</td><td>0</td><td>0</td><td>0</td><td>0</td></tr><tr><td>15</td><td>1</td><td>0</td><td>1</td><td>1</td><td>1</td><td>0</td><td>0</td><td>1</td><td>0</td><td>1</td><td>0</td><td>1</td><td>1</td><td>0</td><td>0</td><td>1</td><td>1</td><td>1</td><td>0</td><td>0</td><td>1</td><td>1</td><td>0</td><td>0</td><td>0</td></tr><tr><td>6</td><td>1</td><td>0</td><td>0</td><td>0</td><td>1</td><td>0</td><td>0</td><td>1</td><td>1</td><td>1</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>1</td><td>0</td><td>1</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td></tr><tr><td>9</td><td>0</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>0</td><td>1</td><td>1</td><td>0</td><td>1</td><td>0</td><td>1</td><td>0</td><td>1</td><td>1</td><td>0</td><td>0</td><td>0</td><td>1</td><td>1</td><td>0</td><td>1</td><td>1</td><td>1</td></tr></tbody></table>
		<li class="dash"><i>task</i>: sort row + col # (highlighted in <font color="red">red</font>), together with their associated row/col entries respectively, in asc order</li>
		<li class="dash">copy/paste HTML tbl above into <code>lvl08-grid.txt</code></li>
<pre class="wrap" style="padding:.5em;"><code class="python">#!/usr/bin/env python
#-*- coding: utf-8 -*-

import sys
import codecs
from PIL import Image

sys.stdout = codecs.getwriter(&quot;utf8&quot;)(sys.stdout)
sys.stderr = codecs.getwriter(&quot;utf8&quot;)(sys.stderr)

def parse(filepath):
	row_idx, col_idx, grid = [], [], []
	with codecs.open(filepath, &quot;r&quot;, &quot;utf-8&quot;) as f:
		for i, line in enumerate(f):
			line = line.strip()
			if not line: continue
			if i == 0:
				col_idx = map(int, line.split(&quot;\t&quot;))[1:]
				col_idx = map(lambda i: i-1, col_idx)
				length = len(col_idx)
				grid = [[0 for x in xrange(length)] for x in xrange(length)]
			else:
				toks = map(int, line.split(&quot;\t&quot;))
				row_idx.append(toks[0]-1)
				toks = toks[1:]
				for j in xrange(length):
					grid[i-1][j] = toks[j]
	grid_tmp = [[0 for x in xrange(length)] for x in xrange(length)]
	for i,c in enumerate(col_idx):
		for j in xrange(length):
			grid_tmp[j][c] = grid[j][i]
	for i,r in enumerate(row_idx):
		for j in xrange(length):
			grid[r][j] = grid_tmp[i][j]
	# for i in xrange(length):
	# 	for j in xrange(length):
	# 		print&gt;&gt;sys.stderr, str(grid[i][j])+&quot;\t&quot;,
	# 	print&gt;&gt;sys.stderr
	return grid

def enlarge(grid):
	length = len(grid)
	if length &gt; 0: length = min(length, len(grid[0]))
	grid_large = [[0 for x in xrange(length*length)] for x in xrange(length*length)]
	for i in xrange(length):
		for j in xrange(length):
			for x in xrange(length):
				for y in xrange(length):
					grid_large[i*length+x][j*length+y] = grid[i][j]
	return grid_large

def save(grid, outfile):
	length = len(grid)
	if length &gt; 0: length = min(length, len(grid[0]))
	im1 = Image.new(&quot;RGB&quot;, (length,length))
	pix1 = im1.load()
	w, h = im1.size
	for i in xrange(h):
	    for j in xrange(w):
	   		pix1[j,i] = tuple([(1-grid[i][j])*255]*3)
	im1.save(outfile, outfile.split(&quot;.&quot;)[-1].upper())
	return im1

if __name__ == &quot;__main__&quot;:
	grid = parse(&quot;lvl08-grid.txt&quot;)
	grid = enlarge(grid)
	save(grid, &quot;lvl08-grid.png&quot;)
</code></pre>
	</ul>

	<hr class="print-hidden"><li id="qn9" class="qn print-before"><a href="http://hackyeaster.hacking-lab.com/hackyeaster/challenge09.html"><u>Fisheye</u></a> (<a href="file/ps.hacking.hackyeaster.android.apk">mobile</a>)</li>
<pre class="wrap" style="padding:.5em;">
Egg number nine is hidden here in the app. You've already seen it, haven't you?

Go catch it and squint like a fish.
</pre>
	<ul>
		<li class="dash">img @ <code>/res/drawable/id_launcher.png</code></li>
		<li class="dash">correct fisheye by following a <a class="print-link" href="http://classroom.synonym.com/correct-fisheye-gimp-19646.html">GIMP tutorial</a></li>
	</ul>

	<hr class="print-hidden"><li id="qn10" class="qn print-before"><a href="http://hackyeaster.hacking-lab.com/hackyeaster/challenge10.html"><u>Thumper's Den</u></a></li>
<pre class="wrap" style="padding:.5em;">
In order to get this egg, you need to search on the web site. Rumors say that Thumper himself has bagged it.
</pre>
	<ul>
		<li class="dash">under &quot;<a href="http://hackyeaster.hacking-lab.com/hackyeaster/eggs.html">Eggs</a>&quot;</li>
		<li class="dash"><u>(change)</u> name to <b>Thumper</b></li>
		<li class="dash none"><img src="img/lvl10.png"></li>
	</ul>
	<hr class="print-hidden"><li id="qn11" class="qn print-before"><a href="http://hackyeaster.hacking-lab.com/hackyeaster/challenge11.html"><u>You've got Mail</u></a></li>
<pre class="wrap" style="padding:.5em;">
You caught a Thunderbird mail box, which contains an easter egg. Go find it!

<a href="file/Mail.zip">Mail.zip</a>
</pre>
	<ul>
		<li class="dash">in file <code>Inbox</code>, search for attachment:"<code>signature.zip</code>"</li>
		<li class="dash">carve <code>signature.zip</code> via its base64-encoding<br><div style="text-indent:1em;"><code>pbpaste | base64 -d &gt;signature.zip</code></div></li>
		<li class="dash">egg can be found inside archive: <code>unzip -l signature.zip</code></li>
<pre class="wrap" style="padding:.5em;"><code>Archive:  signature.zip
  Length      Date    Time    Name
---------  ---------- -----   ----
    64915  09-17-2014 20:20   <font color="red">egg_11.png</font>
---------                     -------
    64915                     1 file
</code></pre>
	</ul>

<style type="text/css">
	#qn12-div input[type=text],#qn12-div input[type=email],#qn12-div input[type=number],#qn12-div input[type=password],#qn12-div select,#qn12-div textarea {
		-webkit-appearance: none;
		display: block;
		border: 0;
		padding: .5em 0;
		font-size: 1em;
		border-radius: 5px;
		border: solid 1px #dddddd;
		background: #fff;
		width: 100%;
	}
</style>
	<hr class="print-hidden"><li id="qn12" class="qn print-before"><a href="http://hackyeaster.hacking-lab.com/hackyeaster/challenge12.html"><u>This is just a Test</u></a></li>
		<!-- Thumper says: D'oh!! You failed! -->
		<div id="qn12-div" style="border:1px dashed #000;"><form method="post" action="http://hackyeaster.hacking-lab.com/hackyeaster/ceh">
		<p>This is your chance to become a Certified Easter Hacker (CEH)! Complete the following little test. Passing score is 100%</p>
		<p><b>Question 1</b><br>What is the name of the popular port scanner, implemented by Fyodor?<br><input type="text" name="q1" autocapitalize="off" autocorrect="off" placeholder="all lowercase" onblur="this.value = 'metasploit';"></p>
		<p><b>Question 2</b><br>In the context of PKI systems, the shorthand "CRL" stands for "certificate __________ list".<br><input type="number" name="q2" autocapitalize="off" autocorrect="off" placeholder="all lowercase"></p>
		<p><b>Question 3</b><br>A group of 100 people plans to use symmetric encryption for secure communication. How many keys are needed to let everybody communicate with each other?<br><input type="text" name="q3" autocapitalize="off" autocorrect="off" placeholder="all lowercase" maxlength="3"></p>
		<p><b>Question 4</b><br>Which hash sizes are supported by the SHA2 family? <b>Choose two</b>!<br><input type="radio" name="q4" value="192">192 bit<br><input type="radio" name="q4" value="384">384 bit<br><input type="radio" name="q4" value="448">448 bit<br><input type="radio" name="q4" value="512">512 bit</p>
		<p><b>Question 5</b><br>Which port number is used by Kerberos?<br><select name="q5"><option value="0">please choose</option><option value="53">53</option><option value="139">139</option><option value="161">161</option><option value="8080">8080</option></select></p>
		<p><button type="submit" name="success" value="false" style="font-size: 1.1em;padding: 0.65em 1.5em 0.65em 1.5em;line-height: 1.75em;-webkit-appearance:none;display:inline-block;text-decoration:none;cursor:pointer;border:0;border-radius:5px;background:#4923a0;color:#fff;font-weight:700;outline:0;-moz-transition:background-color .25s ease-in-out;-webkit-transition:background-color .25s ease-in-out;-o-transition:background-color .25s ease-in-out;-ms-transition:background-color .25s ease-in-out;transition:background-color .25s ease-in-out;">Submit Test</button></p>
		</form></div>
	<ul>
		<li class="dash">given form is messed up, eg.
		<ul>
			<li class="dash">Q2: specifies numeric-only</li>
			<li class="dash">Q3: max-width = 3</li>
			<li class="dash">Q4: uses radio btn; only allowed ≤ 1 option</li>
			<li class="dash">Q5: correct port # is not one of the choices</li>
		</ul></li>
		<li class="dash">correct ans to given qns</li>
		<ol>
			<li>nmap</li>
			<li>revocation</li>
			<!--@ http://russell.ballestrini.net/symmetric-encryption-vs-public-key-encryption-->
			<li>100*(100-1)/2 = 4950</li>
			<li>384, 512</li>
			<li>88</li>
			+ <code>&lt;button type=&quot;submit&quot; name=&quot;<font color="red">success</font>&quot; value=&quot;<font color="red">false</font>&quot;&gt;Submit Test&lt;/button&gt;</code>
		</ol></li>
		<li class="dash none"><code>curl -sL -X POST "http://hackyeaster.hacking-lab.com/hackyeaster/ceh" -d "q1=nmap&amp;q2=revocation&amp;q3=4950&amp;q4=384&amp;q4=512&amp;q5=88&amp;success=true"</code> returns:</li>
<pre class="wrap" style="padding:.5em;"><code>&#8230;
	Congratulations, you passed!!!
&#8230;
	&lt;div class=&quot;eggImage&quot; style=&quot;background-image: url('<font color="red">./images/egg_12_an8snbui1FeLO3Ugw89N.png</font>')&quot;&gt;&lt;/div&gt;
&#x2026;
</code></pre>
		<li class="dash none"><code class="ans">wget "<a href="img/challenge12-an8snbui1FeLO3Ugw89N.png">http://hackyeaster.hacking-lab.com/hackyeaster/images/egg_12_an8snbui1FeLO3Ugw89N.png</a>"</code></li>
	</ul>

	<hr class="print-hidden"><li id="qn13" class="qn print-before"><a href="http://hackyeaster.hacking-lab.com/hackyeaster/challenge13.html"><u>Leet TV</u></a></li>
<pre class="wrap" style="padding:.5em;">Welcome to Leet TV! Click the image below to play our trailer
<a href="file/leettv.mp4"><img src="img/play_movie.png"></a>
</pre>
	<ul>
		<!-- "select=gte(n\,<frame#>)" -->
		<li class="dash">extract stills from leettv.mp4@30fps:<br><div style="text-indent:1em;"><code>ffmpeg -i file/leettv.mp4 -vf fps=30 leettv@%d.png</code></div></li>
		<li class="dash">decode QR codes in these imgs:<br><div style="text-indent:1em;"><code>zbarimg -q leettv@[0-9]*.png | sed 's|^QR-Code:||g' | sort | uniq &gt;&gt;leettv-qrcode.lst</code></div></li>
		<li class="dash">note <a href="file/leettv-qrcode.lst">leettv-qrcode.lst</a> entry: <a href="http://bit.ly/1BJENx8">http://bit.ly/1BJENx8</a></li>
		<li class="dash none">&rarr; <a href="http://hackyeaster.hacking-lab.com/hackyeaster/leettv_qbEtJZKLTLB3jByIWSpE.wav">http://hackyeaster.hacking-lab.com/hackyeaster/leettv_qbEtJZKLTLB3jByIWSpE.wav</a></li>
		<li class="dash"><code>exiftool leettv_qbEtJZKLTLB3jByIWSpE.wav</code></li>
<pre class="wrap" style="padding:.5em;"><code class="nohighlight hljs">&#8230;
File Name : leettv_qbEtJZKLTLB3jByIWSpE.wav
&#8230;
Title     : The Hint
&#8230;
Comment   : <font color="red">siht esrever ot yrt</font>
&#x2026;
</code></pre>
		<li class="dash"><code>echo -ne &quot;siht esrever ot yrt&quot; | rev</code> says &quot;try to reverse this&quot;</li>
		<li class="dash">so follow as instructed: <code>sox leettv_qbEtJZKLTLB3jByIWSpE.wav leettv_qbEtJZKLTLB3jByIWSpE-rev.wav reverse</code></li>
		<li class="dash">audio contents: <code>eight forty-two</code></li>
		<li class="dash">so extract frame leettv.mp4@08:42:<br><div style="text-indent:1em;"><code>ffmpeg -i file/leettv.mp4 -ss 00:08:42.001 -vframes 1 <font class="ans">leettv@0842.png</font></code></li>
		<li class="dash none"><img src="img/challenge13-vBrtvkpHNRCNZdhZN1nT.png"></li>
	</ul>

	<hr class="print-hidden"><li id="qn14" class="qn print-before"><a href="http://hackyeaster.hacking-lab.com/hackyeaster/challenge14.html"><u>Wise Rabbit's Return</u></a></li>
<pre class="wrap" style="padding:.5em;">
Wise Rabbit says:

<i>An egg I give you for free,
it's below, as you can see.
But something got lost
add a dimension you must!</i>

<img src="img/egg_14.png">
</pre>
	<ul>
		<li class="dash"></li>
	</ul>

	<hr class="print-hidden"><li id="qn15" class="qn print-before"><a href="http://hackyeaster.hacking-lab.com/hackyeaster/challenge15.html"><u>Photo Shooting</u></a> (<a href="file/ps.hacking.hackyeaster.android.apk">mobile</a>)</li>
<pre class="wrap" style="padding:.5em;">
Your gallery needs some nice easter snapshots! What about a nice grasslands panorama, or a still life of a tomato?
</pre>
	<ul>
		<li class="dash">lol...taking a photo using mobile device's camera creates:</li>
		<li class="dash none"><img src="img/lvl15.jpg"></li>
		<li class="dash">extract &amp; decompile APK</li>
		<li class="dash none">@ <code>/src/ps/hacking/hackyeaster/android/Activity.java</code></li>
<pre class="wrap" style="padding:.5em;"><code class="java">&#8230;
protected void onActivityResult(int i1, int j1, Intent intent)
{
	super.onActivityResult(i1, j1, intent);
	if (i1 != 1336) goto _L2; else goto _L1
_L1:
	f = false;
	if (j1 != -1 || intent == null || !&quot;ps.hacking.zxing.client.android.SCAN&quot;.equals(intent.getAction())) goto _L4; else goto _L3
_L3:
	a(intent);
_L6:
	return;
_L4:
	a(2, &quot;&quot;);
	return;
_L2:
	if (i1 != 1337) goto _L6; else goto _L5
_L5:
	File file;
	file = new File(Environment.getExternalStorageDirectory(), &quot;HackyEaster&quot;);
	if (!file.exists() &amp;&amp; !file.mkdirs())
	{
		Toast.makeText(this, &quot;Couldn't create folder on sdcard.&quot;, 0).show();
	}
	if (!file.exists() || intent == null || intent.getExtras() == null) goto _L6; else goto _L7
_L7:
	File file1;
	Bitmap bitmap;
	Bitmap bitmap1;
	Canvas canvas;
	int k1;
	int l1;
	long l2;
	long l3;
	long l4;
	int i2;
	file1 = new File(file, (new StringBuilder(&quot;Snapshot_&quot;)).append(e.nextInt()).append(&quot;.png&quot;).toString());
	bitmap = (Bitmap)intent.getExtras().get(&quot;data&quot;);
	bitmap1 = bitmap.copy(android.graphics.Bitmap.Config.ARGB_8888, true);
	canvas = new Canvas(bitmap1);
	k1 = bitmap.getHeight();
	l1 = bitmap.getWidth();
	l2 = 0L;
	l3 = 0L;
	l4 = 0L;
	i2 = 0;
_L8:
	if (i2 &gt;= l1)
	{
		int j2;
		int k2;
		String as[];
		if (k1 &gt; l1 &amp;&amp; (double)l2 &gt; 0.90000000000000002D * (double)(l3 + l4))
		{
			<font color="red">byte abyte2[] = Base64.decode(Base64.decode(j, 0), 0);</font>
			Bitmap bitmap4 = BitmapFactory.decodeByteArray(abyte2, 0, abyte2.length);
			int k3 = bitmap4.getHeight();
			canvas.drawBitmap(bitmap4, (l1 - bitmap4.getWidth()) / 2, k1 - k3 / 2, null);
		} else
		if (l1 &gt; k1 &amp;&amp; (double)l3 &gt; 0.90000000000000002D * (double)(l4 + l2))
		{
			<font color="red">byte abyte1[] = Base64.decode(Base64.decode(j, 0), 0);</font>
			Bitmap bitmap3 = BitmapFactory.decodeByteArray(abyte1, 0, abyte1.length);
			int j3 = bitmap3.getHeight();
			canvas.drawBitmap(bitmap3, (l1 - bitmap3.getWidth()) / 2, -j3 / 2, null);
		} else
		{
			<font color="red">byte abyte0[] = Base64.decode(k, 0);</font>
			Bitmap bitmap2 = BitmapFactory.decodeByteArray(abyte0, 0, abyte0.length);
			int i3 = bitmap2.getHeight();
			canvas.drawBitmap(bitmap2, (l1 - bitmap2.getWidth()) / 2, (k1 - i3) / 2, null);
		}
		try
		{
			FileOutputStream fileoutputstream = new FileOutputStream(file1);
			bitmap1.compress(android.graphics.Bitmap.CompressFormat.PNG, 100, fileoutputstream);
			fileoutputstream.flush();
			fileoutputstream.close();
		}
		catch (Exception exception) { }
		as = new String[1];
		as[0] = file1.toString();
		MediaScannerConnection.scanFile(this, as, null, new e(this));
		return;
	}
	j2 = 0;
label0:
	{
		if (j2 &lt; k1)
		{
			break label0;
		}
		i2++;
	}
	  goto _L8
	k2 = bitmap.getPixel(i2, j2);
	l2 += Color.red(k2);
	l3 += Color.green(k2);
	l4 += Color.blue(k2);
	j2++;
	break MISSING_BLOCK_LABEL_383;
}
&#8230;
public void onCreate(Bundle bundle)
	{
		super.onCreate(bundle);
		<font color="red">j = getString(0x7f080007);</font>
		<font color="red">k = getString(0x7f080008);</font>
		if (!isTaskRoot())
		{
			Intent intent = getIntent();
			String s = intent.getAction();
			if (intent.hasCategory("android.intent.category.LAUNCHER") && s != null && s.equals("android.intent.action.MAIN"))
			{
				super.finish();
				return;
			}
		}
		ps.hacking.hackyeaster.android.i.a(this);
		a();
		g = (SensorManager)getSystemService("sensor");
		b();
		a.setOnKeyListener(new a(this, this));
	}
&#x2026;
</code></pre>
		<li class="dash">this seems to be the routine in <code>Activity.java</code> responsible for the functionality here</li>
		<li class="dash"><code>j</code> and <code>k</code> look particularly interesting</li>
		<li class="dash none">@ <code>/src/ps/hacking/hackyeaster/android/R$string.java</code> (inner class <code>string</code> within generated <code>android.R</code>)</li>
<pre class="wrap" style="padding:.5em;"><code class="java">public static final int ft = 0x7f080007;
public static final int rick = 0x7f080008;
</code></pre>
		<li class="dash">String constants for <code>j=0x7f080007</code> and <code>k=0x7f080008</code> are <code>ft</code> and <code>rick</code> respectively (rick &#61; Rick Astley, whose face is on the photo taken)</li>
		<li class="dash">time to lookup the (base64-encoded) string vals @ <code>/res/values/strings.xml</code>; just for <code>ft</code> only !</li>
<pre class="wrap" style="padding:.5em;"><code class="java">&lt;string name="ft"&gt; <a class="print-link" href="file/lvl15-ft.base64">&#8230;</a> &lt;/string&gt;
</code></pre>
		<li class="dash">remember to <code>base64 --decode</code> 2x !</li>
<pre class="wrap" style="padding:.5em;"><code class="java">import java.io.*;
import java.lang.*;
import java.util.*;
import org.apache.commons.io.*;

class Challenge15 {
	public static void main(String[] args) throws Exception
	{
		File file_ft= new File("<a class="print-link" href="file/lvl15-ft.base64">lvl15-ft.base64</a>");
		String ft = FileUtils.readFileToString(file_ft);
		byte[] decoded = org.apache.commons.codec.binary.Base64.decodeBase64(
			org.apache.commons.codec.binary.Base64.decodeBase64(
				ft.getBytes()
			));
		String filename = "lvl15-qr.png";
		FileOutputStream output = new FileOutputStream(new File(filename));
		IOUtils.write(decoded, output);
		System.out.println("=> "+filename);
	}
}
</code></pre>
	</ul>

	<hr class="print-hidden"><li id="qn16" class="qn print-before"><a href="http://hackyeaster.hacking-lab.com/hackyeaster/challenge16.html"><u>Ghost Room</u></a></li>
<pre class="wrap" style="padding:.5em;">
Ghosts only come out when it's dark...

<img src="img/noghost.png">
</pre>
	<ul>
		<li class="dash none"><img src="img/lvl16-light.png"></li>
		<li class="dash">turn off the lights: click on light bulb in far lower right corner @ webpage footer</li>
		<li class="dash none"><img src="img/lvl16-dark.png"></li>
		<li class="dash">JS code snippet implementing this behaviour:</li>
<pre class="wrap" style="padding:.5em;"><code class="javascript">function (){skelD=!skelD,skelD?($("#dark").show(),$("#chall16 img").attr("src","images/banner_challenge_16_dark.jpg"),$("#chall16 a").attr("href","challenge16-dark.html")):($("#dark").hide(),$("#chall16 img").attr("src","images/banner_challenge_16.jpg"),$("#chall16 a").attr("href","challenge16.html"))}
</code></pre>
		<li class="dash">clicking on Challenge 16 now leads to <a href="http://hackyeaster.hacking-lab.com/hackyeaster/challenge16-dark.html">challenge16-dark.html</a>, containing another puzzle desc:</li>
<pre class="wrap" style="padding:.5em;">
Dark is beautiful. A <a href="http://en.wikipedia.org/wiki/GOST_(block_cipher)"><font color="red">GOST</font></a> with <a href="http://en.wikipedia.org/wiki/Block_cipher_mode_of_operation#Cipher_Block_Chaining_.28CBC.29"><font color="red">chain</font></a>ing appears and has a message for you:
<code>d5++xytj6RiGwmqEecm63Kow7RZGAAHh
VFsksHFuj/Anap7pWHDZ1XQw8DAApUEN
R5ExOGUKTzGOtvSAlCHkHq6NneL6ZUTX
ej8Taxz+kHK9w9U8dxTOSksZ4HKS2YYD</code>
<img src="img/ghost.png">
</pre>
		<li class="dash">as given in img, key: <code>spooky</code>; using <u>GOST</u> Russian symmetric key block cipher (GOST 28147-89) in <u>Cipher Block Chaining</u> (CBC) mode of op on ciphertxt, joined as a single contiguous string</li>
		<li class="dash none"><img src="img/lvl16.png"></li>
<pre class="wrap" style="padding:.5em;"><code class="php">#!/usr/bin/env php

&lt;?
	$key = &quot;spooky&quot;;
	$ciphertxt = &quot;d5++xytj6RiGwmqEecm63Kow7RZGAAHhVFsksHFuj/Anap7pWHDZ1XQw8DAApUENR5ExOGUKTzGOtvSAlCHkHq6NneL6ZUTXej8Taxz+kHK9w9U8dxTOSksZ4HKS2YYD&quot;;
	$ciphertxt_b64 = base64_decode($ciphertxt);
	$iv_size = mcrypt_get_iv_size(MCRYPT_GOST, MCRYPT_MODE_CBC);
	$iv = &quot;&quot;; while(strlen($iv)&lt;$iv_size) {$iv.=0;}
	$plaintxt = mcrypt_decrypt(MCRYPT_GOST, $key, $ciphertxt_b64, MCRYPT_MODE_CBC, $iv);
	echo &quot;key: $key&quot;.PHP_EOL;
	echo &quot;ciphertxt: $ciphertxt&quot;.PHP_EOL;
	echo &quot;plaintxt: $plaintxt&quot;.PHP_EOL;
?&gt;
</code></pre>
		<li class="dash none">@ <code class="ans">http://hackyeaster.hacking-lab.com/hackyeaster/images/egg_16_a3eIIACKSy02sJ6LxXeh.png</code></li>
	</ul>

	<hr class="print-hidden"><li id="qn17" class="qn print-before"><a href="http://hackyeaster.hacking-lab.com/hackyeaster/challenge17.html"><u>Spot the Difference</u></a></li>
<pre class="wrap" style="padding:.5em;">
Sharpen your eyes, and diff 2 img below

<img src="img/difference1.bmp">
<img src="img/difference2.bmp">
</pre>
	<ul>
		<li class="dash">QR code is always the flag in these series of challenges;</li>
		<li class="dash">so can guess must somehow convert 2 input img &rarr; single B/W img</li>
		<li class="dash">normalise to B/W using transformation:</li>
		<ul>
			<li class="dash"><code>pix @ corresponding pos match = 0 ie. RGB(0,0,0) &#61; black</code>,</li>
			<li class="dash"><code>pix @ corresponding pos mismatch = 1 ie. RGB(255,255,255) &#61; white</code></li>
		</ul>
<pre class="wrap" style="padding:.5em;"><code class="python">#!/usr/bin/env python
#-*- coding: utf-8 -*-

import sys
import codecs
import operator
import numpy as np
from PIL import Image, ImageFilter

def mk_agent_xor():
	im1 = Image.open("difference1.bmp").convert("RGB")
	#np.asarray(im1)
	pix1s = im1.load()
	im2 = Image.open("difference2.bmp").convert("RGB")
	pix2s = im2.load()
	w1, h1 = im1.size
	for y in xrange(h1):
		for x in xrange(w1):
			pix1 = pix1s[x,y]
			pix2 = pix2s[x,y]
			if pix1 != pix2:
				pix1s[x,y] = (255,255,255)
			else:
				pix1s[x,y] = (0,0,0)
	im1.save("difference0.bmp")
</code></pre>

		<li class="dash none"><img src="img/difference0.bmp"></li>
		<li class="dash ans">XOR (as instructed) QR code <img src="img/lvl17-qr1.jpg" style="vertical-align:middle;"> w/ target <img src="img/lvl17-qr2.jpg" style="vertical-align:middle;">, each found on one side of Agent's glasses, yields <img src="img/lvl17-qr.jpg" style="vertical-align:middle;"></li>
<pre class="wrap" style="padding:.5em;"><code class="python">#!/usr/bin/env python
#-*- coding: utf-8 -*-

import sys
import codecs
import operator
import numpy as np
from PIL import Image, ImageFilter

def crop_agent_xor():
	im = Image.open("difference0.bmp").convert("RGB")
	#qr#
	left, top, right, bottom = 245, 140, 280, 175
	img = im.crop((left, top, right, bottom))
	#img = im.filter(ImageFilter.{BLUR,CONTOUR,DETAIL,EDGE_ENHANCE,EDGE_ENHANCE_MORE,EMBOSS,FIND_EDGES,SMOOTH,SMOOTH_MORE,SHARPEN})
	#img.thumbnail(sz)
	#img.show()
	img.save("lvl17-qr1.jpg")
	#tgt#
	left, top, right, bottom = 333, 140, 368, 175
	img = im.crop((left, top, right, bottom))
	img.save("lvl17-qr2.jpg")

def mk_qr_code():
	im1 = Image.open("lvl17-qr1.jpg").convert("RGB")
	#im1.getcolors(), im1.format, im1.size, im1.mode
	im2 = Image.open("lvl17-qr2.jpg").convert("RGB")
	pix2s = list(im2.getdata())
	w2, h2 = im2.size
	pix2s = [pix2s[i*w2:(i+1)*w2] for i in xrange(h2)]
	pix1s = im1.load()
	w1, h1 = im1.size
	for y in xrange(h1):
		for x in xrange(w1):
			pix1 = pix1s[x,y]
			pix2 = pix2s[x][y]
			pix = []
			for ci in xrange(len(pix1)):
				pix.append(pix1[ci] ^ pix2[ci])
			pix1s[x,y] = tuple(pix)
	im1.save("lvl17-qr.jpg")
</code></pre>

	</ul>

	<hr class="print-hidden"><li id="qn18" class="qn print-before"><a href="http://hackyeaster.hacking-lab.com/hackyeaster/challenge18.html"><u>Sharks on Wire</u></a></li>
<pre class="wrap" style="padding:.5em;">
In this challenge, you need to get access to a <a href="">website</a>

Inspect <a href="file/sharks.pcapng">sharks.pcapng</a>, in order to get the credentials needed
</pre>
	<ul>
		<li class="dash">view <a href="file/sharks.pcapng">sharks.pcapng</a> in WireShark</li>
		<li class="dash">apply bpf filter: <code>tcp stream eq 3</code></li>
		<li class="dash">Follow (this) TCP Stream</li>
		<li class="dash">filter for only <code>10.11.0.52:62046 &rarr; 10.11.0.48:8080</code></li>
		<li class="dash none"><img src="img/lvl18.png"></li>
		<li class="dash none"><img src="img/lvl18-login.png"></li>
		<li class="dash none">Credentials: <code>sharkman:sharks_have_j4ws</code></li>
		<li class="dash"><code>curl -sL -u sharkman:sharks_have_j4ws -H &quot;Authorization: Basic c2hhcmttYW46c2hhcmtzX2hhdmVfajR3cw==&quot; -X POST &quot;http://hackyeaster.hacking-lab.com/hackyeaster/sharks/auth&quot; -d &quot;user=supershark&amp;pass=hashed%21%21%21&amp;hash=b3f3ca462d3fa58b74d6982af14d8841b074994a&quot;</code></li>
<pre class="wrap" style="padding:.5em;"><code>&#8230;
  &lt;body&gt;
	&lt;div class=&quot;title&quot;&gt;Sharks on Wire&lt;/div&gt;
	&lt;div class=&quot;imageBg&quot;&gt;
	  &lt;img src=&quot;<font color="red">egg_18_j9rU8ma6nBfz986gJZmf.png</font>&quot; class=&quot;image&quot;/&gt;
	&lt;/div&gt;
  &lt;/body&gt;
&#x2026;
</code></pre>
		<li class="dash"><code>curl -sL -u sharkman:sharks_have_j4ws -H &quot;Authorization: Basic c2hhcmttYW46c2hhcmtzX2hhdmVfajR3cw==&quot; &quot;<font class="ans">http://hackyeaster.hacking-lab.com/hackyeaster/sharks/egg_18_j9rU8ma6nBfz986gJZmf.png</font>&quot; -o egg_18_j9rU8ma6nBfz986gJZmf.png</code></li>
	</ul>

	<hr class="print-hidden"><li id="qn19" class="qn print-before"><a href="http://hackyeaster.hacking-lab.com/hackyeaster/challenge19.html"><u>Cut'n'Place</u></a></li>
<pre class="wrap" style="padding:.5em;">
Time for paper and scissors! The <a href="file/paperstrips.pdf">PDF</a> contains some paper strips. Your task is to combine them in such a way that a passphrase appears

Hint: The passphrase does *not* use all characters available, and it has <u>no spaces</u>
</pre>
	<ul>
		<li class="dash none"><img src="img/paperstripsmadebyshredder-noexif.jpg"></li>
		<li class="dash"><code class="ans">paperstripsmadebyshredder</code></li>
	</ul>

	<hr class="print-hidden"><li id="qn20" class="qn print-before"><a href="http://hackyeaster.hacking-lab.com/hackyeaster/challenge20.html"><u>Lots of Bots</u></a></li>
<pre class="wrap" style="padding:.5em;">
Robots have placed an egg on this web server. If you wanna find it, you need to think and act like a bot

<img src="img/robot.jpg">
</pre>
	<ul>
		<li class="dash none">@ <a href="http://hackyeaster.hacking-lab.com/robots.txt">http://hackyeaster.hacking-lab.com/robots.txt</a></li>
<pre style="padding:.5em;">
<font color="red">User-agent: EasterBot</font>
Disallow: /
Allow: <font color="red">/hackyeaster/bots/bots</font>.

User-agent: *
Disallow: /
</pre>
		<li class="dash">visit @ <a href="http://hackyeaster.hacking-lab.com/hackyeaster/bots/bots.html">http://hackyeaster.hacking-lab.com/hackyeaster/bots/bots.html</a>, supplying HTTP header: <code>{&quot;User-agent&quot;: &quot;EasterBot&quot;}</code>
		<p style="text-indent: 1em"><code>curl -sL -A "EasterBot" "http://hackyeaster.hacking-lab.com/hackyeaster/bots/bots.html"</code></p></li>
<pre class="wrap print-before" style="padding:.5em;"><code>&lt;html&gt;
&lt;head&gt;&lt;title&gt;Bots&lt;/title&gt;
&lt;script type=&quot;text/javascript&quot;&gt;
/**
	// @ http://matthewfl.com/unPacker.html
	if (!(navigator.userAgent === 'EasterBot'))
	{
		location.replace('http://en.wikipedia.org/wiki/C-3PO');
	}
*/
eval(String.fromCharCode(105, 102, 32, 40, 33, 40, 110, 97, 118, 105, 103, 97, 116, 111, 114, 46, 117, 115, 101, 114, 65, 103, 101, 110, 116, 32, 61, 61, 61, 32, 39, 69, 97, 115, 116, 101, 114, 66, 111, 116, 39, 41, 41, 32, 123, 32, 108, 111, 99, 97, 116, 105, 111, 110, 46, 114, 101, 112, 108, 97, 99, 101, 40, 39, 104, 116, 116, 112, 58, 47, 47, 101, 110, 46, 119, 105, 107, 105, 112, 101, 100, 105, 97, 46, 111, 114, 103, 47, 119, 105, 107, 105, 47, 67, 45, 51, 80, 79, 39, 41, 59, 125));&lt;/script&gt;&lt;/head&gt;
&lt;body style=&quot;background: white; border: 20px solid white;&quot;&gt;
	&lt;div style=&quot;width: 100%; height: 100%; background: url('<font color="red">./robotbg.jpg</font>') no-repeat center center fixed; -webkit-background-size: contain; -moz-background-size: contain; -o-background-size: contain; background-size: contain;&quot;&gt;&amp;#160;&lt;/div&gt;
&lt;/body&gt;&lt;/html&gt;
</code></pre>
<img src="img/robotbg.jpg">
		<li class="dash"><a href="http://en.wikipedia.org/wiki/Robot_Interaction_Language">Robot Interaction Language (ROILA)</a></li>
		<li class="dash"><code>for w in bama waboki pisal fatatu fomu wosebi seju sowu seju bamas mufe wafub fomu mowewe; do egrep "^${w}\b" <a href="file/roila-wordlist.txt">roila-wordlist.txt</a>; done</code></li>
<pre class="wrap print-before" style="padding:.5em;"><code>bama	you
waboki	must
pisal	make
fatatu	word
fomu	of
wosebi	addition
seju	two
sowu	and
seju	two
bamas	this
mufe	be
wafub	name
fomu	of
mowewe	page</code></pre>
<hr style="border-top: 1px dotted;">
		<li class="dash">visit @ <a href="http://hackyeaster.hacking-lab.com/hackyeaster/bots/four.html">http://hackyeaster.hacking-lab.com/hackyeaster/bots/four.html</a>, supplying HTTP header: <code>{&quot;User-agent&quot;: &quot;EasterBot&quot;}</code>
		<p style="text-indent: 1em"><code>curl -sL -A "EasterBot" "http://hackyeaster.hacking-lab.com/hackyeaster/bots/four.html"</code></p></li>
<pre class="wrap" style="padding:.5em;"><code>&lt;html&gt;
  &lt;head&gt;
	&lt;title&gt;Bots&lt;/title&gt;
	&lt;meta name=&quot;description&quot; content=&quot;Robots talk in ROILA language: <font color="red">eman egap eht esrever tsum</font>&quot;&gt;
	&lt;meta name=&quot;keywords&quot; content=&quot;secret, page, robots, fun, hacky easter, blrt, five, beep&quot;&gt;
	&#8230;
  &lt;/head&gt;
  &lt;body style=&quot;background: white; border: 20px solid white;&quot;&gt;
	&lt;div style=&quot;width: 100%; height: 100%; background: url('<font color="red">./robotbg2.jpg</font>') no-repeat center center fixed; -webkit-background-size: contain; -moz-background-size: contain; -o-background-size: contain; background-size: contain;&quot;&gt;&amp;#160;&lt;/div&gt;
  &lt;/body&gt;
&lt;/html&gt;
</code></pre>
<img src="img/robotbg2.png">
		<li class="dash">using <code>MeTA</code> (hint), together with <code>attr:content</code> of <code>&lt;meta name=&quot;description&quot;&gt;</code>: <i>eman egap eht esrever tsum</i></li>
		<li class="dash">reverse string: <i>eman egap eht esrever tsum</i> via <code>echo -ne "eman egap eht esrever tsum" | rev</code> yields: <i>must reverse the page name</i></li>
		<li class="dash">so reverse(<i>page name</i> = four) = <a href="http://hackyeaster.hacking-lab.com/hackyeaster/bots/ruof.html">ruof.html</a></li>
<pre class="wrap" style="padding:.5em;"><code>&#8230;
  &lt;body style=&quot;background: white; border: 20px solid white;&quot;&gt;
	&lt;div style=&quot;position: absolute; left:50%; top: 50%; margin-left: -187px; margin-top: -187px; width: 375px; height: 375px; background: url('<font color="red">./egg_20_j5fir8U6g8.png</font>'); background-size: 375px 375px; background-repeat: no-repeat;&quot;&gt;&amp;#160;&lt;/div&gt;
  &lt;/body&gt;
&lt;/html&gt;
</code></pre>
	</ul>

	<hr class="print-hidden"><li id="qn21" class="qn print-before"><a href="http://hackyeaster.hacking-lab.com/hackyeaster/challenge21.html"><u>Cony Code</u></a></li>
<pre class="wrap" style="padding:.5em;">
Tired of boring QR codes, Dr. Bunny C. Easter developed an alternative. He's proudly introducing the "Cony Code" now! Crack the code in order to get another easter egg!

Hint: <code class="nohighlight">110</code> is <font color="blue">blue</font>, the rest's up to you...

<img src="img/egg_21_plain.png" style="vertical-align:middle;"><img src="img/conycode.png" style="vertical-align:middle;">
</pre>
	<ul>
		<li class="dash"><font color="blue">blue</font> &#61; RGB(0,0,255) &equiv; 110</li>
		<li class="dash">looks like bit flip ie. {0&rarr;1, 255&rarr;0}</li>
<pre class="wrap" style="padding:.5em;"><code class="python">#!/usr/bin/env python
#-*- coding: utf-8 -*-

import sys
import codecs
from PIL import Image, ImageFilter

reduced = []
im1 = Image.open("conycode.png").convert("RGB")
pix1s = im1.load()
w1, h1 = im1.size
for y in xrange(8,h1,17):
	xyc = []
	for x in xrange(8,w1,17):
		pix1 = pix1s[x,y]
		xyc.append((x,y,pix1))
	reduced.append(xyc)

ans = ""
for r in reduced:
	for xyc in r:
		_, _, pix1 = xyc
		ans += "".join(map(lambda c: "1" if c==0 else "0", list(pix1)))

print "".join(chr(int(ans[i:i+8], 2)) for i in xrange(0,len(ans),8))
</code></pre>
	</ul>

<style type="text/css">
	.lvl22-hash p {text-indent: 2em;}
	.lvl22-hash .hint {background: #4923A0;color: #fff;border-radius: 2px;padding: 2px 6px;margin-right: 20px;}
	.lvl22-hash img {vertical-align: top;}
	.lvl22-hash .dash:before {content: "- ";}
</style>
	<hr class="print-hidden"><li id="qn22" class="qn print-before"><a href="http://hackyeaster.hacking-lab.com/hackyeaster/challenge22.html"><u>Hashes to Ashes</u></a></li>
<pre class="wrap" style="padding:.5em;">
prove your skills in hash cracking:
</pre>
<ul>
	<li>Standard algorithms (MD5, various SHA)</li>
	<li>One iteration only, and no salting</li>
	<li>Click the hint for each hash!</li>
	<li>For hashes 3 and 4, use the following <a href="file/wordlist.txt">word list</a></li>
</ul>
<ol class="lvl22-hash">
	<li>Numeric PIN (16 digits)
		<p id="lvl22-hash1" class="hash lvl22"><code>raLu6+eAmFelf2/uSy/67iTq57E=</code></p>
		<span class="hint">hint</span>
		<img src="img/lvl22-hint1.jpg">
		<p class="dash">digits <code>{0,1,7,9}</code> are marked; assume this is charset</p>
		<p class="dash">hash: <code>ada2eeebe7809857a57f6fee4b2ffaee24eae7b1</code></p>
		<p>txt: <code class="ans">1199019170177790</code></p>
	</li>

	<li>Single word (lowercase only)
		<p id="lvl22-hash2" class="hash lvl22"><code>a791KNndKVmnr7N4mEJfZ1VfZ/Z3mHyufoYhCiyKDb38JI7C17JAEPRAutwiI7S1</code></p>
		<span class="hint">hint</span>
		<img src="img/lvl22-hint2.jpg">
		<p class="dash">name of song by Rick Astley</p>
		<p class="dash">hash: <a class="print-link" href="http://www.md5decode.com/decrypt/af4f67875ec3cae6f670b04fe12cba2e"><code>6bbf7528d9dd2959a7afb37898425f67555f67f677987cae7e86210a2c8a0dbdfc248ec2d7b24010f440badc2223b4b5</code></a></p>
		<p>txt: <code class="ans">hopelessly</code></a></p>
	</li>

	<li>Complex word (1 upper, 1 substitution, ending with punctuation + digit)
		<p id="lvl22-hash3" class="hash lvl22"><code>uAgUxeDzhrBjcWP9iv6pKQ==</code></p>
		<span class="hint">hint</span>
		<a href="http://xkcd.com/936"><img src="img/lvl22-hint3.jpg"></a>
		<p class="dash">hash: <code>b80814c5e0f386b0637163fd8afea929</code></p>
		<p>txt: <code class="ans">Disc0very.5</code></p>
	</li>

	<li>Multi-Word (lowercase only)
		<p id="lvl22-hash4" class="hash lvl22"><code>l5HL4K6RmgMwmUota6Jrjww6HaFcc7zl/KOUlYgabJA=</code></p>
		<span class="hint">hint</span>
		<a href="http://xkcd.com/936"><img src="img/lvl22-hint4.jpg"></a>
		<p class="dash">hash: <a class="print-link" href="http://www.perturb.org/content/hashes/?word=enginebulbgoatimportant"><code>9791cbe0ae919a0330994a2d6ba26b8f0c3a1da15c73bce5fca39495881a6c90</code></a></p>
		<p>txt: <code class="ans">enginebulbgoatimportant</code></p>
	</li>
</ol>
<pre class="wrap" style="padding:.5em;"><code class="python">#!/usr/bin/env python
#-*- coding: utf-8 -*-

import os #os.linesep
import sys
import codecs
import hashlib
import base64
import itertools
import random
import string
import binascii

def hmatch(txt, hash):
	def name_of(var):
		import inspect
		callers_local_vars = inspect.currentframe()\
			.f_back.f_locals.items()
		return [var_name \
			for var_name, var_val in callers_local_vars \
			if var_val is var][0]
	hash = hash.lower()
	md5 = hashlib.md5(txt).hexdigest()
	sha1 = hashlib.sha1(txt).hexdigest()
	sha224 = hashlib.sha224(txt).hexdigest()
	sha256 = hashlib.sha256(txt).hexdigest()
	sha384 = hashlib.sha384(txt).hexdigest()
	sha512 = hashlib.sha512(txt).hexdigest()
	hashes = [md5,sha1,sha224,sha256,sha384,sha512]
	hnames = map(name_of, hashes)
	hashes = map(str.lower, hashes)
	if hash in hashes:
		i = hashes.index(hash)
		print "\n".join([
			"txt: %s [%d]"%(txt,len(txt)),
			"%s: %s [%d]"%(hnames[i],hashes[i],len(hashes[i]))
		])
		return True
	return False

if __name__ == "__main__":
	def h(hash):
		#binascii.hexlify(base64.b64decode(hash))
		return base64.b64decode(hash).encode("hex")
	hash1 = h("raLu6+eAmFelf2/uSy/67iTq57E=")
	hash2 = h("a791KNndKVmnr7N4mEJfZ1VfZ/Z3mHyufoYhCiyKDb38JI7C17JAEPRAutwiI7S1")
	hash3 = h("uAgUxeDzhrBjcWP9iv6pKQ==")
	hash4 = h("l5HL4K6RmgMwmUota6Jrjww6HaFcc7zl/KOUlYgabJA=")
	for i, hash in enumerate([hash1, hash2, hash3, hash4]):
		print>>sys.stderr, "#%d:"%(i+1), hash

	### Hash 1 ###
	charset, maxlen = [0,1,7,9], 16
	def h1_rand(charset, maxlen):
		return "".join(["%d"%random.choice([charset]) \
			for i in xrange(maxlen)])
	def h1_iter(w, charset, maxlen, hash):
		if len(w) == maxlen:
			return hmatch(hash, w)
		for c in charset:
			if h1_iter(w+str(c), charset, maxlen, hash):
				break
	h1_iter("", charset, maxlen, hash1)
	txt = h1_rand(charset, maxlen)
	while not hmatch(txt, hash1):
		txt = h1_rand(charset, maxlen)

	### Hash 3 ###
	intab, outtab = "aegiost", "4361057" #leetspeak
	leet = string.maketrans(intab, outtab)
	with open("<a href="file/lvl22-wordlist.txt">lvl22-wordlist.txt</a>") as f:
		words = map(string.strip, f.readlines())
	while True:
		word = list(random.choice(words))
		def cfind(s, ch):
			return [i for i,ltr in enumerate(s) if ltr==ch]
		possible = []
		for c in intab:
			possible.extend(cfind(word, c))
		if possible == []: continue
		idx = random.choice(possible)
		used = set()
		used.add(idx)
		word[idx] = word[idx].translate(leet)
		idx = random.randint(0, len(word)-1)
		while idx in used:
			idx = random.randint(0, len(word)-1)
		used.add(idx)
		word[idx] = word[idx].upper()
		punct = random.choice(string.punctuation)
		digit = random.choice(string.digits)
		txt = "".join(word)+punct+digit
		if hmatch(txt, hash3): sys.exit()
</code></pre>

	<hr class="print-hidden"><li id="qn23" class="qn print-before"><a href="http://hackyeaster.hacking-lab.com/hackyeaster/challenge23.html"><u>Beat the Nerd Master</u></a></li>
<pre class="wrap" style="padding:.5em;">
Did you beat the Swordmaster in Monkey Island? Even if, it ain't gonna help you this time. Get to know the mighty Nerd Master!

Connect to <a href="hackyeaster.hacking-lab.com:1400">hackyeaster.hacking-lab.com:1400</a>, and start the battle.

Here's an insult to start with: <i>Go 127.0.0.1 to your mummy</i>.
</pre>
	<ul>
<pre class="wrap" style="padding:.5em;"><code class="python">#!/usr/bin/env python
#-*- coding: utf-8 -*-

import os #os.linesep
import sys
import codecs
import json
import telnetlib
import hashlib
from random import randint

def find_answer(question, data):
	for entry in data:
		if entry["question"] == question:
			return entry["answer"].encode("utf-8")
	data.append({"question": question, "answer": ""})
	return ""

def ask_question(data):
	for entry in data:
		if entry["answer"] == "":
			return entry["question"].encode("utf-8")
	return data[randint(0,len(data)-1)]["question"].encode("utf-8")

def add_answer(question, answer, data):
	for entry in data:
		if entry["question"] == question:
			entry["answer"] = answer
			return

def show(data):
	for entry in data:
		print>>sys.stderr, u"Q: %s; A: %s" \
		%(entry["question"], entry["answer"])

if __name__ == "__main__":
	filepath = u"challenge23.json"
	with open(filepath) as file:
		data = json.load(file)
	host, port = "hackyeaster.hacking-lab.com", 1400
	nr = "\r\n"
	tn = telnetlib.Telnet(host, port)
	tn.read_until("Do you feel brave enough to challenge the mighty nerdmaster? (y|n)")
	tn.write("y" + nr)
	tn.read_until("---- YOUR TURN ----\n")
	while True:
		try:
			my_question = ask_question(data)
			tn.write(my_question + nr)
			print "I ask: " + my_question
			answer = tn.read_until("---- MY TURN ----\n").split("\n")[0]
			print "It Answered: " + answer
			if answer != "We've had this one before.":
				add_answer(my_question, answer, data)
			print
			print "---- MY TURN ----"
			print
			question = tn.read_until("\n").split("\n")
			print "It asked: " + question[0]
			my_answer = find_answer(question[0], data)
			tn.write(my_answer + nr)
			print "I answer: " + my_answer
			response = tn.read_until("---- YOUR TURN ----\n")
			print "resp:", response
		except EOFError as e:
			print ">> Connection closed"
			break
	with open(filepath, "w") as outfile:
		json.dump(data, outfile)
		print "%s updated"%filepath
	BUF_SIZE = 65536  #64KB chunk
	sha1 = hashlib.sha1()
	with open(filepath, "rb") as f:
		while True:
			data = f.read(BUF_SIZE)
			if not data: break
			sha1.update(data)
	print "sha1sum({}): {}".format(filepath, sha1.hexdigest())
</code></pre>
		<li class="print-before dash none"><u>Q&amp;A</u></li>
<pre class="wrap" style="padding:.5em;"><code class="nohighlight hljs">question: "Go 127.0.0.1 to your mummy."
answer: "Won't work. I only support IPv6."

question: "Pna lbh ernq guvf?"
answer: "EBG13 vf sbe ynzref."

question: "Tell me your name, hobo. I need to check your records."
answer: "My name is bob'; DROP TABLE VALJ;--"

question: "You'll be 0xdeadbeef soon."
answer: "Not as long as I have my 0xcafebabe."

question: "After loosing to me, your life won't be the same anymore."
answer: "A Life? Cool! Where can I download one of those?"

question: "You must be jealous when seeing my phone's display."
answer: "Not really - Your pixels are so big, some of them have their own region code!"

question: "You're so slow, you must have been written in BASIC."
answer: "At least I don't have memory leaks like you."

question: "Ping! Anybody there?"
answer: "ICMP type 3, code 13: Communication Administratively Prohibited"

question: "This fight is like a hash function - it works in one direction only."
answer: "Too bad you picked LM hashing."

question: "You should leave your cave and socialize a bit."
answer: "I'm not anti-social. I'm just not user friendly."

question: "1f u c4n r34d th1s u r s70p1d."
answer: "You better check your spelling. Stoopid has two 'o's."

question: "I have more friends than you."
answer: "Yeah, but only until you update your Facebook profile with a real picture of you!"

question: "Af7ter th1s f1gh7, I w1ll pwn ur b0x3n."
answer: "Check your settings - you seem to have chosen the Klingon keyboard layout."

question: "format C:"
answer: "Specified drive does not exist."

question: "I bet you don't even understand binary."
answer: "Sure I do. Me and you, we are 10 different kind of persons."

question: "I'll check you out - any last words?"
answer: "svn:ignore"
</code></pre>

<pre class="wrap" style="padding:.5em;"><code class="nohighlight">Respect! you've beaten the mighty nerd master! Here's your egg:
<font class="ans">http://hackyeaster.hacking-lab.com/hackyeaster/images/egg_23_j7vzfUzftszdf754fXDS.png</font>
</code></pre>
	</ul>

	<hr class="print-hidden"><li id="qn24" class="qn print-before"><a href="http://hackyeaster.hacking-lab.com/hackyeaster/challenge24.html"><u>SHAM Hash</u></a></li>
<pre class="wrap" style="padding:.5em;">
Crypto Chiefs Ltd. developed a new hash function, which takes a 'divide and conquer' approach and combines several well-known hash functions (&quot;Split, Hash, And Merge&quot;). The inventors claim that with this approach, their function becomes more secure. Can you prove they are wrong?

Create a string which produces the following hash:
	<code class="nohighlight">757c479895d6845b2b0530cd9a2b11</code>

spec: <a href="file/shamhash.pdf">shamhash.pdf</a>
</pre>
	<ul>
<pre class="wrap" style="padding:.5em;"><code class="python">#!/usr/bin/env python
#-*- coding: utf-8 -*-

import sys
import codecs
import itertools
import hashlib
from hashlib import sha1, sha256, sha512
from Crypto.Hash import MD2, MD5

if __name__ == "__main__":
	ans = "<font color="red">afpmqtaaqidtaww8ntangecaaf9pt3</font>"
	charset = "abcdefghijklmnopqrstuvwxyz0123456789"
	begin, end = 0, 6
	hashes = [(MD2, "757c47"), (MD5, "9895d6"), (sha1, "845b2b"), (sha256, "0530cd"), (sha512, "9a2b11")]
	for algo, frag in hashes:
		if algo in [MD2, MD5]:
			begin += 6
			end += 6
			continue
		print>>sys.stderr, algo.__name__
		for i in itertools.product(charset, repeat=6):
			word = "".join(i)
			try: whash = algo.new(word).hexdigest()
			except AttributeError:
				m = algo()
				m.update(word)
				whash = m.hexdigest()
			if frag == whash[begin:end]:
				print word, whash
				ans += word
				break
		begin += 6
		end += 6
	print "ans:", ans
</code></pre>
		<li class="dash">enter <code>ans</code> &rarr; redirect to <a href="http://hackyeaster.hacking-lab.com/hackyeaster/sham_m7f3ngUfg6LLzf530zub.html">http://hackyeaster.hacking-lab.com/hackyeaster/sham_m7f3ngUfg6LLzf530zub.html</a></li>
	</ul>

	<hr class="print-hidden"><li id="qn25" class="qn print-before"><a href="http://hackyeaster.hacking-lab.com/hackyeaster/challenge25.html"><u>Jad &amp; Ida</u></a></li>
<pre style="padding:.5em;">
<a href="file/jadandida.zip">jadandida.zip</a>
</pre>
	<ul>
		<li class="dash"><code>JAD</code>: ref. <a href="http://en.wikipedia.org/wiki/JAD_%28JAva_Decompiler%29"><u style="color:#000;">J</u><u style="color:#000;">A</u>va <u style="color:#000;">D</u>ecompiler</a></li>
		<li class="dash"><code>IDA</code>: ref. <a href="http://en.wikipedia.org/wiki/Interactive_Disassembler"><u style="color:#000;">I</u>nteractive <u style="color:#000;">D</u>is<u style="color:#000;">A</u>ssembler</a></li>
		<li class="dash"><code>lib/libhe2015_Lizzle.dll::LizzleDLL::{Fizzle,Shizzle}</code> loaded &amp; used</li>
		<li class="dash">+2 other pure Java functions: <code>{bizzle,rizzle}</code></li>
		<li class="dash"><u><code>main</code> method</u>
		<ol>
			<li>takes an input `key`, <code>k</code></li>
			<li>then subsequently runs a total of 10 rounds &times; <code>k &#61; fizzle(rizzle(shizzle(bizzle(k))))</code></li>
			<li><code>s3cr3t.bin</code> (assumes this is/contains egg w/ QR code) successfully <code>decrypt()</code>-ed if result <code>&quot;v3O] pmWm&lt;Y(0=21&quot;.equals(k)</code></li>
		</ol></li>
		<li class="dash">use <a href="http://jd.benow.ca">JD-GUI</a> to decompile Java <code>.class</code> files &rarr; <code>.java</code> source code</li>
		<li class="dash">use IDA Pro v6.6 to generate C code from DLL, to analyse behaviour of imported native functions</li>
		<li class="dash">after careful analysis, and also by trying several &quot;test&quot;/&quot;dummy&quot; input values,
		<ul>
			<li><code>String bizzle(String s)</code> case-sensitively increments <code>char</code> w/ wrap-around, ie. <code>tr &quot;a-yzA-YZ&quot; &quot;b-zaB-ZA&quot;</code>
			<li><code>String rizzle(String s)</code> swaps case of all letters in <code>s</code>, ie. <code>tr &quot;[:upper:][:lower:]&quot; &quot;[:lower:][:upper:]&quot;</code></li>
			<li><code>size_t Shizzle(char *a1, char *a2)</code> reverses <code>a1</code> &rarr; <code>a2</code>, iff #<code>a1</code> &#61;&#61; 16 <code>char</code>s</li>
			<li><code>size_t Fizzle(char *a1, char *a2)</code> performs <code>char</code> transformation in printable ASCII range on <code>a1</code>, then swaps halves of result, producing <code>a2</code></li>
		</ul></li>
<pre class="wrap" style="padding:.5em;"><code>/*Java*/
String bizzle(String s)
{
	char[] chars = s.toCharArray();
	for(int i = 0; i &lt; chars.length; i++)
	{
		char c = chars[i];
		if((c &gt;= 'a') &amp;&amp; (c &lt; 'z'))
		{
			c = (char)(c + '\001');
		}
		else if(c == 'z')
		{
			c = 'a';
		}
		else if((c &gt;= 'A') &amp;&amp; (c &lt; 'Z'))
		{
			c = (char)(c + '\001');
		}
		else if(c == 'Z')
		{
			c = 'A';
		}
		chars[i] = c;
	}
	return new String(chars);
}
String rizzle(String s)
{
	char[] chars = s.toCharArray();
	for(int i = 0; i &lt; chars.length; i++)
	{
		char c = chars[i];
		if(Character.isUpperCase(c))
		{
			chars[i] = Character.toLowerCase(c);
		}
		else if(Character.isLowerCase(c))
		{
			chars[i] = Character.toUpperCase(c);
		}
	}
	return new String(chars);
}

/*DLL*/
size_t Fizzle(char *a1, char *a2)
{
	size_t result; // eax@1
	int v3; // ecx@3
	int v4; // eax@5
	int v5; // edx@8
	int v6; // edx@8
	char v7; // al@10
	char v8; // dl@10
	char v9; // al@10
	char v10; // dl@10
	char v11; // al@10
	char v12; // dl@10
	char v13; // al@10
	char v14; // dl@10
	char v15; // al@10
	char v16; // dl@10
	char v17; // al@10
	char v18; // dl@10
	char v19; // al@10
	char v20; // dl@10
	result = strlen(a1);
	if ( result == 16 )
	{
		v3 = 0;
		do
		{
			while ( 1 )
			{
				v4 = a1[v3];
				if ( (int)(v4 - 32) &gt; 'Z' )
					break;
				a2[v3] = (v4 + v3 * v3 - 27) % 91 + 32;
				++v3;
				if ( v3 == 16 )
					goto LABEL_7;
			}
			a2[v3++] = v4;
		}
		while ( v3 != 16 );
LABEL_7:
		if ( a2 &amp; 3 )
		{
			v7 = a2[8];
			a2[8] = a2;
			v8 = a2[1];
			a2 = v7;
			v9 = a2[9];
			a2[9] = v8;
			v10 = a2[2];
			a2[1] = v9;
			v11 = a2[10];
			a2[10] = v10;
			v12 = a2[3];
			a2[2] = v11;
			v13 = a2[11];
			a2[11] = v12;
			v14 = a2[4];
			a2[3] = v13;
			v15 = a2[12];
			a2[12] = v14;
			v16 = a2[5];
			a2[4] = v15;
			v17 = a2[13];
			a2[13] = v16;
			v18 = a2[6];
			a2[5] = v17;
			v19 = a2[14];
			a2[14] = v18;
			v20 = a2[7];
			a2[6] = v19;
			result = a2[15];
			a2[15] = v20;
			a2[7] = result;
		}
		else
		{
			v5 = a2[8];
			a2[8] = a2;
			result = a2[4];
			a2 = v5;
			v6 = a2[12];
			a2[12] = result;
			a2[4] = v6;
		}
		a2[16] = 0;
	}
	else
	{
		a2 = 0;
	}
	return result;
}
size_t Shizzle(char *a1, char *a2)
{
	size_t result;
	result = strlen(a1);
	if ( result == 16 )
	{
		a2[15] = *a1;
		a2[14] = a1[1];
		a2[13] = a1[2];
		a2[12] = a1[3];
		a2[11] = a1[4];
		a2[10] = a1[5];
		a2[9] = a1[6];
		a2[8] = a1[7];
		a2[7] = a1[8];
		a2[6] = a1[9];
		a2[5] = a1[10];
		a2[4] = a1[11];
		a2[3] = a1[12];
		a2[2] = a1[13];
		a2[1] = a1[14];
		result = a1[15];
		a2[16] = 0;
		a2 = result;
	}
	else
	{
		a2 = 0;
	}
	return result;
}
</code></pre>
			<li class="dash">Python code to undo effects of these functions (called in reverse order to invocation of their original counterparts)</li>
<pre class="wrap" style="padding:.5em;"><code class="python">#!/usr/bin/env python
#-*- coding: utf-8 -*-

import sys
import codecs
import string

sys.stdout = codecs.getwriter(&quot;utf8&quot;)(sys.stdout)
sys.stderr = codecs.getwriter(&quot;utf8&quot;)(sys.stderr)

def unfizzle_undo(c, idx):
	c = ord(c)
	c -= 32
	n = 0
	while True:
		cc = c + n * 91 + (27 - (idx * idx))
		if 32 &lt;= cc &lt;= 122: break
		n += 1
	c = cc
	c = chr(c)
	return c
def unfizzle(s):
	ss = list(s)
	ss[:8], ss[8:] = ss[8:], ss[:8]
	for i in xrange(15,-1,-1):
		ch = ss[i]
		if ord(ch) &gt; ord(&quot;z&quot;): continue
		else: ss[i] = unfizzle_undo(ch, i)
	return &quot;&quot;.join(ss)
def unrizzle(s):
	ret = []
	for c in s:
		if c in string.ascii_letters:
			if c.isupper(): ret.append(c.lower())
			elif c.islower(): ret.append(c.upper())
		else: ret.append(c)
	return &quot;&quot;.join(ret)
def unshizzle(s): return s[::-1]
def unbizzle(s):
	ret = []
	for c in s:
		added = False
		for lst in [string.ascii_lowercase, string.ascii_uppercase]:
			if c in lst:
				ret.append(lst[(lst.index(c)-1+len(lst))%len(lst)])
				added = True
				break
		if not added: ret.append(c)
	return &quot;&quot;.join(ret)

if __name__ == &quot;__main__&quot;:
	k = &quot;v3O] pmWm&lt;Y(0=21&quot;
	for i in xrange(10):
		k = unbizzle(unshizzle(unrizzle(unfizzle(k))))
	print k
</code></pre>
			<li class="dash">provide key: <code class="ans">jadnIdal0vecod3n</code> to original <code>JadAndIda.class</code>, which decrypts <code>s3cr3t.bin</code> &rarr; <code class="ans">eggizzle_25.png</code></li>
	</ul>

	<hr class="print-hidden"><li id="qn26" class="qn print-before"><a href="http://hackyeaster.hacking-lab.com/hackyeaster/challenge26.html"><u>Clumsy Cloud</u></a> (<a href="file/ps.hacking.hackyeaster.android.apk">mobile</a>)</li>
<pre class="wrap" style="padding:.5em;">
Welcome to Clumsy Cloud™!
If your files are the eggs, then we are the hen™.

We encrypt all your files, with a strong passphrase. The passphrase is kept securely in this app, protected by a PIN.
</pre>

<style type="text/css">
#lvl26{background:#f7f7f7 url("img/bg-m.png");padding:7px;}.box{background:#fff;border-bottom:solid 1px #ccc}.box .image.featured{position:relative;width:auto}.box{padding:15px 15px 20px}.box .image.featured{left:15px;top:15px;margin:-15px 0 -13px -30px;max-width:400px;align:center}.box .image.featured.details{left:15px;top:0;margin:-15px 0 7px -30px}section,article{margin:0 0 1.5em 0 !important;}#lvl26 .button,#lvl26 button,input[type=button],input[type=submit],input[type=reset]{position:relative;padding:.65em 0;text-align:center;font-size:1.25em;-webkit-appearance:none;display:inline-block;text-decoration:none;cursor:pointer;border:0;border-radius:5px;background:#4923a0;color:#fff!important;font-weight:700;outline:0;-moz-transition:background-color .25s ease-in-out;-webkit-transition:background-color .25s ease-in-out;-o-transition:background-color .25s ease-in-out;-ms-transition:background-color .25s ease-in-out;transition:background-color .25s ease-in-out}.pinKeyRow{display:inline-block}#lvl26 .downloadButton{width: 100%;margin:0.25em 0 0.25em 0;}.pinButton{display:inline-block;font-size:24px;width:60px;height:60px;margin:4px 7px;text-align:center;float:left;padding:0}.pinField{display:block;background-color:#eee;width:208px;margin-left:7px;padding-top:5px;height:48px;border-radius:5px;text-align:center;font-size:64px}
</style>
<script type="text/javascript">
var pinPressed = function (n){if(-1===n)return pinEntered="",void $("#pin").html("");pinEntered+=n;var e="";for(i=0;i<pinEntered.length;i++)e+="&#x2022;";for(i=pinEntered.length;i<4;i++)e+="-";$("#pin").html(e),pinEntered.length>=4&&setTimeout(function(){$("#pin").html("----"),/*window.location="ps://pin?"+pinEntered,*/pinEntered=""},200)};var pinEntered="";
</script>
<div id="lvl26">
<article class="box post"><header><h2>Download Files</h2></header><p> Enter your PIN to download your secret files. </p><p><span class="pinField" id="pin">----</span></p><p data-dynamite-selected="true"><span class="pinKeyRow"><button type="button" class="pinButton" id="pin1" onclick="pinPressed(1);">1</button><button type="button" class="pinButton" id="pin2" onclick="pinPressed(2);">2</button><button type="button" class="pinButton" id="pin3" onclick="pinPressed(3);">3</button></span><br><span class="pinKeyRow"><button type="button" class="pinButton" id="pin4" onclick="pinPressed(4);">4</button><button type="button" class="pinButton" id="pin5" onclick="pinPressed(5);">5</button><button type="button" class="pinButton" id="pin6" onclick="pinPressed(6);">6</button></span><br><span class="pinKeyRow"><button type="button" class="pinButton" id="pin7" onclick="pinPressed(7);">7</button><button type="button" class="pinButton" id="pin8" onclick="pinPressed(8);">8</button><button type="button" class="pinButton" id="pin9" onclick="pinPressed(9);">9</button></span><br><span class="pinKeyRow"><button type="button" class="pinButton" style="margin-left: 80px;" id="pin0" onclick="pinPressed(0);">0</button><button type="button" class="pinButton" style="background-color: #d52323" id="pinClear" onclick="pinPressed(-1);">clr</button></span></p></article><article class="box post"><header><h2>Backup</h2></header><p> Worried about losing your phone? Simply create a backup of your passphrase. </p><a href="file/passphrase_backup.txt"><button type="button" class="downloadButton">Backup Key</button></a></article>
</div>
	<ul>
		<li class="dash">looking up lvl-specific param eg. &quot;<code>ovaederecumsale</code>&quot; or &quot;<code>8QeNdEdkspV6+1I77SEEEF4aWs5dl/auahJ46MMufkg=</code>&quot;; or even &quot;egg_26.png&quot; reveals relevant code block
		<li class="dash none">@ <code>/src/src/ps/hacking/hackyeaster/android/Activity.java</code>:</li>
<pre class="wrap" style="padding:.5em;"><code class="java">&#8230;
private int a(String s, Context context)
{
	try
	{
		<font color="red">SecretKeySpec secretkeyspec = new SecretKeySpec(a(s, "ovaederecumsale", 10000), "AES");
		Cipher cipher = Cipher.getInstance("AES");
		cipher.init(2, secretkeyspec);
		String s1 = new String(cipher.doFinal(Base64.decode("8QeNdEdkspV6+1I77SEEEF4aWs5dl/auahJ46MMufkg=", 0)));</font>

		DownloadManager downloadmanager = (DownloadManager)getSystemService("download");
		android.app.DownloadManager.Request request = new android.app.DownloadManager.Request(Uri.parse((new StringBuilder("http://hackyeaster.hacking-lab.com/hackyeaster/pin?p=")).append(s1).toString()));
		request.setTitle("Hacky Easter");
		request.setDescription("Egg Download");
		request.setDestinationInExternalPublicDir(Environment.DIRECTORY_DOWNLOADS, "egg_26.png");
		registerReceiver(new d(this), new IntentFilter("android.intent.action.DOWNLOAD_COMPLETE"));
		downloadmanager.enqueue(request);
		Toast.makeText(context, "Download started", 0).show();
	}
	catch (Exception exception)
	{
		return 1;
	}
	return 0;
}
&#8230;
<font color="red">public static byte[] a(String s, String s1, int i1)
{
	MessageDigest messagedigest = MessageDigest.getInstance("SHA1");
	byte abyte0[] = (new StringBuilder(String.valueOf(s1))).append(s).toString().getBytes();
	int j1 = 0;
	do
	{
		if (j1 >= i1)
		{
			byte abyte1[] = new byte[16];
			System.arraycopy(abyte0, 0, abyte1, 0, 15);
			return abyte1;
		}
		abyte0 = messagedigest.digest(abyte0);
		j1++;
	} while (true);
}</font>
&#x2026;
</code></pre>
		<li class="dash"><code>public static byte[] a(String s, String s1, int i1)</code> &#61;&#61; hashing routine;
		<li class="dash">while <code>private int a(String s, Context context)</code> performs decryption, due to <code>2</code> in <code>cipher.init(<font color="red">2</font>, secretkeyspec)</code>, using supplied PIN</li>
		<li class="dash">reusing these 2 routines highlighted in <font color="red">red</font>; except swapping Android for Java8 Base64 decoding:</li>
<pre class="wrap" style="padding:.5em;"><code class="java">import java.util.Base64;
&#8230;
	Base64.Decoder decoder = Base64.getDecoder();
	byte[] dec64 = decoder.decode("8QeNdEdkspV6+1I77SEEEF4aWs5dl/auahJ46MMufkg=");
	String s1 = new String(cipher.doFinal(dec64));
&#x2026;
</code></pre>
		<li class="dash">then exhaustively enum all 4-digit PIN combo, looking out for any ASCII-readable txt</li>
<pre class="wrap" style="padding:.5em;"><code class="java">import java.util.Base64;
&#8230;
	for(int i=0; i<9999; i++)
	{
		String PIN = String.format("%04d", i);
		String ciphertxt = crypt(PIN);
		if (ciphertxt != null
		&& ciphertxt.matches("^\\p{ASCII}*$"))
		{
			System.out.println(PIN+": "+ciphertxt);
			break;
		}
	}
&#x2026;
</code></pre>
		<li class="dash">finds PIN=<code>7113</code>, linked to passwd=<code>wirestarter54321</code></li>
		<li class="dash none">@ <a class="ans" href="http://hackyeaster.hacking-lab.com/hackyeaster/pin?p=wirestarter54321" style="color:red !important;">http://hackyeaster.hacking-lab.com/hackyeaster/pin?p=wirestarter54321</a></li>
	</ul>

	<hr class="print-hidden"><li id="qn27" class="qn print-before"><a href="http://hackyeaster.hacking-lab.com/hackyeaster/challenge27.html"><u>Too Many Time Pad</u></a></li>
<pre class="wrap" style="padding:.5em;">
You intercepted messages exchanged by evil Dr. Hopper and his agents. They used a <strong>One Time Pad</strong> for achieving perfect secrecy. Lucky for you, they have miserably failed, since the same key was used multiple times

Check out the ciphertexts, and try to decrypt them

Hint: The plaintexts consist of <u>lowercase letters</u> and <u>spaces</u> only

<code class="nohighlight hljs">60c46964f83879618e2878de539f6f4a6271d716
63c37a6ca177792092602cc553c9684b
68d82c6bf4767f79dd617f9642d768057f63c1
6c8a7b6ce06a3161dd6a60d755d42d4d6d67
71c26929e96931698e2865d816d3624b687cd6
6cda6d6df87764709c6c7bd357d361556d77</code></pre>
	<ul>
		<li class="dash">employ atk technique known as &quot;<a class="print-link" href="http://travisdazell.blogspot.sg/2012/11/many-time-pad-attack-crib-drag.html">crib drag</a>&quot;
		<ul>
			<li class="dash">define:crib - known/guessed piece of plaintext</li>
			<li class="none"><u>Outline</u></li>
		</ul>
		<ol>
			<li>Guess a word that might appear in 1 of the ciphertext, eg. &quot;the &quot;</li>
			<li>Encode (word from step 1) as hex string</li>
			<li>XOR 2 ciphertexts</li>
			<li>XOR (hex string from step 2) @ each pos of (XOR(2 cipher-texts (from step 3)))</li>
 			<li style="list-style-type: none;">5a. When result from step 4 &#61;&#61; readable English text, guess the English word and expand crib search</li>
            <li style="list-style-type: none;">5b. Otherwise, try XOR of crib word @ nxt pos</li>
		</ol></li>
		<li class="dash none"><a href="file/lvl27-cribtastic.py"><img src="img/lvl27.jpg" style="border-color:blue;"></a></li>
		<li class="dash">key: <code>05aa0c0981181100fd080cb636bf0d250c13b878</code></li>
		<li class="dash none"><u>plaintext</u></li>
<pre class="wrap" style="padding:.5em;">
enemy has the bonbon
five oh oh seven
mr bunny is the spy
i wear a black hat
the hq is in london
<font class="ans">ipadyoupadweallpad</font>
</pre>
	</ul>
</ul>
<div class="print-before"><img src="2015HE.png"></div>

<style type="text/css">
	#eggs {font-size: 13pt; line-height: 1.75em; font-family: "Source Sans Pro"; font-weight: 300; color: #2d2d2d; clear: none; margin-left: 0; float: left;}
	#eggs .eggImage{display:inline-block;margin:-15px -30px;height:240px;width:240px;background-size:240px 240px;}
	.easyEgg{background-image:url("img/egg_easy.png");}
	.mediumEgg{background-image:url("img/egg_medium.png");}
	.hardEgg{background-image:url("img/egg_hard.png");}
	.eggTitle,.eggQR{text-align:center;position:relative;width:100%;display:inline-block;}
	.eggTitle{top:50px;font-size:3.5em;font-weight:bold;color:#000;}
	.eggQR{top:65px;font-size:1.2em;font-weight:bold;}
</style>
<div id="eggs" class="print-before" style="border:1px dashed #000;"></div>

<center class="print-hidden">--- <strong>FIN</strong> ---</center>
</div></div></div>
<script type="text/javascript" src="https://code.jquery.com/jquery-1.11.3.min.js"></script>
<script type="text/javascript" src="js/jquery.qrcode.min.js"></script>
<script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/highlight.min.js"></script>
<script type="text/javascript">
	//hljs.configure({useBR: true});
	hljs.initHighlightingOnLoad();
</script>
<script type="text/javascript">
	$(function () {
		"use strict";

		$(".hash.lvl22").append(function() {
			return "&nbsp;<span>("
				+$(this).text().length
			+" chars)</span>";
		});

		var qr_codes = [null, "Ohlnlgu4C72CHZLWls7f","Gc1lEc7j4y89sTiLWK6m","vpmP0wgxXAdKDGAjdbn6","dLYFunszMowTRHovQx2y","wummMC1dk7EWF97vQMZu","U1TPdguTrTi6uvhwYQOp","vUkFUmo4jola9izLhdS8","B6gZYdONrcSnRlDlvQ03","K3sUBDOu5BtGDtcJ9lgc","ict7vc9uWE5zBGH0oiuj","lZkG3aWzrpYrIWoBX5Kz","an8snbui1FeLO3Ugw89N","vBrtvkpHNRCNZdhZN1nT","yckgKB2iV1rvNEfCoNiR","2N6R5IF2bFmK6nyw6Lnq","a3eIIACKSy02sJ6LxXeh","nYa3ktAoTAQc6yxMAGoM","j9rU8ma6nBfz986gJZmf","zDU6QXeWUfvjtZJxbEnC","PRKuX3CklkoZWwfOHbpK","LvJ3dQ1lrEfzwb61VEEl","mW5Z5nZuqVPtewn754U6","j7vzfUzftszdf754fXDS","w2Rz6VToU8g6Hzfte2VG","m7z6bTZlGQ0bZUd7gzhN","po9Jbzo1337biugGIUda"/*, null*/];
		for (var i=1; i<qr_codes.length; i++) {
			var lvl = (i<10)?("0"+i):i;
			var elem = $("<span>");
			var diff = null;
			if (1<=i && i<=9) {
				diff = "easy";
			} else if (10<=i && i<=18) {
				diff = "medium";
			} else {
				diff = "hard";
			}
			$(elem).attr("class", "eggImage "+diff+"Egg");
			$(elem).append("<span class='eggTitle'>"+lvl+"</span>");
			$(elem).append("<span id='egg-lvl"+lvl+"' class='eggQR'></span>");
			$("#eggs").append(elem);
			$("#eggs #egg-lvl"+lvl).qrcode({
				/*render: "image",*/ size: 75,
				left: 0, top: 0, fill: "#000",
				text: qr_codes[i],
				label: qr_codes[i]
			});
		}
		var elem = $("<span>");
		$(elem).attr("class", "eggImage");
		$(elem).append("<img src='img/challenge27.png' width=240 height=240 style='border:none;vertical-align:middle;position:relative;top:3px;'>");
		$("#eggs").append(elem);
		$("#lvl8 td:not(:first-child)").each(function () {
			$(this).css("background-color", $(this).text()==="0"?"#000":"#fff");
		});
	});
</script>
</body></html>
