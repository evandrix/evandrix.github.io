<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>20160501: Hacky Easter 2016 - writeup</title>
	<link rel="stylesheet" type="text/css" href="/css/all.min.css">
	<link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Ubuntu+Mono:400">
	<link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Open+Sans">
	<link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.4.0/styles/default.min.css">
	<link rel="stylesheet" type="text/css" href="//vjs.zencdn.net/5.9.2/video-js.css">
	<script type="text/javascript" src="//vjs.zencdn.net/ie8/1.1.2/videojs-ie8.min.js"></script>
	<style type="text/css">
		/* video.js */
		.vjs-menu-button-popup .vjs-menu ul.vjs-menu-content {
			margin: 0 !important;
		}
		/* */
		.btn-dl {
			font-size: 1.1em;
			padding: 0.65em 1.5em 0.65em 1.5em;
			line-height: 1.75em;
			-webkit-appearance: none;
			display: inline-block;
			text-decoration: none;
			cursor: pointer;
			border: 0;
			border-radius: 5px;
			background: #4923a0;
			color: #fff;
			font-weight: 700;
			outline: 0;
			-moz-transition: background-color .25s ease-in-out;
			-webkit-transition: background-color .25s ease-in-out;
			-o-transition: background-color .25s ease-in-out;
			-ms-transition: background-color .25s ease-in-out;
			transition: background-color .25s ease-in-out;
		}
		@media print {
			.wrap-print {
				white-space: pre-wrap;
				word-break: break-all;
			}
		}
	</style>
</head>
<body>
	<div id="content">
		<div id="post">
		<h1><a href="http://www.timeanddate.com/worldclock/fixedtime.html?iso=20160430T1600">20160501</a>: <a href="http://hackyeaster.hacking-lab.com/hackyeaster/challenges.html">Hacky Easter 2016</a> - writeup</h1>
		<div id="postinfo">
			<div id="postdate"></div>
			<div id="posttags">tags: netsec, ctf, hacking-lab, hacky, easter, 2016, he2016</div>
		</div>
		<div id="postbody">
<center>
	<i><a class="print-link" href="http://zxing.org/w/decode.jspx">QR code decoder</a><br>all keys in lowercase only</i>
</center>
<ol>
	<li id="qn0" class="qn print-hidden" value="0">
		<a href="index-teaser.html"><u><font color="red">Teaser Challenge</font></u></a>
	</li>

	<li id="qn1" class="qn"><u>Easy One</u></li>
<pre class="wrap" style="padding:.5em;">
As always, the first challenge is very easy. Even babies can solve this one!

Find the code and enter it in the Egg-O-Matic‚Ñ¢ below! One word, all lowercase.

xt   hex   yhi   dde   nyy   str
in   gyy   isy   ymo   lly   cod
dl   exy   sox   xsi   mpl   eyüöº
</pre>
	<ul>
		<li class="dash">remove whitespace =&gt; x<font class="ans">the</font>xy<font class="ans">hidden</font>yy<font class="ans">string</font>yy<font class="ans">is</font>yy<code class="ans">mollycoddle</code>xy<font class="ans">so</font>xx<font class="ans">simple</font>y</li>
	</ul>

	<hr class="print-hidden">
	<li id="qn2" class="qn print-before"><u>Just Cruisin'</u></li>
<pre class="wrap" style="padding:.5em;">
Need a holiday? Book a cruise on our new flag ship!

Seek out the promotion code below (lowercase only, no spaces) and get a free welcome package!
</pre>
<style type="text/css">
	img.shipflag {
		width: 72px;
		height: 72px;
		margin: 16px;
		border: 1px solid #000;
	}
</style>
<img class="shipflag" src="img/flag01.svg"><img class="shipflag" src="img/flag02.svg"><img class="shipflag" src="img/flag03.svg"><img class="shipflag" src="img/flag04.svg"><img class="shipflag" src="img/flag05.svg"><br><img class="shipflag" src="img/flag06.svg"><img class="shipflag" src="img/flag07.svg"><img class="shipflag" src="img/flag08.svg"><img class="shipflag" src="img/flag09.svg"><img class="shipflag" src="img/flag10.svg"><br><img class="shipflag" src="img/flag11.svg"><img class="shipflag" src="img/flag01.svg"><img class="shipflag" src="img/flag12.svg"><img class="shipflag" src="img/flag13.svg"><img class="shipflag" src="img/flag12.svg"><br><img class="shipflag" src="img/flag01.svg"><img class="shipflag" src="img/flag08.svg"><img class="shipflag" src="img/flag14.svg"><img class="shipflag" src="img/flag10.svg"><img class="shipflag" src="img/flag15.svg"><br><img class="shipflag" src="img/flag01.svg"><img class="shipflag" src="img/flag01.svg"><img class="shipflag" src="img/flag16.svg"><img class="shipflag" src="img/flag17.svg"><img class="shipflag" src="img/flag01.svg">
	<ul>
		<li class="dash"><code class="ans">enjoyafreshseabreeze</code></li>
	</ul>

	<hr class="print-hidden">
	<li id="qn3" class="qn print-before"><u>Bird's Nest</u> (<a href="file/ps.hacking.hackyeaster.android.apk">mobile</a>)</li>
	@ <code>/assets/www/challenge03.html</code>:
<pre class="wrap" style="padding:.5em;">
The little bird has hidden an egg in its nest. Can you find it?

<img src="img/nest.jpg">
</pre>
	<ul>
		<li class="dash">@ <a href="//twitter.com/8lueL1ttleB1rd/status/720201875945984001">//twitter.com/8lueL1ttleB1rd/status/720201875945984001</a></li>
		<li><img src="img/egg03-tweet=720201875945984001.png"></li>
		<li class="dash">@ <a href="//bit.ly/1JjtbId">//bit.ly/1JjtbId</a></li>
		<li>=&gt; <a href="//hackyeaster.hacking-lab.com/hackyeaster/images/egg03_jPr5bJuNexwI4NsRkEcs.png">//hackyeaster.hacking-lab.com/hackyeaster/images/egg03_jPr5bJuNexwI4NsRkEcs.png</a></li>
	</ul>

	<hr class="print-hidden">
	<li id="qn4" class="qn print-before"><u>Sound Check</u> (<a href="file/ps.hacking.hackyeaster.android.apk">mobile</a>)</li>
	@ <code>/assets/www/challenge04.html</code>:
<pre class="wrap" style="padding:.5em;">
The new sound system needs a check. Sharpen your ears and listen carefully!

<button class="btn-dl">Start sound check</button>
</pre>
	<ul>
		<li class="dash">@ <code>ps.hacking.hackyeaster.android.SoundActivity</code>:
<pre class="wrap" style="padding:.5em;"><code>&#8230;
byte[] woozle = Base64.decode(this.val$activity.getString(C0174R.string.woozle), 0);
for (int i = 0; i < woozle.length; i++) {
	woozle[i] = (byte) (woozle[i] ^ i);
}
&#x2026;
</code></pre></li>
		<li class="dash"><pre class="wrap" style="padding:.5em;"><code>#!/usr/bin/env python
#-*- coding: utf-8 -*-

import sys
import struct

data = bytearray(open(&quot;<a href="file/egg04-woozle.in">egg04-woozle.in</a>&quot;, &quot;rb&quot;).read())
key = map(int, list(xrange(len(data))))
o = [(data[i]^key[i])%256 for i in xrange(len(data))]
with open(&quot;egg04-woozle.png&quot;, &quot;wb&quot;) as f: f.write(bytearray(o))
print &quot;egg04-woozle.in =&gt; egg04-woozle.png&quot;</code></pre></li>
	</ul>

	<hr class="print-hidden">
	<li id="qn5" class="qn print-before"><u>Play it again, Paul</u></li>
<pre class="wrap" style="padding:.5em;">
Do you know Paul? If not, it's about time to get to know him! Check out his video below!
ƒàu vi scias Pa≈≠lo? Se ne, ƒùi estas pri tempo ekkoni lin! Kontroli lian video sube!
</pre>
<video id="video" class="video-js vjs-default-skin" controls preload="metadata" width="480" height="400" poster="img/paul/poster.png" data-setup="">
<source src="file/paul/video.mp4" type="video/mp4"><source src="file/paul/video.webm" type="video/webm"><source src="file/paul/video.ogv" type="video/ogg">
<track label="English" kind="captions" srclang="en" src="file/paul/video-en.vtt" default><track label="Deutsch" kind="captions" srclang="de" src="file/paul/video-de.vtt"><track label="Fran√ßais" kind="captions" srclang="fr" src="file/paul/video-fr.vtt"><track label="Esperanto" kind="captions" srclang="eo" src="file/paul/video-eo.vtt"></video>
	<ul>
		<li class="dash">hint to look in <a href="file/paul/video-eo.vtt">Esperanto subtitle file</a>, since given translation (second line) is in Esperanto</li>
		<li class="dash">
<pre class="wrap" style="padding:.5em;"><code>1
00:01:00.000 --> 00:01:03.000
passphrase is &quot;<font class="ans">youtubelotitis</font>&quot;</code></pre></li>
		<!--
			$ mediainfo file/paul/video.mp4
			# Text #4
			# ID                                       : 7
			# Format                                   : Timed Text
			# Muxing mode                              : sbtl
			# Codec ID                                 : tx3g
			# Duration                                 : 1mn 3s
			# Bit rate mode                            : Variable
			# Bit rate                                 : 82 bps
			# Stream size                              : 644 Bytes (0%)
			# Language                                 : Esperanto
			# Encoded date                             : UTC 2015-08-25 20:48:27
			# Tagged date                              : UTC 2015-08-25 20:48:27

			$ ffmpeg -i file/paul/video.mp4
			# Stream #0:6(epo): Subtitle: mov_text (tx3g / 0x67337874), 1152x60, 0 kb/s

			$ ffmpeg -i file/paul/video.mp4 -an -vn -map 0:6 -c:s:0 srt file/paul/epo.srt
			# passphrase is "youtubelotitis"
		-->
	</ul>

	<hr class="print-hidden">
	<li id="qn6" class="qn print-before"><u>Going Up</u></li>
<pre class="wrap" style="padding:.5em;">
Time for an elevator ride. Guess the right floor, and find the hidden easter egg!
</pre>
<style type="text/css">
	.tablediv { display: table; }
	.tablerow { display: table-row; }
	.tablecell { display: table-cell; }

	.round-button {
		/*width: 75px;
		height: 75px;*/
		margin-left: 5px;
		margin-right: 5px;
		margin-bottom: 5px;
		float: left;
	}
	.round-button-circle {
		width: 75px;
		height: 75px;
		padding-bottom: 0px;
		border-radius: 50%;
		border: 10px solid #333;
		overflow: hidden;
		background: #eee none repeat scroll 0% 0%;
		box-shadow: 0px 0px 3px #555;
	}
	.round-button-circle:hover {
		background: #666;
	}
	.round-button a {
		display:block;
		float:left;
		width:100%;
		padding-top:50%;
		padding-bottom:50%;
		line-height:1em;
		margin-top:-0.5em;
		margin-left: 0;
		text-align:center;
		color:#333 !important;
		font-family:Verdana;
		font-size:1.2em;
		font-weight:bold;
		text-decoration:none;
	}
</style>
<div class="tablediv" id="table"><div class="tablerow"><div class="tablecell" style="width: 25%; padding-bottom: 10px;"><div class="round-button" onclick="return false;"><div class="round-button-circle"><a href="?floor=sixteen" class="round-button" onclick="return false;">16</a></div></div><div class="round-button" onclick="return false;"><div class="round-button-circle"><a href="?floor=seventeen" class="round-button" onclick="return false;">17</a></div></div><div class="round-button" onclick="return false;"><div class="round-button-circle"><a href="?floor=eighteen" class="round-button" onclick="return false;">18</a></div></div></div></div><div class="tablerow"><div class="tablecell" style="width: 25%; padding-bottom: 10px;">
<div class="round-button" onclick="return false;"><div class="round-button-circle" style="background-color:yellow;" ><a href="?sybbe=punatrzr" class="round-button" onclick="return false;">13</a></div></div>
<div class="round-button" onclick="return false;"><div class="round-button-circle"><a href="?floor=fourteen" class="round-button" onclick="return false;">14</a></div></div><div class="round-button" onclick="return false;"><div class="round-button-circle"><a href="?floor=fifteen" class="round-button" onclick="return false;">15</a></div></div></div></div><div class="tablerow"><div class="tablecell" style="width: 25%; padding-bottom: 10px;"><div class="round-button" onclick="return false;"><div class="round-button-circle"><a href="?floor=ten" class="round-button" onclick="return false;">10</a></div></div><div class="round-button" onclick="return false;"><div class="round-button-circle"><a href="?floor=eleven" class="round-button" onclick="return false;">11</a></div></div><div class="round-button" onclick="return false;"><div class="round-button-circle"><a href="?floor=twelve" class="round-button" onclick="return false;">12</a></div></div></div></div><div class="tablerow"><div class="tablecell" style="width: 25%; padding-bottom: 10px;"><div class="round-button" onclick="return false;"><div class="round-button-circle"><a href="?floor=seven" class="round-button" onclick="return false;">07</a></div></div><div class="round-button" onclick="return false;"><div class="round-button-circle"><a href="?floor=eight" class="round-button" onclick="return false;">08</a></div></div><div class="round-button" onclick="return false;"><div class="round-button-circle"><a href="?floor=nine" class="round-button" onclick="return false;">09</a></div></div></div></div><div class="tablerow"><div class="tablecell" style="width: 25%; padding-bottom: 10px;"><div class="round-button" onclick="return false;"><div class="round-button-circle"><a href="?floor=four" class="round-button" onclick="return false;">04</a></div></div><div class="round-button" onclick="return false;"><div class="round-button-circle"><a href="?floor=five" class="round-button" onclick="return false;">05</a></div></div><div class="round-button" onclick="return false;"><div class="round-button-circle"><a href="?floor=six" class="round-button" onclick="return false;">06</a></div></div></div></div><div class="tablerow"><div class="tablecell" style="width: 25%; padding-bottom: 10px;"><div class="round-button" onclick="return false;"><div class="round-button-circle"><a href="?floor=one" class="round-button" onclick="return false;">01</a></div></div><div class="round-button" onclick="return false;"><div class="round-button-circle"><a href="?floor=two" class="round-button" onclick="return false;">02</a></div></div><div class="round-button" onclick="return false;"><div class="round-button-circle"><a href="?floor=three" class="round-button" onclick="return false;">03</a></div></div></div></div></div>
<div id="fail" style="width: 300px;background: rgba(221,221,221,0.5);border: 1px solid #000;">Nope! Click the image to try again!<br/><img class="no-border" src="img/elevator_fail.jpg" style="width: 284px;" onclick="javascript:window.location.href='challenge06.html';" /></div>
	<ul>
		<li class="dash">one of the links is not like the others: btn #13 links to <a href="?sybbe=punatrzr" onclick="return false;">?sybbe=punatrzr</a></li>
		<li class="dash"><code>rot13</code> => <a href="?floor=changeme" onclick="return false;">?floor=changeme</a></li>
		<li class="dash">so <a href="?floor=thirteen" onclick="return false;">?floor=thirteen</a> => <code>rot13</code> => <a class="ans" href="//hackyeaster.hacking-lab.com/hackyeaster/challenge06.html?sybbe=guvegrra">?sybbe=guvegrra</a></li>
		<li class="ans">@ <a href="//hackyeaster.hacking-lab.com/hackyeaster/challenge06_8ce833745ef167679aa44d6d6c098ab6abf8ec80.html">//hackyeaster.hacking-lab.com/hackyeaster/challenge06_8ce833745ef167679aa44d6d6c098ab6abf8ec80.html</a></li>
		<!--
			p = window.location.search; //?sybbe=guvegrra
			if (p) {
				if (CryptoJS.SHA1(CryptoJS.SHA1(p)) == "ed64517461f2d60887f75c2ea4d8a0b03f5ece49") {
					window.location.href = "challenge06_" + CryptoJS.SHA1(p) + ".html";
				}
				...
			}
		-->
	</ul>

	<hr class="print-hidden">
	<li id="qn7" class="qn print-before"><u>Wise Rabbit Once More</u></li>
<pre class="wrap" style="padding:.5em;">
Wise Rabbit says:

<i>The solution is in the solutions!
Go back and scroll to 123!</i>
</pre>
	<ul>
		<li class="dash"><a href="//media.hacking-lab.com/hackyeaster/HackyEaster2015_Solutions_high.pdf">2015HE solution document</a> pg #123</li>
		<li class="dash">password: <code class="ans">goldfish</code></li>
	</ul>

	<hr class="print-hidden">
	<li id="qn8" class="qn print-before"><u>Just Drive</u> (<a href="file/ps.hacking.hackyeaster.android.apk">mobile</a>)</li>
	@ <code>/assets/www/challenge08.html</code>:
<pre class="wrap" style="padding:.5em;"><code>var solved = false;
var hist = &quot;&quot;;
&#8230;
function rotFeedback(jsonString) {
	if (json) {
		hist = json.h;
		if (json.k) {
			solved = true;
		} else if (json.s &gt; 1) {
			$(&quot;#rotImg&quot;).attr(&quot;src&quot;, &quot;images/rot/rot&quot;+json.s+&quot;.png&quot;);
		} else {
			$(&quot;#rotImg&quot;).attr(&quot;src&quot;, &quot;images/egg_gray.png&quot;);
		}
	}
}

setInterval(function () {
	if (!solved) {
		document.location.href = &quot;ps://<font class="ans">rot</font>?h=&quot; + hist;
	}
}, 1000);</code></pre>
	<ul>
		<li class="dash">@ <code>ps.hacking.hackyeaster.android.Activity</code>:</li>
<pre class="wrap" style="padding:.5em;"><code>private String handleRot(String s) {
	char c;
	switch (((WindowManager) getSystemService(&quot;window&quot;)).getDefaultDisplay().getRotation()) {
		case SwipeRefreshLayout.LARGE /*0*/:
			c = &#39;r&#39;;
			break;
		case SwipeRefreshLayout.DEFAULT /*1*/:
			c = &#39;n&#39;;
			break;
		case WearableExtender.SIZE_MEDIUM /*3*/:
			c = &#39;x&#39;;
			break;
		default:
			c = &#39;l&#39;;
			break;
	}
	if (!s.startsWith(BuildConfig.VERSION_NAME + c)) {
		s = c + s;
	}
	if (s.length() &gt; 8) {
		s = s.substring(0, 8);
	}
	int steps = 0;
	String key = BuildConfig.VERSION_NAME;
	String h = sha1(s);
	if (h.startsWith(&quot;4692bd56dd3070f74b7e&quot;)) {
		key = h;
	} else if (s.length() &gt;= 7 &amp;&amp; &quot;1ab9a97066f747c25d9c6a6b0fda647fae98cb98&quot;.equals(sha1(s.substring(0, 7)))) {
		steps = 7;
	} else if (s.length() &gt;= 6 &amp;&amp; &quot;58192f7d1263bd420efb788cc884a84f871239cf&quot;.equals(sha1(s.substring(0, 6)))) {
		steps = 6;
	} else if (s.length() &gt;= 5 &amp;&amp; &quot;e8f235e79be9f8b13598b285a6fdaf2ac70a66ca&quot;.equals(sha1(s.substring(0, 5)))) {
		steps = 5;
	} else if (s.length() &gt;= 4 &amp;&amp; &quot;3daee0c0bada99f5bf0866728fd78299acaafa15&quot;.equals(sha1(s.substring(0, 4)))) {
		steps = 4;
	} else if (s.length() &gt;= 3 &amp;&amp; &quot;f11fa81c0b72716bba0536dd34b9b0987af69b03&quot;.equals(sha1(s.substring(0, 3)))) {
		steps = 3;
	} else if (s.length() &gt;= 2 &amp;&amp; &quot;a8643e0e26d5ead82e73aae64966ca144f152d8a&quot;.equals(sha1(s.substring(0, 2)))) {
		steps = 2;
	} else if (s.length() &gt;= 1 &amp;&amp; &quot;4dc7c9ec434ed06502767136789763ec11d2c4b7&quot;.equals(sha1(s.substring(0, 1)))) {
		steps = 1;
	}
	return &quot;{ \&quot;s\&quot;: &quot; + steps + &quot;, \&quot;h\&quot;:\&quot;&quot; + s + &quot;\&quot;, \&quot;k\&quot;:\&quot;&quot; + key + &quot;\&quot; }&quot;;
}</code></pre>
		<li class="dash">crack SHA1 hashes using <code>cudaHashcat</code>; charset: `rnxl`</li>
		<ul>
			<li class="dash"><code class="ans">4692bd56dd3070f74b7e81c6b2f69339b0fd6062:&nbsp;nrxrxrnr</code></li>
			<li class="dash"><code>1ab9a97066f747c25d9c6a6b0fda647fae98cb98:&nbsp;&nbsp;rxrxrnr</code></li>
			<li class="dash"><code>58192f7d1263bd420efb788cc884a84f871239cf:&nbsp;&nbsp;&nbsp;xrxrnr</code></li>
			<li class="dash"><code>e8f235e79be9f8b13598b285a6fdaf2ac70a66ca:&nbsp;&nbsp;&nbsp;&nbsp;rxrnr</code></li>
			<li class="dash"><code>3daee0c0bada99f5bf0866728fd78299acaafa15:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xrnr</code></li>
			<li class="dash"><code>f11fa81c0b72716bba0536dd34b9b0987af69b03:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rnr</code></li>
			<li class="dash"><code>a8643e0e26d5ead82e73aae64966ca144f152d8a:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nr</code></li>
			<li class="dash"><code>4dc7c9ec434ed06502767136789763ec11d2c4b7:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r</code></li>
		</ul>
		<li class="dash"><pre class="wrap" style="padding:.5em;"><code>$(document).ready(function () {
	var o = {k: &quot;4692bd56dd3070f74b7e81c6b2f69339b0fd6062&quot;};
	var s = CryptoJS.enc.Latin1.stringify(
		CryptoJS.AES.decrypt(scrambledEggCipher, o.k)
	);
	// var png_magic_s = &quot;iVBORw0KGgoAAAANSUhEUgAAA&quot;;
	// s.startsWith(png_magic_s);
	// s.substring(0,26) === png_magic_s;
	document.getElementById(&quot;rotImg&quot;).src = &quot;data:image/png;base64,&quot;+s;
});</code></pre></li>
	</ul>

	<hr class="print-hidden">
	<li id="qn9" class="qn print-before"><u>Brain Game</u></li>
<pre class="wrap" style="padding:.5em;">
What about a little brain game?

<img src="img/braingame.png">

1. e4 e5 2. Nf3 Nc6 3. Bb5 Nf6 4. d3 Bc5 5. O-O d6 6. Nbd2 O-O 7. Bxc6 bxc6 8. h3 h6 9. Re1 Re8 10. Nf1 a5 11. Ng3 Rb8 12. b3 Bb4 13. Bd2 Ra8 14. c3 Bc5 15. d4 Bb6 16. dxe5 dxe5 17. c4 Nh7 18. Qe2 Nf8 19. Be3 c5 20. Rad1 Qf6 21. Nh5 Qe7 22. Nh2 Kh7 23. Qf3 f6 24. Ng4 Bxg4 25. Qxg4 Red8 26. Qf5+ Kh8 27. f4 Rxd1 28. Rxd1 exf4 29. Bxf4 Qe6 30. Rd3 Re8 31. Nxg7 Kxg7 32. Qh5 Nh7 33. Bxh6+ Kh8 34. Qg6 Qg8 35. Bg7+ Qxg7 36. Qxe8+ Qf8 37. Qe6 Qh6 38. e5 Qc1+ 39. Kh2 Qf4+ 40. Rg3 1-0
</pre>
	<ul>
		<li class="dash">each term in the string of the <span style="color:#fff;background-color:#f00;">white-on-red</span> part encodes a row of the state of the chessboard, from top to bottom</li>
		<li class="dash">`0` indicates absence of a piece in that particular grid cell, while `1` indicates presence</li>
		<li class="dash">interpret each row of `0`s and `1`s formed this way in binary, and convert it to decimal</li>
		<li class="dash">play out the given sequence of moves from the initial state, as given:</li>
		<li><img src="img/egg09-board.png"></li>
		<li class="dash">encode the final state of the chessboard similarly:</li>
		<table style="border-collapse:separate;border-spacing:3px;font-family:monospace;font-size:16px;">
			<tbody>
				<tr><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>1</td></tr>
				<tr><td>0</td><td>0</td><td>1</td><td>0</td><td>0</td><td>0</td><td>0</td><td>1</td></tr>
				<tr><td>0</td><td>1</td><td>0</td><td>0</td><td>1</td><td>1</td><td>0</td><td>0</td></tr>
				<tr><td>1</td><td>0</td><td>1</td><td>0</td><td>1</td><td>0</td><td>0</td><td>0</td></tr>
				<tr><td>0</td><td>0</td><td>1</td><td>0</td><td>0</td><td>1</td><td>0</td><td>0</td></tr>
				<tr><td>0</td><td>1</td><td>0</td><td>0</td><td>0</td><td>0</td><td>1</td><td>1</td></tr>
				<tr><td>1</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>1</td><td>1</td></tr>
				<tr><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td></tr>
			</tbody>
		</table>
		<li class="dash ans">1-33-76-168-36-67-131-0</li>
	</ul>
</ul>

	<hr class="print-hidden">
	<li id="qn10" class="qn print-before"><u>Blueprint</u></li>
<!-- @ http://dean.edwards.name/packer -->
<script type="text/javascript">
eval(function(p,a,c,k,e,r){e=function(c){return(c<a?'':e(parseInt(c/a)))+((c=c%a)>35?String.fromCharCode(c+29):c.toString(36))};if(!''.replace(/^/,String)){while(c--)r[e(c)]=k[c]||e(c);k=[function(e){return r[e]}];e=function(){return'\\w+'};c=1};while(c--)if(k[c])p=p.replace(new RegExp('\\b'+e(c)+'\\b','g'),k[c]);return p}('z C(){9 a=$("#q").s();9 b=6(a);9 y,e,f=0;9 c=$("#B")[0].D("o");c.g="#r";c.h(0,0,u*4,d*4);l(x=F;x>=0;x--){e=0;y=b;l(v=0;v<=p;v++){i(6.j(6.k(6.k(y,d),6.t(2,(d*x)+6.j(y,d))),2)>0.5){c.g="#w";c.h(f,e,3,3)}y=6.A(y,1);e+=4}f+=4}i(7.8(7.8(a))=="m"){E("7.8(7.8(a)) == \\"m\\"\\n\\n@ G"+7.8(a)+".H")}}',44,44,'||||||BigInteger|CryptoJS|SHA1|var||||17|yy|xx|fillStyle|fillRect|if|remainder|divide|for|c63733cf3c66f0311b5c029f2a981f0239d990ad||2d|16|value|0000dd|val|pow|106||ffffff|||function|add|canvas|plot|getContext|alert|105|challenge10_|html'.split('|'),0,{}))
</script>
<pre class="wrap" style="padding:.5em;">
Time for some math! Find the number which produces the plot on the bottom!
Try these two samples: <a onclick="$('#value').val('2228207');">sample 1</a>, <a onclick="$('#value').val('607016736537520995594815505941151025266085572371665528200038731931478673846727319684910259261305939019800769557502357959237333126657517770919783070679372916294368356299408372540498306857438421105135681283249346869449792967320249238095120706670142921097242873599571883821374208364354014530087192947246803225868116625497030891935667180689024971315282228337059319954976085961871005910163343474177499795224476259823484556802260391642987108868423291931973521858141803706752591127589236027411683906358835596869641180286211179357749072326208778420088');">sample 2</a>.<textarea id="value" style="width:100%;height:68px;" placeholder="number to plot">17657949201581490152887262552977461550821547861463862839240664323911642807489754168164179332567124887458095049966838272395838833335464853226293169893063985683542234868393982863605544853380459104965350326137397441646486218169598347856207906783361422905911386919743769975974237367400302886153547602709155224361686573545769765610544442950623858438305126210029328322211845690185546981876389418111008050801364588449772605640341039292322155464883254208546726202316901388360683605114288184962864450110296056848249404578342545423849729556480</textarea><button class="btn-dl" onClick="javascript:plot();">Plot!</button>
Your plot:<br/><canvas id="canvas" width="424" height="68" style="background:#0000dd;border-top:1px solid #0000dd;border-left:1px solid #0000dd;"></canvas>
Target plot:<br/><img class="no-border" src="img/plot.png" style="width:424px;height:68px;" />
</pre>
	<ul>
		<li class="dash"><pre class="wrap" style="padding:.5em;"><code>require &quot;chunky_png&quot;

img = ChunkyPNG::Image.from_file(&quot;<a href="img/plot.png">plot.png</a>&quot;)
lookup = Hash.new(0)
img.width.times do |x|
	img.height.times do |y|
		r = ChunkyPNG::Color.r(img.get_pixel(x,y))
		g = ChunkyPNG::Color.g(img.get_pixel(x,y))
		b = ChunkyPNG::Color.b(img.get_pixel(x,y))
		xx = (x/4)
		yy = (y/4)
		if r==255 and g==255 and b==255
			lookup[[xx, yy]] = [lookup[[xx, yy]].to_i, 1].max
		end
	end
end
bin = &quot;&quot;
106.times {|x| 17.times{|y| bin += lookup[[x,16-y]].to_s }}
p bin.to_i(2)*17</code></pre></li>
		<li class="dash ans" style="word-break:break-all;"><a href="//hackyeaster.hacking-lab.com/hackyeaster/challenge10_7fe2ea3751694cb6653d6bd3e7f39d089da29dc7.html">17657949201581490152887262552977461550821547861463862839240664323911642807489754168164179332567124887458095049966838272395838833335464853226293169893063985683542234868393982863605544853380459104965350326137397441646486218169598347856207906783361422905911386919743769975974237367400302886153547602709155224361686573545769765610544442950623858438305126210029328322211845690185546981876389418111008050801364588449772605640341039292322155464883254208546726202316901388360683605114288184962864450110296056848249404578342545423849729556480</a></li>
		<!--
			echo -n "17657949201581490152887262552977461550821547861463862839240664323911642807489754168164179332567124887458095049966838272395838833335464853226293169893063985683542234868393982863605544853380459104965350326137397441646486218169598347856207906783361422905911386919743769975974237367400302886153547602709155224361686573545769765610544442950623858438305126210029328322211845690185546981876389418111008050801364588449772605640341039292322155464883254208546726202316901388360683605114288184962864450110296056848249404578342545423849729556480" | sha1sum | cut -d' ' -f1
				=> 7fe2ea3751694cb6653d6bd3e7f39d089da29dc7
			echo -n "7fe2ea3751694cb6653d6bd3e7f39d089da29dc7" | xxd -p -r | sha1sum | cut -d' ' -f1
				=> c63733cf3c66f0311b5c029f2a981f0239d990ad
		-->
	</ul>

	<hr class="print-hidden">
	<li id="qn11" class="qn print-before"><u>Twisted Disc</u></li>
<pre class="wrap" style="padding:.5em;">
You found a secret disc which conceals a secret password. Can you crack it?

Hint: Each ring of the disc holds one letter. The first letter sits on the outermost ring.

<a href="file/disc.pdf"><button class="btn-dl">Download</button></a>
</pre>
	<ul>
		<li class="dash">letters that appear once only (i.e. unique) in each ring</li>
		<ul>
			<li class="ans">h</li>
			<li class="ans">a</li>
			<li class="ans">n</li>
			<li class="ans">i</li>
			<li>e, l, <font class="ans">s</font></li>
			<li class="ans">h</li>
			<li class="ans">o</li>
		</ul>
		<li class="dash ans">hanisho</li>
	</ul>

	<hr class="print-hidden">
	<li id="qn12" class="qn print-before"><u>Version Out Of Control</u></li>
<pre class="wrap" style="padding:.5em;">
Version control is a powerful tool. Thinking she was oh so smart, Fluffy used it to hide an easter egg. Can you pull out the egg from her file?

Hint: If you get stuck, go one step back.

<a href="file/1000.zip"><button class="btn-dl">Download her file</button></a>
</pre>
	<ul>
		<li class="dash"></li>
	</ul>

	<hr class="print-hidden">
	<li id="qn13" class="qn print-before"><u>Fractal Fumbling</u></li>
<pre class="wrap" style="padding:.5em;">
Do you need a new wallpaper? What about a fancy fractal?

Find the password hidden in the wallpaper image, and enter it in the Egg-O-Matic below.

<a href="img/wallpaper.jpg"><img src="img/wallpaper-thumb.jpg"></a>
</pre>
	<ul>
		<li class="dash"></li>
	</ul>

	<hr class="print-hidden">
	<li id="qn14" class="qn print-before"><u>P.A.L.M.</u></li>
<pre class="wrap" style="padding:.5em;">
Folks at <font style="font-variant:small-caps;">HOBO Authentication Systems</font> implemented a new authentication system named <nobr>P.A.L.M. &trade;</nobr>

Prove that you can break it and find a pair of username and passcode to log on.

<h3>P.A.L.M. Authentication &trade;</h3>
<input type="text" name="username" id="puser" value="">
<input type="number" name="password" id="ppass" value="">
<input type="button" onclick="javascript:checkEntries();" value="Login" class="btn-dl">
</pre>
	<ul>
		<li class="dash"><pre class="wrap" style="padding:.5em;word-break:break-all;"><code>function checkEntries() {
	var u = document.getElementById(&quot;puser&quot;).value;
	var p = document.getElementById(&quot;ppass&quot;).value;
	if (u === &quot;yolo&quot; &amp;amp;&amp;amp; p === &quot;1337&quot;) {
		document.location.href = &quot;challenge14_&quot; + u + &quot;_&quot; + p + &quot;.html&quot;;
	} else {
		alert(&quot;nope&quot;);
	}
}
var _0x549b = [&quot;value&quot;, &quot;puser&quot;, &quot;getElementById&quot;, &quot;ppass&quot;, &quot;rolo&quot;, &quot;length&quot;, &quot;charAt&quot;, &quot;href&quot;, &quot;location&quot;, &quot;challenge14_&quot;, &quot;_&quot;, &quot;.html&quot;, &quot;nope&quot;];
function checkEntries() {
	var u = document[_0x549b[2]](_0x549b[1])[_0x549b[0]];
	var p = document[_0x549b[2]](_0x549b[3])[_0x549b[0]];
	var ok = false;
	if (u === _0x549b[4]) {
		if (p &gt; 0 &amp;amp;&amp;amp; p[_0x549b[5]] == 10) {
			ok = true;
			for (i = 0; i &lt;= 9; i++) {
				var digit = p[_0x549b[6]](i);
				if (digit != 9 - i) {
					ok = false
				}
			}
		}
	};
	if (ok) {
		document[_0x549b[8]][_0x549b[7]] = _0x549b[9] + u + _0x549b[10] + p + _0x549b[11]
	} else {
		alert(_0x549b[12])
	}
};</code></pre></li>
		<li class="dash"><pre class="wrap" style="padding:.5em;word-break:break-all;"><code>eval(atob("ZXZhbChmdW5jdGlvbihwLGEsYyxrLGUsZCl7ZT1mdW5jdGlvbihjKXtyZXR1cm4gYy50b1N0cmluZygzNil9O2lmKCEnJy5yZXBsYWNlKC9eLyxTdHJpbmcpKXt3aGlsZShjLS0pe2RbYy50b1N0cmluZyhhKV09a1tjXXx8Yy50b1N0cmluZyhhKX1rPVtmdW5jdGlvbihlKXtyZXR1cm4gZFtlXX1dO2U9ZnVuY3Rpb24oKXtyZXR1cm4nXFx3Kyd9O2M9MX07d2hpbGUoYy0tKXtpZihrW2NdKXtwPXAucmVwbGFjZShuZXcgUmVnRXhwKCdcXGInK2UoYykrJ1xcYicsJ2cnKSxrW2NdKX19cmV0dXJuIHB9KCdyIHEoKXsyIHU9Ny44KFwnd1wnKS5iOzIgcD03LjgoXCd2XCcpLmI7MiA0PVswLDAsMCwwLDAsMCwwLDAsMCwwXTsyIDU9YzszKHU9PT1cJ2dcJyl7MyhwPjAmJnAuaD09OSl7NT1qO2YoaT0xO2k8PTk7aSsrKXsyIDY9cC5rKGktMSk7MiBhPXAuZSgwLGkpOzMoNFs2XSE9MHx8YSVpIT0wKXs1PWN9Myg0WzZdPT0wKXs0WzZdPTF9fX19Myg1KXs3Lm0ubj1cJ29cJyt1K1wneFwnK3ArXCcuc1wnfXR7ZChcJ2xcJyl9fScsMzQsMzQsJ3x8dmFyfGlmfHVzZWR8b2t8ZGlnaXR8ZG9jdW1lbnR8Z2V0RWxlbWVudEJ5SWR8MTB8cGFydHx2YWx1ZXxmYWxzZXxhbGVydHxzdWJzdHJpbmd8Zm9yfGVsc2F8bGVuZ3RofHx0cnVlfGNoYXJBdHxub3BlfGxvY2F0aW9ufGhyZWZ8Y2hhbGxlbmdlMTRffHxjaGVja0VudHJpZXN8ZnVuY3Rpb258aHRtbHxlbHNlfHxwcGFzc3xwdXNlcnxfJy5zcGxpdCgnfCcpLDAse30pKQ=="));</code></pre></li>
	</ul>

	<hr class="print-hidden">
	<li id="qn15" class="qn print-before"><u>Big Bad Wolf</u></li>
<pre class="wrap" style="padding:.5em;">
Three little pigs have hidden in their house. You're the big, bad wolf, and your stomach is growling. Huff and puff and blow the pigs' house in! Get that juicy bacon!

Hints:
‚Ä¢ the pigs have hidden in three different media types (image, sound, text)</li>
‚Ä¢ no password cracking is necessary

<a href="file/disk.img"><button class="btn-dl">Download the pigs' file</button></a>
</pre>
	<ul>
		<li class="dash"></li>
	</ul>

	<hr class="print-hidden">
	<li id="qn16" class="qn print-before"><u>Egg Coloring</u> (<a href="file/ps.hacking.hackyeaster.android.apk">mobile</a>)</li>
<pre class="wrap" style="padding:.5em;">
</pre>
	<ul>
		<li class="dash"></li>
	</ul>

	<hr class="print-hidden">
	<li id="qn17" class="qn print-before"><u>Bunny Hop</u></li>
<pre class="wrap" style="padding:.5em;">
Wannabe programming guru Hazel B. Easterwood created a new programming language called &quot;Bunny Hop&quot;. You suspect Hazel to have cheated, because the language looks very familiar to you.

Download the following code and complete it! It will yield the QR code for egg 17.

<a href="file/egg17.bunny"><button class="btn-dl">Download the code</button></a>
</pre>
	<ul>
		<li class="dash">1-1 mapping from <a href="//en.wikipedia.org/wiki/Logo_(programming_language)">Logo programming language</a>, replace:</li>
			<ul>
				<li>`hop` = `fd`</li>
				<li>`backhop` = `bk`</li>
			</ul>
		<li class="dash">missing subroutine: <code>egg</code></li>
<pre class="wrap" style="padding:.5em;"><code>to egg
	pd
	fd 1
	bk 1
	pu
end</code></pre>
		<li class="dash">online tool: <a href="//logo.twentygototen.org">//logo.twentygototen.org</a></li>
		<li><img src="img/egg17-qrcode.png"></li>
		<li class="dash">...in ASCII, becomes <u>egg17-qrcode.txt</u>:
<pre class="wrap" style="padding:.5em;"><code>xxxxxxx..x.....xx.xxxxxxx
x.....x.xx.xxxxxx.x.....x
x.xxx.x..xxx..xx..x.xxx.x
x.xxx.x.xx.x.xxx..x.xxx.x
x.xxx.x...x.xx.xx.x.xxx.x
x.....x.x.x..xxxx.x.....x
xxxxxxx.x.x.x.x.x.xxxxxxx
............x.xxx........
xxxxx.xxxxx.x.x..x.x.x.x.
.x.xxx...x...x.xx.xx.x...
.xx...x.xx.xx.xx..x....xx
xx.x.x.xxxxx..xx.xxx.x.xx
xxx...x.xx.x....xxxx..x..
x..x...x.xx.xx..xxxx.x.xx
x.x.x.x...x..xxxx.xxx.xxx
x..x...xx.x.xx.x.xxxx....
x...x.x.....x.x.xxxxxxxx.
........x.......x...xxx..
xxxxxxx.xx.xx...x.x.x.xxx
x.....x...xx..x.x...x...x
x.xxx.x.x.xx...xxxxxx.xxx
x.xxx.x.x...xxxxxxx.x..xx
x.xxx.x.x.x..xx....x.x..x
x.....x.xx..xx..x.xx....x
xxxxxxx.x...x.xx.x...x.xx</code></pre>
		<li class="dash"><pre class="wrap" style="padding:.5em;"><code>#!/usr/bin/env python
#-*- coding: utf-8 -*-

import sys
import codecs
from PIL import Image

sys.stdout = codecs.getwriter(&quot;utf8&quot;)(sys.stdout)
sys.stderr = codecs.getwriter(&quot;utf8&quot;)(sys.stderr)

if __name__ == &quot;__main__&quot;:
	w, h = 75, 75
	im = Image.new(&quot;RGBA&quot;, (w, h), &quot;white&quot;)
	pix = im.load()
	grid = []
	with codecs.open(&quot;egg17-qrcode.txt&quot;, &quot;r&quot;, &quot;utf-8&quot;) as f:
		for r, line in enumerate(f):
			line = line.strip()
			if not line: continue
			row = []
			for c, ch in enumerate(line):
				color = (0,0,0,255) if ch == &quot;x&quot; else (255,255,255,255)
				row.append(color)
			grid.append(row)
	for r in xrange(w):
		for c in xrange(h):
			pix[r,c] = grid[r/(w/25)][c/(h/25)]
	im.save(&quot;egg17-qrcode.png&quot;)</code></pre></li>
	</ul>

	<hr class="print-hidden">
	<li id="qn18" class="qn print-before"><u>Bug Hunter</u></li>
<pre class="wrap" style="padding:.5em;">
Lacking of time, you were not able not complete your DeggCryptor program. In an act of desperation, you instructed Sammy, the junior programmer, to implement the missing key generation function.

As always, Sammy miserably failed. Can you fix his code? It's the KeyGen class. Pay attention to the comments!

<a href="file/sourcecode.zip"><button class="btn-dl">Source Code</button></a>
</pre>
	<ul>
		<li class="dash"></li>
	</ul>

	<hr class="print-hidden">
	<li id="qn19" class="qn print-before"><u>Assemble This!</u></li>
<pre class="wrap" style="padding:.5em;">
In this challenge you must crack a server-side program. Lucky for you, you got the assembly file of the program. First, reverse-engineer the program and find a valid code! Then, submit the code to the server.

The server is located at:
<u>hackyeaster.hacking-lab.com:1234</u>

Important: Do not launch brute-force attacks on the server - you'll not be lucky with it!

<a href="file/assembly.txt"><button class="btn-dl">Download assembly file</button></a>
</pre>
	<ul>
		<li class="dash"></li>
	</ul>

	<hr class="print-hidden">
	<li id="qn20" class="qn print-before"><u>Humpty's Dump</u></li>
<pre class="wrap" style="padding:.5em;">
You got hold of a dump of Humpty Dumpty's secret egg database.

Search and extract the egg hidden in the dump!

<u>Hints</u>
‚Ä¢ The `puzz` is not more than 8 chars, letters only.
‚Ä¢ The decryption of the file can be done using AES_DECRYPT().

<a href="file/dump2.zip"><button class="btn-dl">Download the dump</button></a>
</pre>
	<ul>
		<li class="dash">`dump2.zip` contains:</li>
		<ul>
			<li class="default">humpty_fyle.sql</li>
			<li class="default">humpty_kee.sql</li>
			<li class="default">humpty_routines.sql</li>
			<li class="default">humpty_uzr.sql</li>
		</ul>
		<li class="dash"><code>docker run -p 3306:3306 --name mysql -e MYSQL_ROOT_PASSWORD=P@ssw0rd -d mysql:latest</code></li>
		<li><code>mysql&gt; CREATE DATABASE humpty;</code></li>
		<li><code>mysql&gt; SHOW TABLES;</code></li>
<pre class="wrap"><code>+------------------+
| Tables_in_humpty |
+------------------+
| fyle             |
| kee              |
| uzr              |
+------------------+</code></pre>
		<li><code>mysql&gt; DESCRIBE fyle;</code></li>
		<!-- mysql> SHOW CREATE TABLE fyle \G; -->
<pre class="wrap"><code>+-------+------------+------+-----+---------+-------+
| Field | Type       | Null | Key | Default | Extra |
+-------+------------+------+-----+---------+-------+
| id    | bigint(10) | NO   | PRI | NULL    |       |
| keeid | bigint(10) | NO   | MUL | NULL    |       |
| blahb | longblob   | YES  |     | NULL    |       |
+-------+------------+------+-----+---------+-------+</code></pre>
		<li><code>mysql&gt; SELECT id, keeid FROM fyle;</code></li>
<pre class="wrap"><code>+------+-------+
| id   | keeid |
+------+-------+
| 5182 |  1293 |
| 3475 |  1493 |
| 3492 |  2332 |
| 1374 |  4327 |
| 3481 |  7465 |
+------+-------+</code></pre>
		<li><code>mysql&gt; SELECT * FROM kee;</code></li>
<pre class="wrap"><code>+------+-------+------------------------------------------------------------------+
| id   | uzrid | kee                                                              |
+------+-------+------------------------------------------------------------------+
| 1293 |  1342 | 16B1917E3DC15E94D5956807F89874F0F90D2C778F1574F40E2DC75FA241CD15 |
| 1493 |  8944 | 8758597E209E6716877463D7605CB489DD0E62A61332CD022F5C07F5FD339A53 |
| 2332 |  3443 | 1ABF4B7CD25C61FDF0E74EC2BFB43BD1C2D8ECD803AFA3AA376F4C0000052813 |
| 4327 |  1875 | 4ED525F310E7A530D0BAA8FE3D54A5CF102D6AE8E9529289F664730FB248EF9A |
| 7465 |  5420 | A14EA5BDA9360D9E790B0935FFD21FA9B6BEBCDEAAFC8AADBD8A3A13643D5583 |
+------+-------+------------------------------------------------------------------+</code></pre>
		<li><code>mysql&gt; SELECT * FROM uzr;</code></li>
<pre class="wrap"><code>+------+--------+------------------------------------------+-------+
| id   | neighm | puzz                                     | sawlt |
+------+--------+------------------------------------------+-------+
| 1342 | stuart | de2278f5bcafcbb097ecc1fb54e5ab8a9e912c55 | efgh  |
| 1875 | beaver | 943f9ecbbd91306a561d0e3c15e18ee700007083 | abcd  |
| 3443 | chuck  | 0cf32f8f418659f23f8968d4f63ea5c98b39f833 | zyxw  |
| 5420 | yogo   | 1742ae4507fc480958e2437104e677e70aa5e857 | jklm  |
| 8944 | flint  | 915d253cb5ba6f0a220bca83e2d6d3258af15e68 | nmlk  |
+------+--------+------------------------------------------+-------+</code></pre>
		<li><code>mysql&gt; SELECT name FROM mysql.proc WHERE db=database() ORDER BY name;</code></li>
<pre class="wrap"><code>+-----------------+
| name            |
+-----------------+
| DeekryptKee     |
| GetPuzzMishMash |
| KryptKee        |
+-----------------+</code></pre>
		<li><code>mysql&gt; SHOW CREATE PROCEDURE DeekryptKee \G;</code></li>
<pre class="wrap"><code>PROCEDURE `DeekryptKee`(
    IN  p_puzz  VARCHAR(40),
    IN  p_cyfr  VARCHAR(64),
    OUT p_kee  VARCHAR(40)
)
BEGIN
    DECLARE p_tmp VARCHAR(64);
    DECLARE p_kountr INT;
    SET p_tmp := CONCAT(&#39;kee.&#39;, p_puzz, &#39;.kee&#39;);
    SET p_kountr := 1;
    WHILE p_kountr &lt;= 10000 DO
      SET p_tmp := SHA1(p_tmp);
      SET p_kountr := p_kountr + 1;
    END WHILE;
    SET p_tmp := AES_DECRYPT(UNHEX(p_cyfr), p_tmp);
    SELECT p_tmp INTO p_kee;
END</code></pre>
		<li><code>mysql&gt; SHOW CREATE PROCEDURE GetPuzzMishMash \G;</code></li>
<pre class="wrap"><code>PROCEDURE `GetPuzzMishMash`(
    IN  p_puzz      VARCHAR(40),
    IN  p_sawlt     VARCHAR(4),
    OUT p_mishmash  VARCHAR(40)
)
BEGIN
    DECLARE p_tmp VARCHAR(50);
    SET p_tmp := CONCAT(p_sawlt, &#39;.&#39;, p_puzz, &#39;.&#39;, p_sawlt);
    SELECT SHA1(p_tmp) INTO p_mishmash;
END</code></pre>
		<li><code>mysql&gt; SHOW CREATE PROCEDURE KryptKee \G;</code></li>
<pre class="wrap"><code>PROCEDURE `KryptKee`(
    IN  p_puzz  VARCHAR(40),
    IN  p_kee  VARCHAR(40),
    OUT p_cyfr   VARCHAR(64)
)
BEGIN
    DECLARE p_tmp VARCHAR(64);
    DECLARE p_kountr INT;
    SET p_tmp := CONCAT(&#39;kee.&#39;, p_puzz, &#39;.kee&#39;);
    SET p_kountr := 1;
    WHILE p_kountr &lt;= 10000 DO
      SET p_tmp := SHA1(p_tmp);
      SET p_kountr := p_kountr + 1;
    END WHILE;
    SET p_tmp := HEX(AES_ENCRYPT(p_kee, p_tmp));
    SELECT p_tmp INTO p_cyfr;
END</code></pre>
		<li class="dash"><code>cudaHashcat64.bin -m4900 -a3 hashfile.txt -1 ?l mask.txt</code></li>
		<li><u>hashfile.txt</u></li>
<pre class="wrap"><code>943f9ecbbd91306a561d0e3c15e18ee700007083:abcd
915d253cb5ba6f0a220bca83e2d6d3258af15e68:nmlk
1742ae4507fc480958e2437104e677e70aa5e857:jklm
0cf32f8f418659f23f8968d4f63ea5c98b39f833:zyxw (‚úì)
de2278f5bcafcbb097ecc1fb54e5ab8a9e912c55:efgh</code></pre>
		<li><u>mask.txt</u></li>
<pre class="wrap"><code>.?1?1?1?1?1?1?1?1.</code></pre>
		<li><code>mysql&gt; SELECT * FROM uzr WHERE id=3443;</code></li>
<pre class="wrap"><code>+------+--------+------------------------------------------+-------+
| id   | neighm | puzz                                     | sawlt |
+------+--------+------------------------------------------+-------+
| 3443 | chuck  | 0cf32f8f418659f23f8968d4f63ea5c98b39f833 | zyxw  |
+------+--------+------------------------------------------+-------+</code></pre>
		<li><code>SHA1(zyxw.snakeoil.zyxw) = 0cf32f8f418659f23f8968d4f63ea5c98b39f833</code></li>
		<li>...so <code>p_puzz = snakeoil</code></li>
		<li class="dash"><code>mysql&gt; SELECT * FROM kee WHERE uzrid=3443;</code></li>
<pre class="wrap"><code>+------+-------+------------------------------------------------------------------+
| id   | uzrid | kee                                                              |
+------+-------+------------------------------------------------------------------+
| 2332 |  3443 | 1ABF4B7CD25C61FDF0E74EC2BFB43BD1C2D8ECD803AFA3AA376F4C0000052813 |
+------+-------+------------------------------------------------------------------+</code></pre>
		<li><code>mysql&gt; SELECT id, keeid FROM fyle WHERE keeid=2332;</code></li>
<pre class="wrap"><code>+------+-------+
| id   | keeid |
+------+-------+
| 3492 |  2332 |
+------+-------+</code></pre>
		<li><pre class="wrap"><code>#!/usr/bin/env python
#-*- coding: utf-8 -*-

import sys
import pymysql
import pymysql.cursors

conn = pymysql.connect(
		host=&quot;localhost&quot;, port=3306,
		# unix_socket=&quot;/opt/local/var/run/mysql57/mysqld.sock&quot;,
		user=&quot;root&quot;,
		passwd=&quot;P@ssw0rd&quot;, password=&quot;P@ssw0rd&quot;,
		db=&quot;humpty&quot;,
		cursorclass=pymysql.cursors.DictCursor)

try:
	with conn.cursor() as cur:
		_id, uzrid = 2332, 3443
		sql = &quot;SELECT `kee` FROM `kee` WHERE `id`=%s AND `uzrid`=%s&quot;
		cur.execute(sql, (_id, uzrid,))
		kee = cur.fetchone()[&quot;kee&quot;]
 		# kee = 1ABF4B7CD25C61FDF0E74EC2BFB43BD1C2D8ECD803AFA3AA376F4C0000052813

 		# CALL DeekryptKee(&#39;snakeoil&#39;, &#39;1ABF4B7CD25C61FDF0E74EC2BFB43BD1C2D8ECD803AFA3AA376F4C0000052813&#39;, @p_kee); SELECT @p_kee;
 		sql = &quot;CALL DeekryptKee(%s, %s, @p_kee)&quot;
 		cur.execute(sql, (&quot;snakeoil&quot;, kee,))
 		sql = &quot;SELECT @p_kee&quot;
 		cur.execute(sql)
 		p_kee = cur.fetchone()[&quot;@p_kee&quot;]
		# p_kee = jpP8HeoEC5OCCBqdf9N3

		_id, keeid = 3492, 2332
		sql = &quot;SELECT AES_DECRYPT(`blahb`, %s) AS data FROM `fyle` WHERE `id`=%s and `keeid`=%s&quot;
		cur.execute(sql, (p_kee, _id, keeid,))
		fp = &quot;egg20.png&quot;
		with open(fp, &quot;wb&quot;) as f:
			f.write(cur.fetchone()[&quot;data&quot;])
		print&gt;&gt;sys.stderr, &quot;=&gt;&quot;, fp
finally: conn.close()</code></pre></li>
	</ul>

	<hr class="print-hidden">
	<li id="qn21" class="qn print-before"><u>Crypto Council</u></li>
<pre class="wrap" style="padding:.5em;">
Clever crypto brains had a little get-together. Find out who they are and break the riddles they created! Each plain text contains a password - once you've got them all, enter them in the Egg-O-Matic below. Lowercase only.

<img class="vmid no-border" src="img/head1.jpg" style="width:212px;height:270px">
DV D UXOH PHQ ZRUUB PRUH DERXW ZKDW WKHB FDQW VHH WKDQ DERXW ZKDW WKHB FDQ SDVVZRUG LV FDUWKDJR

<img class="vmid no-border" src="img/head2.jpg" style="width:212px;height:270px">
4423154215 2443 3334 52244433154343 4334 1442151114214531 3334 11131345431542 4334 4415424224123115 1143 442315 13343343132415331315 44231144 145215313143 2433 442315 2315114244 3421 1551154254 321133 3515313435343333154315 2443 442315 3511434352344214

<img class="vmid no-border" src="img/head3.jpg" style="width:212px;height:270px">
EHIIKT YFC FTEU QK PLTPWBY MQYTNVZW LAJ JGGN ZVLD A EWTAE WIEXLP QF IHV DAALROW DF JIACT GWMGCRQF WIJ NSIHVZ BTAE IJGAEOWS FFZ ZXM KW ZPVV I UAAJAARAC MVJCRBADN ZV HPRZA TAAZAW SE MQYTNVZW HTLLATD XZWTK RVV WESZWL UELWG AUZAPNLA LJREMTJS RVV YERV VDRRB SI TYM SVE FN SVE JMNTNKMWC HV MFIEIMV IHV LAELFUSIIT AWGVZKW PNU ZWBAZVWS TYMJT FFZ LWIIBQ NERZK UIMM QTAIA ACTF PAH CRZWTR YM SRCFUHPNZMV IHV NJTNTP WCVFG DDUZA SSHVUSG DV OJXGEIF IO KPW SIVB GU WFZEH AJ I BJNZWJ HETZWIAIG ZT EEBWGEU BZT SVZNXCV WX IHV LMZE FN FTVVZK PS YQK HETZWIAIG S EOJQLXOE PW WECL MCTZT LWE UMSIHJ WX IHV LMZE RVV WIJ AGC HV IDHO JMJKEU IK P SVKJTTRZQ IO YMFGY ZQA

<img class="vmid no-border" src="img/head4.jpg" style="width:212px;height:270px">
WEN XQWVIBQZ KGQEAL TWB WEH GKQCW QLTBAKBTU LKIQTME DWCOAKWZAKNB BKMETP WEW NOTHPA HWB GBXHCEWG IA OTTQPWD SEATWCWNBA NZW HTO BHQWG HIWAL MCMG LQWVIBQL TOF QLFVCHWG WEW XNW FM WET NGQEAL QWBDSCMF KO CPWCKWMAX
</pre>
	<ul>
		<li class="dash"><a href="//www.xarg.org/tools/caesar-cipher">Caesar Cipher</a>, key=23</li>
			<ul><li class="dash">as a rule men worry more about what they cant see than about what they can password is <font class="ans">carthago</font></li></ul>
		<li class="dash"><a href="//www.braingle.com/brainteasers/codes/polybius.php">Polybius Square</a></li>
			<ul><li class="dash">there is no witness so dreadful no accuser so terrible as the conscience that dwells in the heart of every man <font class="ans">peloponnese</font> is the password</li></ul>
		<li class="dash"><a href="//www.dcode.fr/vigenere-cipher">Vigen√®re Cipher</a>, key=paris</li>
			<ul><li class="dash">phrase you need is <font class="ans">alchemy</font> vigenere was born into a noble family in the village of saint pourcain his father jean arranged for him to have a classical education in paris blaise de vigenere studied greek and hebrew under adrianus turnebus and jean dorat at the age of age seventeen he entered the diplomatic service and remained there for thirty years five years into his career he accompanied the french envoy louis adhemar de grignan to the diet of worms as a junior secretary he entered the service of the duke of nevers as his secretary a position he held until the deaths of the duke and his son he also served as a secretary to henry iii</li></ul>
		<li class="dash"><a href="//bionsgadgets.appspot.com/ww_forms/playfair_ph_web_worker3.html">Playfair cipher</a>, key=ZUVXYTWHEACSONBKDFGIRLMPQ</li>
			<ul><li class="dash">the playfair cipher was the first practical digraph substitution cipher the scheme was invented by charles wheatstone but was named after lord playfair who promoted the use of the cipher password is <font class="ans">bletchley</font></li></ul>
	</ul>

	<hr class="print-hidden">
	<li id="qn22" class="qn print-before"><u>Dumpster Diving</u></li>
<pre class="wrap" style="padding:.5em;">
You've sniffed some password hashes of a web site:
	hash 1: fad202a6e094dd8f1d63da8bdf85b3ba099971d3
	hash 2: f71e1b0b9b3a57d864c2e9f7bd6dd90f66b5a7d6
	hash 3: 84c6bcb681b79b690b53f9f3a8ba24e1e970d348
	hash 4: 0d6bb0df8918168798ce6b770014aeb81ac6ce76

However, none of your tools succeeded in cracking the hashes. As a last resort, you inspected the dumpster of the software development company which created the web site. And indeed you found something: a paper with a part of the hash calculation code.

Can you crack the hashes now?

<img src="img/paper.png">
</pre>
	<ul>
		<li class="dash">standard SHA1 implementation, init with different const, i.e.</li>
		<ul>
			<li><code>h0 = <strike>0x67452301</strike> 0x10325476</code></li>
			<li><code>h1 = <strike>0xEFCDAB89</strike> 0x98BADCFE</code></li>
			<li><code>h2 = <strike>0x98BADCFE</strike> 0xEFCDAB89</code></li>
			<li><code>h3 = <strike>0x10325476</strike> 0x67452301</code></li>
			<li><code>h4 = <strike>0xC3D2E1F0</strike> 0x0F1E2D3C</code></li>
		</ul>
		<li class="dash"> @ <a href="//codereview.stackexchange.com/questions/37648/python-implementation-of-sha1">//codereview.stackexchange.com/questions/37648/python-implementation-of-sha1</a></li>
<pre class="wrap"><code>#!/usr/bin/env python
#-*- coding: utf-8 -*-

def sha1(data):
	bytes = &quot;&quot;

	h0 = 0x10325476
	h1 = 0x98BADCFE
	h2 = 0xEFCDAB89
	h3 = 0x67452301
	h4 = 0x0F1E2D3C

	for n in xrange(len(data)):
		bytes+=&quot;{0:08b}&quot;.format(ord(data[n]))
	bits = bytes+&quot;1&quot;
	pBits = bits
	while len(pBits)%512 != 448: pBits+=&quot;0&quot;
	pBits+=&quot;{0:064b}&quot;.format(len(bits)-1)
	def chunks(l, n):
		return [l[i:i+n] for i in xrange(0, len(l), n)]
	def rot_l(n, b):
		return ((n &lt;&lt; b) | (n &gt;&gt; (32 - b))) &amp; 0xffffffff
	for c in chunks(pBits, 512):
		words = chunks(c, 32)
		w = [0]*80
		for n in xrange(16):
			w[n] = int(words[n], 2)
		for i in xrange(16, 80):
			w[i] = rot_l((w[i-3] ^ w[i-8] ^ w[i-14] ^ w[i-16]), 1)
		a = h0
		b = h1
		c = h2
		d = h3
		e = h4
		for i in xrange(80):
			if 0 &lt;= i &lt;= 19:
				f = (b &amp; c) | ((~b) &amp; d)
				k = 0x5A827999
			elif 20 &lt;= i &lt;= 39:
				f = b ^ c ^ d
				k = 0x6ED9EBA1
			elif 40 &lt;= i &lt;= 59:
				f = (b &amp; c) | (b &amp; d) | (c &amp; d)
				k = 0x8F1BBCDC
			elif 60 &lt;= i &lt;= 79:
				f = b ^ c ^ d
				k = 0xCA62C1D6
			tmp = rot_l(a, 5) + f + e + k + w[i] &amp; 0xffffffff
			e = d
			d = c
			c = rot_l(b, 30)
			b = a
			a = tmp
		h0 = (h0+a) &amp; 0xffffffff
		h1 = (h1+b) &amp; 0xffffffff
		h2 = (h2+c) &amp; 0xffffffff
		h3 = (h3+d) &amp; 0xffffffff
		h4 = (h4+e) &amp; 0xffffffff
	return &quot;%08x%08x%08x%08x%08x&quot; %(h0,h1,h2,h3,h4)</code></pre>
		<li class="dash">bruteforce using this:</li>
		<ul>
			<li>fad202a6e094dd8f1d63da8bdf85b3ba099971d3: <font class="ans">zombie</font></li>
			<li>f71e1b0b9b3a57d864c2e9f7bd6dd90f66b5a7d6: <font class="ans">Denver1</font></li>
			<li>84c6bcb681b79b690b53f9f3a8ba24e1e970d348: <font class="ans">Placebo</font></li>
			<li>0d6bb0df8918168798ce6b770014aeb81ac6ce76: <font class="ans">SHADOWLAND</font></li>
		</ul>
	</ul>

	<hr class="print-hidden">
	<li id="qn23" class="qn print-before"><u>Heizohack</u></li>
<pre class="wrap" style="padding:.5em;">
Can you crack the Heizohack?

The password for the Egg-O-Matic is hidden in the image.

<img src="img/heizohack.bmp">
</pre>
	<ul>
		<li class="dash">LSB steganography</li>
<pre class="wrap"><code>#!/usr/bin/env python
#-*- coding: utf-8 -*-

import sys
from PIL import Image

bin_n = lambda x, n: format(x, &quot;b&quot;).zfill(n)

img = Image.open(&quot;<a href="img/heizohack.bmp">heizohack.bmp</a>&quot;)
pix = img.convert(&quot;RGBA&quot;).load()
w, h = img.size

pw, lsb = [], 7
for y in xrange(h):
	for x in xrange(w):
		r = bin_n(pix[x,y][0], 8)
		g = bin_n(pix[x,y][1], 8)
		b = bin_n(pix[x,y][2], 8)
		b = bin_n(pix[x,y][2], 8)
		pw.append(r[lsb])
		pw.append(g[lsb])
		pw.append(b[lsb])
mac = &quot;&quot;.join(pw)
print &quot;&quot;.join(chr(int(mac[i:i+8],2)) for i in xrange(0,len(mac),8))</code></pre>
		<li class="dash">produces:</li>
		<li><img src="img/egg23-heizohack-hidden.png"></li>
		<li class="dash">follow as instructed:</li>
<pre class="wrap"><code>#!/usr/bin/env python
#-*- coding: utf-8 -*-

import sys
from PIL import Image

bin_n = lambda x, n: format(x, &quot;b&quot;).zfill(n)

img = Image.open(&quot;<a href="img/egg23-heizohack-hidden.png">heizohack.png</a>&quot;)
pix = img.convert(&quot;RGBA&quot;).load()
w, h = img.size

pw, lsb = [], 7
for y in xrange(h):
	for x in xrange(w):
		r = bin_n(pix[x,y][0], 8)
		g = bin_n(pix[x,y][1], 8)
		b = bin_n(pix[x,y][2], 8)
		a = bin_n(pix[x,y][3], 8)
		if int(r[lsb]) ^ int(g[lsb]) ^ int(b[lsb]) ^ int(a[lsb]) == 1:
			pw.append(r[lsb])
mac = &quot;&quot;.join(pw)
print &quot;&quot;.join(chr(int(mac[i:i+8],2)) for i in xrange(0,len(mac),8))</code></pre>
		<li class="dash ans">lostinthewoooods</li>
	</ul>

	<hr class="print-hidden">
	<li id="qn24" class="qn print-before"><u>crunch.ly</u></li>
<pre class="wrap" style="padding:.5em;">
Do you know <i>crunch.ly</i>, the fancy new URL shortener? It was used to create a short URL for Hacky Easter. In order to lure people onto the web site of your alternative hacking competition "Evil Easter", you decide to attack this service.

What you know
‚Ä¢ Short URL for Hacky Easter: <u>http://crunch.ly/IU66SMI</u>
‚Ä¢ Web site of crunch.ly (not a real domain!): <a href="file/crunchly/crunchly.html">OPEN WEB SITE</a>
‚Ä¢ Algorithms used on the web site: <a href="file/crunchly.txt">DOWNLOAD</a>

Your mission
1. find a URL <u>starting with http://evileaster.com</u>, which produces the same short URL
2. make the web site store your URL, instead of the original URL
3. open the short URL on the web site
4. do not bomb or DoS the server - you'll have no luck with it; cracking must happen offline
</pre>
	<ol>
		<li class="dash">possible URLs (pick any one):</li>
		<ul>
			<li><a href="http://evileaster.comaicqrnq">http://evileaster.comaicqrnq</a></li>
			<li><a href="http://evileaster.com/elL12H">http://evileaster.com/elL12H</a></li>
			<li><a href="http://evileaster.com/fUmtEX">http://evileaster.com/fUmtEX</a></li>
			<li><a href="http://evileaster.com/jhSuHe">http://evileaster.com/jhSuHe</a></li>
			<li><a href="http://evileaster.com/jKb8ih">http://evileaster.com/jKb8ih</a></li>
			<li><a href="http://evileaster.com/kUIg0v">http://evileaster.com/kUIg0v</a></li>
			<li><a href="http://evileaster.com/lYaPB3">http://evileaster.com/lYaPB3</a></li>
			<li><a href="http://evileaster.com/nAZ0N7">http://evileaster.com/nAZ0N7</a></li>
			<li><a href="http://evileaster.com/obH8dK">http://evileaster.com/obH8dK</a></li>
			<li><a href="http://evileaster.com/oLamSw">http://evileaster.com/oLamSw</a></li>
			<li><a href="http://evileaster.com/sSDFrt">http://evileaster.com/sSDFrt</a></li>
			<li><a href="http://evileaster.com/uYXR9o">http://evileaster.com/uYXR9o</a></li>
		</ul>
<pre class="wrap" style="padding:.5em;"><code>import java.io.*;
import java.lang.*;
import java.net.*;
import java.security.*;

import javax.crypto.*;
import javax.crypto.spec.*;

// @ <a href="//commons.apache.org/proper/commons-codec/download_codec.cgi">//commons.apache.org/proper/commons-codec/download_codec.cgi</a>
import org.apache.commons.codec.binary.*;

public class Crunchly {
	public void run() {
		bruteForceShortUrl(&quot;&quot;, 6, &quot;IU66SMI&quot;);
	}

	public static void main(String[] args) throws Exception {
		new Crunchly().run();
	}

	public void bruteForceShortUrl(String str, int maxlen, String match) {
		String charset = &quot;abcdefghijklmnopqrstuvwxyz&quot;+&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;+&quot;0123456789&quot;;//+&quot;/&quot;;
		if (str.length() &gt;= maxlen) {
			// base case
			String strUrl = &quot;http://evileaster.com/&quot;+str;
			String shortUrl = calculateShortUrl(strUrl);
			String matchUrl = &quot;http://crunch.ly/&quot;+match;
			if (shortUrl.equals(matchUrl)) {
				System.out.println(&quot;[done]: &quot;+strUrl);
				System.exit(0);
			}
			return;
		}

		// recursive case
		for (int i=0; i&lt;charset.length(); i++) {
			bruteForceShortUrl(str+charset.charAt(i), maxlen, match);
		}
	}

	// given code //
	private String calculateShortUrl(String url) {
		try {
			MessageDigest md = MessageDigest.getInstance(&quot;SHA-256&quot;);
			md.update(url.getBytes(&quot;UTF-8&quot;));
			byte[] hash = md.digest();
			byte[] part = new byte[4];
			System.arraycopy(hash, 0, part, 0, 4);
			String b32 = new String(new Base32().encode(part), &quot;UTF-8&quot;);
			b32 = b32.replaceAll(&quot;=&quot;, &quot;&quot;);
			return &quot;http://crunch.ly/&quot; + b32;
		} catch (Exception e) {
			e.printStackTrace();
		}
		return null;
	}
}</code></pre>
	</ol>
	<ul>
		<li class="dash">key: tKguF</li>
<pre class="wrap" style="padding:.5em;"><code>import java.io.*;
import java.lang.*;
import java.net.*;
import java.security.*;

import javax.crypto.*;
import javax.crypto.spec.*;

// @ <a href="//commons.apache.org/proper/commons-codec/download_codec.cgi">//commons.apache.org/proper/commons-codec/download_codec.cgi</a>
import org.apache.commons.codec.binary.*;

public class Crunchly {
	public void run() {
		// String keyFull = &quot;x&quot;+key+key+key; //128-bit
		// 128 bits = 16 bytes
		// "x" + key*3 = 16 chars
		// => key = 5 chars
		bruteForceKey(&quot;&quot;, 5);
	}

	public static void main(String[] args) throws Exception {
		new Crunchly().run();
	}

	public void bruteForceKey(String str, int maxlen) {
		String charset = &quot;abcdefghijklmnopqrstuvwxyz&quot;+&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;;
		if (str.length() &gt;= maxlen) {
			// base case: known testcase //
			String url = &quot;http://.&quot;;
			String shortUrl = &quot;http://crunch.ly/FN2ERFA&quot;;
			String tixActual = cryptTicket(url, shortUrl, str);
			String tixExpected = &quot;CNgdmr+C40sYmW2e07VycSsEbwDEteBwV5Da6/ERCySirkDHktUMZ7Ky+utNUkAk&quot;;
			if (tixActual.equals(tixExpected)) {
				System.out.println(&quot;[done]: &quot;+str);
				System.exit(0);
			}
			return;
		}

		// recursive case
		for (int i=0; i&lt;charset.length(); i++) {
			bruteForceKey(str+charset.charAt(i), maxlen);
		}
	}

	// given code //
	private static final String IV = &quot;hackyeasterisfun&quot;;
	private String cryptTicket(String url, String shortUrl, String key) {
		String keyFull = &quot;x&quot;+key+key+key; //128-bit
		try {
			Cipher cipher = Cipher.getInstance(&quot;AES/CBC/PKCS5Padding&quot;);
			SecretKeySpec keySpec = new SecretKeySpec(keyFull.getBytes(&quot;UTF-8&quot;), &quot;AES&quot;);
			cipher.init(Cipher.ENCRYPT_MODE, keySpec, new IvParameterSpec(IV.getBytes(&quot;UTF-8&quot;)));
			String plain = new String(Base64.encodeBase64(url.getBytes(&quot;UTF-8&quot;)), &quot;UTF-8&quot;);
			plain += &quot;@&quot; + new String(Base64.encodeBase64(shortUrl.getBytes(&quot;UTF-8&quot;)), &quot;UTF-8&quot;);
			byte[] crypted = cipher.doFinal(plain.getBytes(&quot;UTF-8&quot;));
			return Base64.encodeBase64String(crypted);
		} catch (Exception e) {
			e.printStackTrace();
		}
		return null;
	}
}</code></pre>
		<li class="dash"><code>curl -c cookies.txt -sL &quot;http://hackyeaster.hacking-lab.com/hackyeaster/crunch?service=save&amp;ticket=Hgo3UsPWbH%2B4kkfQwZ0dOAbQzQy7HXmhCcwLzE4m%2F06I3E5d4Zl2LJ7hLXVuOe6USoykVYjijBkc8Rv%2FtMXnJHkU66WiET3AEwka8zz%2BV%2Fs%3D&quot; &amp;&amp; curl -b cookies.txt -sL &quot;http://hackyeaster.hacking-lab.com/hackyeaster/crunch?service=go&amp;shorturl=http%3A%2F%2Fcrunch.ly%2FIU66SMI&quot;</code></li>
<pre class="wrap" style="padding:.5em;"><code>import java.io.*;
import java.lang.*;
import java.net.*;
import java.security.*;

import javax.crypto.*;
import javax.crypto.spec.*;

// @ <a href="//commons.apache.org/proper/commons-codec/download_codec.cgi">//commons.apache.org/proper/commons-codec/download_codec.cgi</a>
import org.apache.commons.codec.binary.*;

public class Crunchly {
	public void run() {
		String url = &quot;http://evileaster.com/elL12H&quot;;
		String shortUrl = &quot;http://crunch.ly/IU66SMI&quot;;

		String key = &quot;tKguF&quot;;

		String tix = cryptTicket(url, shortUrl, key);
		// Hgo3UsPWbH+4kkfQwZ0dOAbQzQy7HXmhCcwLzE4m/06I3E5d4Zl2LJ7hLXVuOe6USoykVYjijBkc8Rv/tMXnJHkU66WiET3AEwka8zz+V/s=

		String svcUrl = &quot;http://hackyeaster.hacking-lab.com/hackyeaster/crunch&quot;;
		// service=check: url=&lt;shortUrl&gt;
		// service=go: shorturl=&lt;shortUrl&gt;
		// service=save: ticket=&lt;tix&gt;

		try {
			String charset = java.nio.charset.StandardCharsets.UTF_8.name();

			String q = String.format(&quot;service=%s&amp;ticket=%s&quot;,
				URLEncoder.encode(&quot;save&quot;, charset),
				URLEncoder.encode(tix, charset));
			URLConnection conn = new URL(svcUrl+&quot;?&quot;+q).openConnection();
			conn.setRequestProperty(&quot;Accept-Charset&quot;, charset);

			String hdr = null;
			String cookie = null;
			for (int i=1; (hdr=conn.getHeaderFieldKey(i))!=null; i++) {
				if (hdr.equals(&quot;Set-Cookie&quot;)) {
					if (cookie == null) {
						cookie = conn.getHeaderField(i);
						cookie = cookie.substring(0, cookie.indexOf(&quot;;&quot;));
					}
				}
			}

			q = String.format(&quot;service=%s&amp;shorturl=%s&quot;,
				URLEncoder.encode(&quot;go&quot;, charset),
				URLEncoder.encode(shortUrl, charset));
			conn = new URL(svcUrl+&quot;?&quot;+q).openConnection();
			conn.setRequestProperty(&quot;Accept-Charset&quot;, charset);
			conn.setRequestProperty(&quot;Cookie&quot;, cookie);

			InputStream resp = conn.getInputStream();
			try (BufferedReader rdr = new BufferedReader(
				new InputStreamReader(resp, charset)
			)) {
				for (String line; (line=rdr.readLine())!=null;) {
					System.err.println(URLDecoder.decode(line, charset));
				}
			}
		} catch (IOException ex) {}
	}

	public static void main(String[] args) throws Exception {
		new Crunchly().run();
	}

	// given code //
	private static final String IV = &quot;hackyeasterisfun&quot;;
	private String cryptTicket(String url, String shortUrl, String key) {
		String keyFull = &quot;x&quot;+key+key+key; //128-bit
		try {
			Cipher cipher = Cipher.getInstance(&quot;AES/CBC/PKCS5Padding&quot;);
			SecretKeySpec keySpec = new SecretKeySpec(keyFull.getBytes(&quot;UTF-8&quot;), &quot;AES&quot;);
			cipher.init(Cipher.ENCRYPT_MODE, keySpec, new IvParameterSpec(IV.getBytes(&quot;UTF-8&quot;)));
			String plain = new String(Base64.encodeBase64(url.getBytes(&quot;UTF-8&quot;)), &quot;UTF-8&quot;);
			plain += &quot;@&quot; + new String(Base64.encodeBase64(shortUrl.getBytes(&quot;UTF-8&quot;)), &quot;UTF-8&quot;);
			byte[] crypted = cipher.doFinal(plain.getBytes(&quot;UTF-8&quot;));
			return Base64.encodeBase64String(crypted);
		} catch (Exception e) {
			e.printStackTrace();
		}
		return null;
	}
}</code></pre>
		<li class="ans">@ <a href="//hackyeaster.hacking-lab.com/hackyeaster/images/egg24_bHIrQh1VR141TPmapETM.png">//hackyeaster.hacking-lab.com/hackyeaster/images/egg24_bHIrQh1VR141TPmapETM.png</a></li>
	</ul>
</ul>

<br clear="both">
<div class="print-before"><img src="2016HE.png"></div>

<style type="text/css">
	#eggs {line-height:1.75em;font-size:13pt;}
	#eggs .eggImage{margin:-15px -30px;width:240px;height:240px;background-size:240px 240px;display:inline-block;}
	#eggs .easyEgg{background-image:url("img/egg_easy.png");}
	#eggs .mediumEgg{background-image:url("img/egg_medium.png");}
	#eggs .hardEgg{background-image:url("img/egg_hard.png");}
	#eggs .eggTitle,#eggs .eggQR{text-align:center;position:relative;width:100%;display:inline-block;}
	#eggs .eggTitle{top:50px;font-family:"Source Sans Pro";font-size:3.5em;font-weight:bold;color:#000;}
	#eggs .eggQR{top:64px;}
</style>
<div id="eggs" class="print-before" style="border:1px dashed #000;"></div>

<center class="print-hidden">--- <strong>FIN</strong> ---</center>
</div></div></div>
<script type="text/javascript" src="/js/jquery-1.12.4.min.js"></script>
<script type="text/javascript" src="/js/jquery.qrcode.min.js"></script>
<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.4.0/highlight.min.js"></script>
<script type="text/javascript">hljs.initHighlightingOnLoad();</script>
<script type="text/javascript" src="//vjs.zencdn.net/5.9.2/video.js"></script>
<script type="text/javascript" src="/js/sha1.js"></script>
<script type="text/javascript" src="/js/core-min.js"></script>
<script type="text/javascript" src="/js/enc-base64-min.js"></script>
<script type="text/javascript" src="js/biginteger.js"></script>
<script type="text/javascript">
	$(function () {
		"use strict";

		var qr_codes = [null, "1fQArOSgpdSCBr8zXove", "P2kVqrkD2ykiNcwWAAKv", "FUYEMZoOCLis7tPvs5pq", "dLYFunszMowTRHovQx2y", "X8pfJTkxJeRX0bMHZsTP", "mGMzyuWnqVnC014Irq5S", "3OgwkgZmzaFUvPBwnKr8", "B6gZYdONrcSnRlDlvQ03", "vgOObZR6VjxuwRkBVm2F", "QOXm6kvOYt3ATkc9rDnk", "wjlKxyRNWcLnyhdXhHCV", "kR4ZCgRneYR27YAYr8eE", "Jvl8olPUI9yfuJDWIJFi", "Qa5miycTGMkfXUe1iOeJ", "JMv1xX8LZGM0VspECD1b", "7dUDQDhMQkLYsQTMJq62", "nYa3ktAoTAQc6yxMAGoM", "83OHadUPAeWRfd6YBv6t", "WCeZB8yUTdgjayQol2KS", "PRKuX3CklkoZWwfOHbpK", "cH3zySmRf29wCQpE7FSK", "Jbpfr31iCjbpThSfHk6i", "mwBDDBrer7qemsD7RDSf", "avHJJ56JeUvZ8fr7wkGB"];
		for (var i=1; i<qr_codes.length; i++) {
			var lvl = (i<10)?("0"+i):i;
			var elem = $("<span>");
			var diff = null;
			if (1<=i && i<=9) {
				diff = "easy";
			} else if (10<=i && i<=18) {
				diff = "medium";
			} else {
				diff = "hard";
			}
			$(elem).attr("class", "eggImage "+diff+"Egg");
			$(elem).append("<span class='eggTitle'>"+lvl+"</span>");
			$(elem).append("<span id='egg-lvl"+lvl+"' class='eggQR'></span>");
			$("#eggs").append(elem);
			$("#eggs #egg-lvl"+lvl).qrcode({
				size: 75,
				left: 0, top: 0, fill: "#000",
				text: qr_codes[i],
				label: qr_codes[i]
			});
		}
	});
</script>
</body></html>
