<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>20160501: Hacky Easter 2016 - writeup</title>
	<link rel="stylesheet" type="text/css" href="/css/all.min.css">
	<link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Ubuntu+Mono:400">
	<link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Open+Sans">
	<link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.4.0/styles/default.min.css">
	<link rel="stylesheet" type="text/css" href="//vjs.zencdn.net/5.9.2/video-js.css">
	<script type="text/javascript" src="//vjs.zencdn.net/ie8/1.1.2/videojs-ie8.min.js"></script>
	<style type="text/css">
		/* video.js */
		.vjs-menu-button-popup .vjs-menu ul.vjs-menu-content {
			margin: 0 !important;
		}
		/* */
		.btn-dl {
			font-size: 1.1em;
			padding: 0.65em 1.5em 0.65em 1.5em;
			line-height: 1.75em;
			-webkit-appearance: none;
			display: inline-block;
			text-decoration: none;
			cursor: pointer;
			border: 0;
			border-radius: 5px;
			background: #4923a0;
			color: #fff;
			font-weight: 700;
			outline: 0;
			-moz-transition: background-color .25s ease-in-out;
			-webkit-transition: background-color .25s ease-in-out;
			-o-transition: background-color .25s ease-in-out;
			-ms-transition: background-color .25s ease-in-out;
			transition: background-color .25s ease-in-out;
		}
		@media print {
			.wrap-print {
				white-space: pre-wrap;
				word-break: break-all;
			}
		}
	</style>
</head>
<body>
	<div id="content">
		<div id="post">
		<h1><a href="http://www.timeanddate.com/worldclock/fixedtime.html?iso=20160430T1600">20160501</a>: <a href="http://hackyeaster.hacking-lab.com/hackyeaster/challenges.html">Hacky Easter 2016</a> - writeup</h1>
		<div id="postinfo">
			<div id="postdate"></div>
			<div id="posttags">tags: netsec, ctf, hacking-lab, hacky, easter, 2016, he2016</div>
		</div>
		<div id="postbody">
<center>
	<i><a class="print-link" href="http://zxing.org/w/decode.jspx">QR code decoder</a><br>all keys in lowercase only</i>
</center>
<ol>
	<li id="qn0" class="qn print-hidden" value="0">
		<a href="index-teaser.html"><u><font color="red">Teaser Challenge</font></u></a>
	</li>

	<li id="qn1" class="qn"><u>Easy One</u></li>
<pre class="wrap" style="padding:0 .5em;">
As always, the first challenge is very easy. Even babies can solve this one!

Find the code and enter it in the Egg-O-Matic™ below! One word, all lowercase.

xt   hex   yhi   dde   nyy   str
in   gyy   isy   ymo   lly   cod
dl   exy   sox   xsi   mpl   ey🚼
</pre>
	<ul>
		<li class="dash">remove whitespace =&gt; x<font class="ans">the</font>xy<font class="ans">hidden</font>yy<font class="ans">string</font>yy<font class="ans">is</font>yy<code class="ans">mollycoddle</code>xy<font class="ans">so</font>xx<font class="ans">simple</font>y</li>
	</ul>

	<hr class="print-hidden">
	<li id="qn2" class="qn print-before"><u>Just Cruisin'</u></li>
<pre class="wrap" style="padding:0 .5em;">
Need a holiday? Book a cruise on our new flag ship!

Seek out the promotion code below (lowercase only, no spaces) and get a free welcome package!
</pre>
<style type="text/css">
	img.shipflag {
		width: 72px;
		height: 72px;
		margin: 16px;
		border: 1px solid #000;
	}
</style>
<img class="shipflag" src="img/flag01.svg"><img class="shipflag" src="img/flag02.svg"><img class="shipflag" src="img/flag03.svg"><img class="shipflag" src="img/flag04.svg"><img class="shipflag" src="img/flag05.svg"><br><img class="shipflag" src="img/flag06.svg"><img class="shipflag" src="img/flag07.svg"><img class="shipflag" src="img/flag08.svg"><img class="shipflag" src="img/flag09.svg"><img class="shipflag" src="img/flag10.svg"><br><img class="shipflag" src="img/flag11.svg"><img class="shipflag" src="img/flag01.svg"><img class="shipflag" src="img/flag12.svg"><img class="shipflag" src="img/flag13.svg"><img class="shipflag" src="img/flag12.svg"><br><img class="shipflag" src="img/flag01.svg"><img class="shipflag" src="img/flag08.svg"><img class="shipflag" src="img/flag14.svg"><img class="shipflag" src="img/flag10.svg"><img class="shipflag" src="img/flag15.svg"><br><img class="shipflag" src="img/flag01.svg"><img class="shipflag" src="img/flag01.svg"><img class="shipflag" src="img/flag16.svg"><img class="shipflag" src="img/flag17.svg"><img class="shipflag" src="img/flag01.svg">
	<ul>
		<li class="dash none">@ <a href="//en.wikipedia.org/wiki/International_maritime_signal_flags">//en.wikipedia.org/wiki/International_maritime_signal_flags</a></li>
		<li class="dash">download <code>&lt;img&gt;</code> URLs (list via Chrome DevTools console): <code>console.log.apply(console, $(&quot;a.image&gt;img&quot;, $(&quot;table.wikitable&quot;)[0]).map((_,el)=&gt;&quot;https:&quot;+$(el).attr(&quot;src&quot;).replace(&quot;/thumb/&quot;,&quot;/&quot;).split(&quot;/&quot;).slice(0,-1).join(&quot;/&quot;)+&quot;\n&quot;))</code></li>
<pre class="wrap"><code>https://upload.wikimedia.org/wikipedia/commons/7/71/ICS_Alpha.svg
https://upload.wikimedia.org/wikipedia/commons/f/f7/ICS_Bravo.svg
https://upload.wikimedia.org/wikipedia/commons/e/e7/ICS_Charlie.svg
https://upload.wikimedia.org/wikipedia/commons/e/eb/ICS_Delta.svg
https://upload.wikimedia.org/wikipedia/commons/0/0b/ICS_Echo.svg
https://upload.wikimedia.org/wikipedia/commons/a/a8/ICS_Foxtrot.svg
https://upload.wikimedia.org/wikipedia/commons/f/fb/ICS_Golf.svg
https://upload.wikimedia.org/wikipedia/commons/0/0f/ICS_Hotel.svg
https://upload.wikimedia.org/wikipedia/commons/8/8e/ICS_India.svg
https://upload.wikimedia.org/wikipedia/commons/a/a0/ICS_Juliet.svg
https://upload.wikimedia.org/wikipedia/commons/a/a8/ICS_Kilo.svg
https://upload.wikimedia.org/wikipedia/commons/7/76/ICS_Lima.svg
https://upload.wikimedia.org/wikipedia/commons/7/73/ICS_Mike.svg
https://upload.wikimedia.org/wikipedia/commons/2/21/ICS_November.svg
https://upload.wikimedia.org/wikipedia/commons/c/c9/ICS_Oscar.svg
https://upload.wikimedia.org/wikipedia/commons/d/d0/ICS_Papa.svg
https://upload.wikimedia.org/wikipedia/commons/d/d4/ICS_Quebec.svg
https://upload.wikimedia.org/wikipedia/commons/b/bf/ICS_Romeo.svg
https://upload.wikimedia.org/wikipedia/commons/3/36/ICS_Sierra.svg
https://upload.wikimedia.org/wikipedia/commons/1/1e/ICS_Tango.svg
https://upload.wikimedia.org/wikipedia/commons/e/e2/ICS_Uniform.svg
https://upload.wikimedia.org/wikipedia/commons/e/ef/ICS_Victor.svg
https://upload.wikimedia.org/wikipedia/commons/8/88/ICS_Whiskey.svg
https://upload.wikimedia.org/wikipedia/commons/b/ba/ICS_X-ray.svg
https://upload.wikimedia.org/wikipedia/commons/2/23/ICS_Yankee.svg
https://upload.wikimedia.org/wikipedia/commons/c/c6/ICS_Zulu.svg</code></pre>
		<li class="dash print-before">SHA-1 hash of <code>&lt;img&gt;</code> file mapped to first letter (lowercase): <code>sha1sum ICS_*.svg | perl -ne &#39;print &quot;$1\t\l$2\n&quot; if m/([a-f0-9]+)\s+ICS_([A-Z])/&#39; &gt;1-hash-to-letter.txt</code></li>
<pre class="wrap"><code>d30dad6a23a294b9f210d216d59473d253e91be7	a
d9bf326a6f0d0f00a7d1d8b400507e62d29483ed	b
c11941f79c5500728d0dc7425fe9bb124446079c	c
4f166789cf42b599a7f4f3060d8b6e25f7727e13	d
753cc7b14eff2227d7dac636011a9ac0f5f8c85d	e
e14699d3d770644c8573605ffbc8d4f4aa5f7029	f
dda74b1b698bc28c0cf306c6da9f25050fa3d350	g
069e17c90baaebe58f353e74ce5fb7b1c652be5a	h
0a68cb42def843d4248bced813e0c841ba6e8e5c	i
2195ef95677fc1e704feae58fe9c2b3a2e97ccae	j
3a236df89d94c52b46f6cf749dc09154cc84b08a	k
995e3d13a4caa01bf857401627e14cdb5d8de7b2	l
08863662b355d3b53553c8e514d4ba0a972526f5	m
ecbe3f1de440a2291c6b8179aa66642ea2bc741f	n
9f0ecff5283aa1860b5f398d138540e2cf71d994	o
67b2119bedff230ed0cbff46e5976fd39a6808f0	p
4ce3f408ba42ca2bffee85facd1cb0fe6ecbe11a	q
96c008b70347a138f1c903b3375b942011d61498	r
6d959e1753fdf0367f0595a74346ef2f89984a5f	s
e8b76378e7f17abdc5c0833e2bcd98df0912d049	t
2e3842ba3f23bef3c46e6b8c2bd1097a0500d447	u
327bafff04f8b6b4383a915d277b3e50bc06a9eb	v
9aa58d041d01df5e0f9e3742bda88824a132d352	w
ce959e05c85362c2942472e8f34e8889e9c17d59	x
d6a88534fdb4e978d2f1e1f0e963fcd660ab69bb	y
517cac1d9150b6258e8a82b614711864bb9fb3e1	z</code></pre>
		<li class="dash">some of the given flags are invalid &quot;International Maritime Signal Flags&quot;; only those 600x600 ones are valid, so filter: <code>for f in flag*.svg; do if fgrep -q &#39;width=&quot;600&quot;&#39; &quot;${f}&quot;; then if fgrep -q &#39;height=&quot;600&quot;&#39; &quot;${f}&quot;; then sha1sum &quot;${f}&quot;; fi; fi; done &gt;2-hash-to-flag.txt</code></li>
<pre class="wrap"><code>753cc7b14eff2227d7dac636011a9ac0f5f8c85d	flag01.svg
ecbe3f1de440a2291c6b8179aa66642ea2bc741f	flag02.svg
2195ef95677fc1e704feae58fe9c2b3a2e97ccae	flag04.svg
9f0ecff5283aa1860b5f398d138540e2cf71d994	flag05.svg
fcd4d10bdc43277b3ccbba71382bf0fbfc5bc494	flag06.svg
0ddbf603ef28c81e359e7ba64308990d6f4a214e	flag07.svg
52df748402bccf3c7e8c381fbde0bb34dbda8948	flag08.svg
83f3eec8fb51a3ec4bba76c6be635513fa951fb0	flag09.svg
96c008b70347a138f1c903b3375b942011d61498	flag10.svg
8409911c83fe9df49344dfd34c0434ac7756f0d0	flag12.svg
069e17c90baaebe58f353e74ce5fb7b1c652be5a	flag13.svg
ebccda6096bed11e237d7c40ca3f1ba1ef6124bc	flag14.svg
bbcb27098a0b3174143c44e2d907c72a1fdb7cd8	flag15.svg
517cac1d9150b6258e8a82b614711864bb9fb3e1	flag16.svg</code></pre>
		<li class="dash print-before">determine some of the letters by exact SHA-1 hash match: <code>while read h f; do echo -n &quot;${h}\t${f}\t&quot;; if fgrep -q &quot;${h}&quot; 1-hash-to-letter.txt; then fgrep &quot;${h}&quot; 1-hash-to-letter.txt | cut -f2; else echo; fi; done &lt;2-hash-to-flag.txt</code></li>
<pre class="wrap"><code>753cc7b14eff2227d7dac636011a9ac0f5f8c85d	flag01.svg	e
ecbe3f1de440a2291c6b8179aa66642ea2bc741f	flag02.svg	n
2195ef95677fc1e704feae58fe9c2b3a2e97ccae	flag04.svg	j
9f0ecff5283aa1860b5f398d138540e2cf71d994	flag05.svg	o
fcd4d10bdc43277b3ccbba71382bf0fbfc5bc494	flag06.svg
0ddbf603ef28c81e359e7ba64308990d6f4a214e	flag07.svg
52df748402bccf3c7e8c381fbde0bb34dbda8948	flag08.svg
83f3eec8fb51a3ec4bba76c6be635513fa951fb0	flag09.svg
96c008b70347a138f1c903b3375b942011d61498	flag10.svg	r
8409911c83fe9df49344dfd34c0434ac7756f0d0	flag12.svg
069e17c90baaebe58f353e74ce5fb7b1c652be5a	flag13.svg	h
ebccda6096bed11e237d7c40ca3f1ba1ef6124bc	flag14.svg
bbcb27098a0b3174143c44e2d907c72a1fdb7cd8	flag15.svg
517cac1d9150b6258e8a82b614711864bb9fb3e1	flag16.svg	z</code></pre>

		<li class="dash">to solve the remaining:</li>
		<div style="border: 1px dashed #000;padding: 0 .5em;">
		<ol style="margin: 0 1em;">
			<li>convert all un-mapped <code>ICS_*.svg</code> =&gt; <code>ICS_*.png</code> and <code>flag[0-9]*.svg</code> =&gt; <code>flag[0-9]*.png</code></li>
			transparent background =&gt; white
			<br/>using Inkscape &amp; ImageMagick
			<br/><code>for f in {ICS_,flag[0-9]}*.svg; do inkscape -z -e &quot;${f%%.svg}.png&quot; &quot;${f}&quot;; convert &quot;${f%%.svg}.png&quot; -background white -alpha remove -flatten -alpha off &quot;${f%%.svg}.png&quot;; done</code>
			<li>some of the <code>&lt;img&gt;</code> contain extra borders, causing an exact hash match to fail
			<br/>&#8230;so find closest match, in terms of pixel similarity
			<br/>threshold @ &lt;100k/(600*600)~27.8%
			<br/><code>COLOR=black; for flag in flag[0-9]*.png; do for ics in ICS_*.png; do compare &quot;${flag}&quot; &quot;${ics}&quot; -compose src -highlight-color black cmp.tmp.png; L=$(basename &quot;${ics}&quot;); echo -ne &quot;${(L)L:4:1}\t&quot;; convert cmp.tmp.png -fill black +opaque &quot;${COLOR}&quot; -fill white -fuzz 0 -opaque &quot;${COLOR}&quot; -print &quot;%[fx:int(w*h*mean)]&quot; null:; echo; done | sort -n -k2 | head -1 | while read letter cnt; do if [ &quot;${cnt}&quot; -lt 100000 ]; then echo -e &quot;${flag%%.png}.svg\t${letter}&quot;; fi; done; done; rm -f cmp.tmp.png</code></li>
<pre class="wrap"><code>flag06.svg	y
flag08.svg	a
flag09.svg	f
flag12.svg	s
flag14.svg	b
flag15.svg	m</code></pre>
			<li>it turns out that <code>flag07.svg</code> doesn't match any of the &quot;International Maritime Signal Flags&quot;, even though it is of the expected dimensions 600x600</li>
		</ol>
		</div>
		<li><u>consolidated list</u></li>
<pre class="wrap"><code>flag01.svg	e
flag02.svg	n
flag04.svg	j
flag05.svg	o
flag06.svg	y
flag08.svg	a
flag09.svg	f
flag10.svg	r
flag12.svg	s
flag13.svg	h
flag14.svg	b
flag15.svg	m
flag16.svg	z</code></pre>
		<li class="dash print-before">seq of flags given (list via Chrome DevTools console): <code>console.log.apply(console, $(&quot;.shipflag&quot;).map((_,el) =&gt; $(el).attr(&quot;src&quot;).replace(&quot;images/ship/&quot;,&quot;&quot;)+&quot;\n&quot;))</code></li>
<pre class="wrap"><code>flag01.svg
flag02.svg
flag03.svg
flag04.svg
flag05.svg
flag06.svg
flag07.svg
flag08.svg
flag09.svg
flag10.svg
flag11.svg
flag01.svg
flag12.svg
flag13.svg
flag12.svg
flag01.svg
flag08.svg
flag14.svg
flag10.svg
flag15.svg
flag01.svg
flag01.svg
flag16.svg
flag17.svg
flag01.svg</code></pre>
		<li class="dash">matched consolidated list with seq of flags given: <code>while read f; do fgrep &quot;${f}&quot; 1; done &lt;2 | cut -f2 | tr -d &#39;\n&#39;</code></li>
		<li class="dash"><code class="ans">enjoyafreshseabreeze</code> (removed an extraneous `m`)</li>
	</ul>

	<hr class="print-hidden">
	<li id="qn3" class="qn print-before"><u>Bird's Nest</u> (<a href="file/ps.hacking.hackyeaster.android.apk">mobile</a>)</li>
	@ <code>/assets/www/challenge03.html</code>:
<pre class="wrap" style="padding:0 .5em;">
The little bird has hidden an egg in its nest. Can you find it?

<img src="img/nest.jpg">
</pre>
	<ul>
		<li class="dash">@ <a href="//twitter.com/8lueL1ttleB1rd/status/720201875945984001">//twitter.com/8lueL1ttleB1rd/status/720201875945984001</a></li>
		<li><img src="img/egg03-tweet=720201875945984001.png"></li>
		<li class="dash">@ <a href="//bit.ly/1JjtbId">//bit.ly/1JjtbId</a></li>
		<li>=&gt; <a href="//hackyeaster.hacking-lab.com/hackyeaster/images/egg03_jPr5bJuNexwI4NsRkEcs.png">//hackyeaster.hacking-lab.com/hackyeaster/images/egg03_jPr5bJuNexwI4NsRkEcs.png</a></li>
	</ul>

	<hr class="print-hidden">
	<li id="qn4" class="qn print-before"><u>Sound Check</u> (<a href="file/ps.hacking.hackyeaster.android.apk">mobile</a>)</li>
	@ <code>/assets/www/challenge04.html</code>:
<pre class="wrap" style="padding:0 .5em;">
The new sound system needs a check. Sharpen your ears and listen carefully!

<a href="ps://sound"><button class="btn-dl">Start sound check</button></a>
</pre>
	<ul>
		<li class="dash">@ <code>ps.hacking.hackyeaster.android.SoundActivity</code>:
<pre class="wrap"><code>&#8230;
byte[] woozle = Base64.decode(this.val$activity.getString(C0174R.string.woozle), 0);
for (int i = 0; i < woozle.length; i++) {
	woozle[i] = (byte) (woozle[i] ^ i);
}
&#x2026;
</code></pre></li>
		<li class="dash"><pre class="wrap"><code>#!/usr/bin/env python
#-*- coding: utf-8 -*-

import sys
import struct

data = bytearray(open(&quot;<a href="file/egg04-woozle.in">egg04-woozle.in</a>&quot;, &quot;rb&quot;).read())
key = map(int, list(xrange(len(data))))
o = [(data[i]^key[i])%256 for i in xrange(len(data))]
with open(&quot;egg04-woozle.png&quot;, &quot;wb&quot;) as f: f.write(bytearray(o))
print &quot;egg04-woozle.in =&gt; egg04-woozle.png&quot;</code></pre></li>
	</ul>

	<hr class="print-hidden">
	<li id="qn5" class="qn print-before"><u>Play it again, Paul</u></li>
<pre class="wrap" style="padding:0 .5em;">
Do you know Paul? If not, it's about time to get to know him! Check out his video below!
Ĉu vi scias Paŭlo? Se ne, ĝi estas pri tempo ekkoni lin! Kontroli lian video sube!
</pre>
<video id="video" class="video-js vjs-default-skin" controls preload="metadata" width="480" height="400" poster="img/paul/poster.png" data-setup="">
<source src="file/paul/video.mp4" type="video/mp4"><source src="file/paul/video.webm" type="video/webm"><source src="file/paul/video.ogv" type="video/ogg">
<track label="English" kind="captions" srclang="en" src="file/paul/video-en.vtt" default><track label="Deutsch" kind="captions" srclang="de" src="file/paul/video-de.vtt"><track label="Français" kind="captions" srclang="fr" src="file/paul/video-fr.vtt"><track label="Esperanto" kind="captions" srclang="eo" src="file/paul/video-eo.vtt"></video>
	<ul>
		<li class="dash">hint to look in <a href="file/paul/video-eo.vtt">Esperanto subtitle file</a>, since given translation (second line) is in Esperanto</li>
		<li class="dash">
<pre class="wrap"><code>1
00:01:00.000 --> 00:01:03.000
passphrase is &quot;<font class="ans">youtubelotitis</font>&quot;</code></pre></li>
		<!--
			$ mediainfo file/paul/video.mp4
			# Text #4
			# ID                                       : 7
			# Format                                   : Timed Text
			# Muxing mode                              : sbtl
			# Codec ID                                 : tx3g
			# Duration                                 : 1mn 3s
			# Bit rate mode                            : Variable
			# Bit rate                                 : 82 bps
			# Stream size                              : 644 Bytes (0%)
			# Language                                 : Esperanto
			# Encoded date                             : UTC 2015-08-25 20:48:27
			# Tagged date                              : UTC 2015-08-25 20:48:27

			$ ffmpeg -i file/paul/video.mp4
			# Stream #0:6(epo): Subtitle: mov_text (tx3g / 0x67337874), 1152x60, 0 kb/s

			$ ffmpeg -i file/paul/video.mp4 -an -vn -map 0:6 -c:s:0 srt file/paul/epo.srt
			# passphrase is "youtubelotitis"
		-->
	</ul>

	<hr class="print-hidden">
	<li id="qn6" class="qn print-before"><u>Going Up</u></li>
<pre class="wrap" style="padding:0 .5em;">
Time for an elevator ride. Guess the right floor, and find the hidden easter egg!
</pre>
<style type="text/css">
	.tablediv { display: table; }
	.tablerow { display: table-row; }
	.tablecell { display: table-cell; }

	.round-button {
		/*width: 75px;
		height: 75px;*/
		margin-left: 5px;
		margin-right: 5px;
		margin-bottom: 5px;
		float: left;
	}
	.round-button-circle {
		width: 75px;
		height: 75px;
		padding-bottom: 0px;
		border-radius: 50%;
		border: 10px solid #333;
		overflow: hidden;
		background: #eee none repeat scroll 0% 0%;
		box-shadow: 0px 0px 3px #555;
	}
	.round-button-circle:hover {
		background: #666;
	}
	.round-button a {
		display:block;
		float:left;
		width:100%;
		padding-top:50%;
		padding-bottom:50%;
		line-height:1em;
		margin-top:-0.5em;
		margin-left: 0;
		text-align:center;
		color:#333 !important;
		font-family:Verdana;
		font-size:1.2em;
		font-weight:bold;
		text-decoration:none;
	}
</style>
<div class="tablediv" id="table"><div class="tablerow"><div class="tablecell" style="width: 25%; padding-bottom: 10px;"><div class="round-button" onclick="return false;"><div class="round-button-circle"><a href="?floor=sixteen" class="round-button" onclick="return false;">16</a></div></div><div class="round-button" onclick="return false;"><div class="round-button-circle"><a href="?floor=seventeen" class="round-button" onclick="return false;">17</a></div></div><div class="round-button" onclick="return false;"><div class="round-button-circle"><a href="?floor=eighteen" class="round-button" onclick="return false;">18</a></div></div></div></div><div class="tablerow"><div class="tablecell" style="width: 25%; padding-bottom: 10px;">
<div class="round-button" onclick="return false;"><div class="round-button-circle" style="background-color:yellow;" ><a href="?sybbe=punatrzr" class="round-button" onclick="return false;">13</a></div></div>
<div class="round-button" onclick="return false;"><div class="round-button-circle"><a href="?floor=fourteen" class="round-button" onclick="return false;">14</a></div></div><div class="round-button" onclick="return false;"><div class="round-button-circle"><a href="?floor=fifteen" class="round-button" onclick="return false;">15</a></div></div></div></div><div class="tablerow"><div class="tablecell" style="width: 25%; padding-bottom: 10px;"><div class="round-button" onclick="return false;"><div class="round-button-circle"><a href="?floor=ten" class="round-button" onclick="return false;">10</a></div></div><div class="round-button" onclick="return false;"><div class="round-button-circle"><a href="?floor=eleven" class="round-button" onclick="return false;">11</a></div></div><div class="round-button" onclick="return false;"><div class="round-button-circle"><a href="?floor=twelve" class="round-button" onclick="return false;">12</a></div></div></div></div><div class="tablerow"><div class="tablecell" style="width: 25%; padding-bottom: 10px;"><div class="round-button" onclick="return false;"><div class="round-button-circle"><a href="?floor=seven" class="round-button" onclick="return false;">07</a></div></div><div class="round-button" onclick="return false;"><div class="round-button-circle"><a href="?floor=eight" class="round-button" onclick="return false;">08</a></div></div><div class="round-button" onclick="return false;"><div class="round-button-circle"><a href="?floor=nine" class="round-button" onclick="return false;">09</a></div></div></div></div><div class="tablerow"><div class="tablecell" style="width: 25%; padding-bottom: 10px;"><div class="round-button" onclick="return false;"><div class="round-button-circle"><a href="?floor=four" class="round-button" onclick="return false;">04</a></div></div><div class="round-button" onclick="return false;"><div class="round-button-circle"><a href="?floor=five" class="round-button" onclick="return false;">05</a></div></div><div class="round-button" onclick="return false;"><div class="round-button-circle"><a href="?floor=six" class="round-button" onclick="return false;">06</a></div></div></div></div><div class="tablerow"><div class="tablecell" style="width: 25%; padding-bottom: 10px;"><div class="round-button" onclick="return false;"><div class="round-button-circle"><a href="?floor=one" class="round-button" onclick="return false;">01</a></div></div><div class="round-button" onclick="return false;"><div class="round-button-circle"><a href="?floor=two" class="round-button" onclick="return false;">02</a></div></div><div class="round-button" onclick="return false;"><div class="round-button-circle"><a href="?floor=three" class="round-button" onclick="return false;">03</a></div></div></div></div></div>
<div id="fail" style="width: 300px;background: rgba(221,221,221,0.5);border: 1px solid #000;">Nope! Click the image to try again!<br/><img class="no-border" src="img/elevator_fail.jpg" style="width: 284px;" onclick="javascript:window.location.href='challenge06.html';" /></div>
	<ul>
		<li class="dash">one of the links is not like the others: btn #13 links to <a href="?sybbe=punatrzr" onclick="return false;">?sybbe=punatrzr</a></li>
		<li class="dash"><code>rot13</code> => <a href="?floor=changeme" onclick="return false;">?floor=changeme</a></li>
		<li class="dash">so <a href="?floor=thirteen" onclick="return false;">?floor=thirteen</a> => <code>rot13</code> => <a class="ans" href="//hackyeaster.hacking-lab.com/hackyeaster/challenge06.html?sybbe=guvegrra">?sybbe=guvegrra</a></li>
		<li class="ans">@ <a href="//hackyeaster.hacking-lab.com/hackyeaster/challenge06_8ce833745ef167679aa44d6d6c098ab6abf8ec80.html">//hackyeaster.hacking-lab.com/hackyeaster/challenge06_8ce833745ef167679aa44d6d6c098ab6abf8ec80.html</a></li>
		<!--
			p = window.location.search; //?sybbe=guvegrra
			if (p) {
				if (CryptoJS.SHA1(CryptoJS.SHA1(p)) == "ed64517461f2d60887f75c2ea4d8a0b03f5ece49") {
					window.location.href = "challenge06_" + CryptoJS.SHA1(p) + ".html";
				}
				...
			}
		-->
	</ul>

	<hr class="print-hidden">
	<li id="qn7" class="qn print-before"><u>Wise Rabbit Once More</u></li>
<pre class="wrap" style="padding:0 .5em;">
Wise Rabbit says:

<i>The solution is in the solutions!
Go back and scroll to 123!</i>
</pre>
	<ul>
		<li class="dash"><a href="//media.hacking-lab.com/hackyeaster/HackyEaster2015_Solutions_high.pdf">2015HE solution document</a> pg #123</li>
		<li class="dash">password: <code class="ans">goldfish</code></li>
	</ul>

	<hr class="print-hidden">
	<li id="qn8" class="qn print-before"><u>Just Drive</u> (<a href="file/ps.hacking.hackyeaster.android.apk">mobile</a>)</li>
	@ <code>/assets/www/challenge08.html</code>:
<pre class="wrap"><code>var solved = false;
var hist = &quot;&quot;;
&#8230;
function rotFeedback(jsonString) {
	if (json) {
		hist = json.h;
		if (json.k) {
			solved = true;
		} else if (json.s &gt; 1) {
			$(&quot;#rotImg&quot;).attr(&quot;src&quot;, &quot;images/rot/rot&quot;+json.s+&quot;.png&quot;);
		} else {
			$(&quot;#rotImg&quot;).attr(&quot;src&quot;, &quot;images/egg_gray.png&quot;);
		}
	}
}

setInterval(function () {
	if (!solved) {
		document.location.href = &quot;ps://<font class="ans">rot</font>?h=&quot;+hist;
	}
}, 1000);</code></pre>
	<ul>
		<li class="dash">@ <code>ps.hacking.hackyeaster.android.Activity</code>:</li>
<pre class="wrap"><code>private String handleRot(String s) {
	char c;
	switch (((WindowManager) getSystemService(&quot;window&quot;)).getDefaultDisplay().getRotation()) {
		case SwipeRefreshLayout.LARGE /*0*/:
			c = &#39;r&#39;;
			break;
		case SwipeRefreshLayout.DEFAULT /*1*/:
			c = &#39;n&#39;;
			break;
		case WearableExtender.SIZE_MEDIUM /*3*/:
			c = &#39;x&#39;;
			break;
		default:
			c = &#39;l&#39;;
			break;
	}
	if (!s.startsWith(BuildConfig.VERSION_NAME + c)) {
		s = c + s;
	}
	if (s.length() &gt; 8) {
		s = s.substring(0, 8);
	}
	int steps = 0;
	String key = BuildConfig.VERSION_NAME;
	String h = sha1(s);
	if (h.startsWith(&quot;4692bd56dd3070f74b7e&quot;)) {
		key = h;
	} else if (s.length() &gt;= 7 &amp;&amp; &quot;1ab9a97066f747c25d9c6a6b0fda647fae98cb98&quot;.equals(sha1(s.substring(0, 7)))) {
		steps = 7;
	} else if (s.length() &gt;= 6 &amp;&amp; &quot;58192f7d1263bd420efb788cc884a84f871239cf&quot;.equals(sha1(s.substring(0, 6)))) {
		steps = 6;
	} else if (s.length() &gt;= 5 &amp;&amp; &quot;e8f235e79be9f8b13598b285a6fdaf2ac70a66ca&quot;.equals(sha1(s.substring(0, 5)))) {
		steps = 5;
	} else if (s.length() &gt;= 4 &amp;&amp; &quot;3daee0c0bada99f5bf0866728fd78299acaafa15&quot;.equals(sha1(s.substring(0, 4)))) {
		steps = 4;
	} else if (s.length() &gt;= 3 &amp;&amp; &quot;f11fa81c0b72716bba0536dd34b9b0987af69b03&quot;.equals(sha1(s.substring(0, 3)))) {
		steps = 3;
	} else if (s.length() &gt;= 2 &amp;&amp; &quot;a8643e0e26d5ead82e73aae64966ca144f152d8a&quot;.equals(sha1(s.substring(0, 2)))) {
		steps = 2;
	} else if (s.length() &gt;= 1 &amp;&amp; &quot;4dc7c9ec434ed06502767136789763ec11d2c4b7&quot;.equals(sha1(s.substring(0, 1)))) {
		steps = 1;
	}
	return &quot;{ \&quot;s\&quot;: &quot; + steps + &quot;, \&quot;h\&quot;:\&quot;&quot; + s + &quot;\&quot;, \&quot;k\&quot;:\&quot;&quot; + key + &quot;\&quot; }&quot;;
}</code></pre>
		<li class="dash">crack SHA1 hashes using <code>cudaHashcat</code>; charset: `rnxl`</li>
		<ul>
			<li class="dash"><code class="ans">4692bd56dd3070f74b7e81c6b2f69339b0fd6062:&nbsp;nrxrxrnr</code></li>
			<li class="dash"><code>1ab9a97066f747c25d9c6a6b0fda647fae98cb98:&nbsp;&nbsp;rxrxrnr</code></li>
			<li class="dash"><code>58192f7d1263bd420efb788cc884a84f871239cf:&nbsp;&nbsp;&nbsp;xrxrnr</code></li>
			<li class="dash"><code>e8f235e79be9f8b13598b285a6fdaf2ac70a66ca:&nbsp;&nbsp;&nbsp;&nbsp;rxrnr</code></li>
			<li class="dash"><code>3daee0c0bada99f5bf0866728fd78299acaafa15:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xrnr</code></li>
			<li class="dash"><code>f11fa81c0b72716bba0536dd34b9b0987af69b03:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rnr</code></li>
			<li class="dash"><code>a8643e0e26d5ead82e73aae64966ca144f152d8a:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nr</code></li>
			<li class="dash"><code>4dc7c9ec434ed06502767136789763ec11d2c4b7:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;r</code></li>
		</ul>
<!--
#!/usr/bin/env python
#-*- coding: utf-8 -*-

import sys
import string
import itertools
import hashlib

charset = "rnxl"
for i in xrange(8,9):
	print "=== |"+str(i)+"| ==="
	for c in itertools.product(charset, repeat=i):
		sz = "".join(c)
		hash = hashlib.sha1(sz).hexdigest()
		if hash.startswith("4692bd56dd3070f74b7e"):
			print "\t".join([sz, hash])
			break
-->
		<li class="dash"><pre class="wrap"><code>$(document).ready(function () {
	var o = {k: &quot;4692bd56dd3070f74b7e81c6b2f69339b0fd6062&quot;};
	var s = CryptoJS.enc.Latin1.stringify(
		CryptoJS.AES.decrypt(scrambledEggCipher, o.k)
	);
	// var png_magic_s = &quot;iVBORw0KGgoAAAANSUhEUgAAA&quot;;
	// s.startsWith(png_magic_s);
	// s.substring(0,26) === png_magic_s;
	document.getElementById(&quot;rotImg&quot;).src = &quot;data:image/png;base64,&quot;+s;
});</code></pre></li>
	</ul>

	<hr class="print-hidden">
	<li id="qn9" class="qn print-before"><u>Brain Game</u></li>
<pre class="wrap" style="padding:0 .5em;">
What about a little brain game?

<img src="img/braingame.png">

1. e4 e5 2. Nf3 Nc6 3. Bb5 Nf6 4. d3 Bc5 5. O-O d6 6. Nbd2 O-O 7. Bxc6 bxc6 8. h3 h6 9. Re1 Re8 10. Nf1 a5 11. Ng3 Rb8 12. b3 Bb4 13. Bd2 Ra8 14. c3 Bc5 15. d4 Bb6 16. dxe5 dxe5 17. c4 Nh7 18. Qe2 Nf8 19. Be3 c5 20. Rad1 Qf6 21. Nh5 Qe7 22. Nh2 Kh7 23. Qf3 f6 24. Ng4 Bxg4 25. Qxg4 Red8 26. Qf5+ Kh8 27. f4 Rxd1 28. Rxd1 exf4 29. Bxf4 Qe6 30. Rd3 Re8 31. Nxg7 Kxg7 32. Qh5 Nh7 33. Bxh6+ Kh8 34. Qg6 Qg8 35. Bg7+ Qxg7 36. Qxe8+ Qf8 37. Qe6 Qh6 38. e5 Qc1+ 39. Kh2 Qf4+ 40. Rg3 1-0
</pre>
	<ul>
		<li class="dash">each term in the string of the <span style="color:#fff;background-color:#f00;">white-on-red</span> part encodes a row of the state of the chessboard, from top to bottom</li>
		<li class="dash">`0` indicates absence of a piece in that particular grid cell, while `1` indicates presence</li>
		<li class="dash">interpret each row of `0`s and `1`s formed this way in binary, and convert it to decimal</li>
		<li class="dash">play out the given sequence of moves from the initial state, as given:</li>
		<li><img src="img/egg09-board.png"></li>
		<li class="dash">encode the final state of the chessboard similarly:</li>
		<table style="border-collapse:separate;border-spacing:3px;font-family:monospace;font-size:16px;">
			<tbody>
				<tr><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>1</td></tr>
				<tr><td>0</td><td>0</td><td>1</td><td>0</td><td>0</td><td>0</td><td>0</td><td>1</td></tr>
				<tr><td>0</td><td>1</td><td>0</td><td>0</td><td>1</td><td>1</td><td>0</td><td>0</td></tr>
				<tr><td>1</td><td>0</td><td>1</td><td>0</td><td>1</td><td>0</td><td>0</td><td>0</td></tr>
				<tr><td>0</td><td>0</td><td>1</td><td>0</td><td>0</td><td>1</td><td>0</td><td>0</td></tr>
				<tr><td>0</td><td>1</td><td>0</td><td>0</td><td>0</td><td>0</td><td>1</td><td>1</td></tr>
				<tr><td>1</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>1</td><td>1</td></tr>
				<tr><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td></tr>
			</tbody>
		</table>
		<li class="dash ans">1-33-76-168-36-67-131-0</li>
	</ul>
</ul>

	<hr class="print-hidden">
	<li id="qn10" class="qn print-before"><u>Blueprint</u></li>
<!-- @ http://dean.edwards.name/packer -->
<script type="text/javascript">
eval(function(p,a,c,k,e,r){e=function(c){return(c<a?'':e(parseInt(c/a)))+((c=c%a)>35?String.fromCharCode(c+29):c.toString(36))};if(!''.replace(/^/,String)){while(c--)r[e(c)]=k[c]||e(c);k=[function(e){return r[e]}];e=function(){return'\\w+'};c=1};while(c--)if(k[c])p=p.replace(new RegExp('\\b'+e(c)+'\\b','g'),k[c]);return p}('z C(){9 a=$("#q").s();9 b=6(a);9 y,e,f=0;9 c=$("#B")[0].D("o");c.g="#r";c.h(0,0,u*4,d*4);l(x=F;x>=0;x--){e=0;y=b;l(v=0;v<=p;v++){i(6.j(6.k(6.k(y,d),6.t(2,(d*x)+6.j(y,d))),2)>0.5){c.g="#w";c.h(f,e,3,3)}y=6.A(y,1);e+=4}f+=4}i(7.8(7.8(a))=="m"){E("7.8(7.8(a)) == \\"m\\"\\n\\n@ G"+7.8(a)+".H")}}',44,44,'||||||BigInteger|CryptoJS|SHA1|var||||17|yy|xx|fillStyle|fillRect|if|remainder|divide|for|c63733cf3c66f0311b5c029f2a981f0239d990ad||2d|16|value|0000dd|val|pow|106||ffffff|||function|add|canvas|plot|getContext|alert|105|challenge10_|html'.split('|'),0,{}))
</script>
<pre class="wrap" style="padding:0 .5em;">
Time for some math! Find the number which produces the plot on the bottom!
Try these two samples: <a onclick="$('#value').val('2228207');">sample 1</a>, <a onclick="$('#value').val('607016736537520995594815505941151025266085572371665528200038731931478673846727319684910259261305939019800769557502357959237333126657517770919783070679372916294368356299408372540498306857438421105135681283249346869449792967320249238095120706670142921097242873599571883821374208364354014530087192947246803225868116625497030891935667180689024971315282228337059319954976085961871005910163343474177499795224476259823484556802260391642987108868423291931973521858141803706752591127589236027411683906358835596869641180286211179357749072326208778420088');">sample 2</a>.<textarea id="value" style="width:100%;height:68px;" placeholder="number to plot">17657949201581490152887262552977461550821547861463862839240664323911642807489754168164179332567124887458095049966838272395838833335464853226293169893063985683542234868393982863605544853380459104965350326137397441646486218169598347856207906783361422905911386919743769975974237367400302886153547602709155224361686573545769765610544442950623858438305126210029328322211845690185546981876389418111008050801364588449772605640341039292322155464883254208546726202316901388360683605114288184962864450110296056848249404578342545423849729556480</textarea><button class="btn-dl" onClick="javascript:plot();">Plot!</button>
Your plot:<br/><canvas id="canvas" width="424" height="68" style="background:#0000dd;border-top:1px solid #0000dd;border-left:1px solid #0000dd;"></canvas>
Target plot:<br/><img class="no-border" src="img/plot.png" style="width:424px;height:68px;" />
</pre>
	<ul>
		<li class="dash"><pre class="wrap"><code>require &quot;chunky_png&quot;

img = ChunkyPNG::Image.from_file(&quot;<a href="img/plot.png">plot.png</a>&quot;)
lookup = Hash.new(0)
img.width.times do |x|
	img.height.times do |y|
		r = ChunkyPNG::Color.r(img.get_pixel(x,y))
		g = ChunkyPNG::Color.g(img.get_pixel(x,y))
		b = ChunkyPNG::Color.b(img.get_pixel(x,y))
		xx = (x/4)
		yy = (y/4)
		if r==255 and g==255 and b==255
			lookup[[xx, yy]] = [lookup[[xx, yy]].to_i, 1].max
		end
	end
end
bin = &quot;&quot;
106.times {|x| 17.times{|y| bin += lookup[[x,16-y]].to_s }}
p bin.to_i(2)*17</code></pre></li>
		<li class="dash ans" style="word-break:break-all;"><a href="//hackyeaster.hacking-lab.com/hackyeaster/challenge10_7fe2ea3751694cb6653d6bd3e7f39d089da29dc7.html">17657949201581490152887262552977461550821547861463862839240664323911642807489754168164179332567124887458095049966838272395838833335464853226293169893063985683542234868393982863605544853380459104965350326137397441646486218169598347856207906783361422905911386919743769975974237367400302886153547602709155224361686573545769765610544442950623858438305126210029328322211845690185546981876389418111008050801364588449772605640341039292322155464883254208546726202316901388360683605114288184962864450110296056848249404578342545423849729556480</a></li>
		<!--
			echo -n "17657949201581490152887262552977461550821547861463862839240664323911642807489754168164179332567124887458095049966838272395838833335464853226293169893063985683542234868393982863605544853380459104965350326137397441646486218169598347856207906783361422905911386919743769975974237367400302886153547602709155224361686573545769765610544442950623858438305126210029328322211845690185546981876389418111008050801364588449772605640341039292322155464883254208546726202316901388360683605114288184962864450110296056848249404578342545423849729556480" | sha1sum | cut -d' ' -f1
				=> 7fe2ea3751694cb6653d6bd3e7f39d089da29dc7
			echo -n "7fe2ea3751694cb6653d6bd3e7f39d089da29dc7" | xxd -p -r | sha1sum | cut -d' ' -f1
				=> c63733cf3c66f0311b5c029f2a981f0239d990ad
		-->
	</ul>

	<hr class="print-hidden">
	<li id="qn11" class="qn print-before"><u>Twisted Disc</u></li>
<pre class="wrap" style="padding:0 .5em;">
You found a secret disc which conceals a secret password. Can you crack it?

Hint: Each ring of the disc holds one letter. The first letter sits on the outermost ring.

<a href="file/disc.pdf"><button class="btn-dl">Download</button></a>
</pre>
	<ul>
		<li class="dash">letters that appear once only (i.e. unique) in each ring</li>
		<ul>
			<li class="ans">h</li>
			<li class="ans">a</li>
			<li class="ans">n</li>
			<li class="ans">i</li>
			<li>e, l, <font class="ans">s</font></li>
			<li class="ans">h</li>
			<li class="ans">o</li>
		</ul>
		<li class="dash ans">hanisho</li>
	</ul>

	<hr class="print-hidden">
	<li id="qn12" class="qn print-before"><u>Version Out Of Control</u></li>
<pre class="wrap" style="padding:0 .5em;">
Version control is a powerful tool. Thinking she was oh so smart, Fluffy used it to hide an easter egg. Can you pull out the egg from her file?

Hint: If you get stuck, go one step back.

<a href="file/1000.zip"><button class="btn-dl">Download her file</button></a>
</pre>
	<ul>
		<li class="dash">nested `.git` repo</li>
		<li class="dash"><code>_PWD="${PWD}"; for i in $(seq -f %04g 1000 -1 1); do git checkout ${i}.zip; mv ${i}.zip "${_PWD}"; cd "${_PWD}"; 7za x ${i}.zip; cd ${i}; done</code></li>
		<li class="dash">#722: <code>0722-trunk.jpg</code></li>
		<img src="img/0722-trunk.jpg">
<pre class="wrap"><code>commit dcf4797deccfbeaea0e3bcd12d2b32b1185326f6 &lt;-- &lt;trunk.jpg&gt;
Author: Fluffy &lt;fluffy@bunnymail.net&gt;
Date:   Thu Nov 26 21:12:51 2015 +0100

	Change committed

commit 44dc75110bf3139dca7aa156cfe11781971887bd
Author: Fluffy &lt;fluffy@bunnymail.net&gt;
Date:   Thu Nov 26 21:12:51 2015 +0100

	Change committed

commit 93d630215b9c5c49f2c7f3c6b9fe1b55efd93cd1
Author: Fluffy &lt;fluffy@bunnymail.net&gt;
Date:   Thu Nov 26 21:12:51 2015 +0100

	Commit committed</code></pre>
		<li><code>git reset 93d630215b9c5c49f2c7f3c6b9fe1b55efd93cd1</code></li>
		<li class="dash">#396: <code>0396-scooter.jpg</code></li>
		<img src="img/0396-scooter.jpg">
<pre class="wrap"><code>commit a0c43441f52a5ff4362156a2f8db1d16a4f8bb3b &lt;-- &lt;scooter.jpg&gt;
Author: Fluffy &lt;fluffy@bunnymail.net&gt;
Date:   Thu Nov 26 21:10:08 2015 +0100

	Commit committed

commit 27dbde667908b19d59eb6d8e3ed8802ebf34ab9b
Author: Fluffy &lt;fluffy@bunnymail.net&gt;
Date:   Thu Nov 26 21:10:08 2015 +0100

	Commit committed</code></pre>
		<li><code>git reset 27dbde667908b19d59eb6d8e3ed8802ebf34ab9b</code></li>
		<li class="dash">#46: passwd-prot archive <code>0045.zip</code></li>
<pre class="wrap"><code>commit 37f69df62069e4d98e60986aa5d4b4b21e66ccc3
Author: Fluffy <fluffy@bunnymail.net>
Date:   Thu Nov 26 21:08:52 2015 +0100

	Commit committed. Pass is fluffy99 <-- for 0045.zip</code></pre>
	</ul>

	<hr class="print-hidden">
	<li id="qn13" class="qn print-before"><u>Fractal Fumbling</u></li>
<pre class="wrap" style="padding:0 .5em;">
Do you need a new wallpaper? What about a fancy fractal?

Find the password hidden in the wallpaper image, and enter it in the Egg-O-Matic below.

<a href="img/wallpaper.jpg"><img src="img/wallpaper-thumb.jpg"></a></pre>
	<ul>
		<li class="dash">extract QR codes individually from given image</li>
<pre class="wrap"><code>#!/usr/bin/env python
#-*- coding: utf-8 -*-

import os
import sys
from PIL import Image

if __name__ == &quot;__main__&quot;:
	im = Image.open(&quot;wallpaper.jpg&quot;)
	w, h = im.size
	pix = im.load()
	qr_w, qr_h = 21, 21
	m = 0
	for y in xrange(0,h,qr_h):
		for x in xrange(0,w,qr_w):
			top_left = (x,y)
			btm_right = (x+qr_w-1,y+qr_h-1)
			im_qr = Image.new(&quot;RGB&quot;, (qr_w,qr_h), &quot;white&quot;)
			pix_qr = im_qr.load()
			for c in xrange(qr_w):
				for r in xrange(qr_h):
					pix_qr[c, r] = pix[x+c, y+r]
			folder = &quot;img&quot;
			if not os.path.exists(folder):
				os.makedirs(folder)
			fp = &quot;%s/egg13-out-%d.png&quot; %(folder,m)
			im_qr.save(fp)
			print&gt;&gt;sys.stderr, &quot;=&gt;&quot;, fp
			m += 1</code></pre>
		<li class="dash">process using <a href="//github.com/zxing/zxing">zxing</a>:</li>
		<!-- zbarimg -->
		<ul>
			<li class="dash">either &quot;<code>No barcode found</code>&quot;</li>
			<li class="dash">or QR code txt == <code>xx*</code></li>
			<li class="dash">except #58608&nbsp;<img class="vmid no-border" src="img/egg13-out-58608.png">: <code class="ans">fractalsaresokewl</code></li>
		</ul>
	</ul>

	<hr class="print-hidden">
	<li id="qn14" class="qn print-before"><u>P.A.L.M.</u></li>
<pre class="wrap" style="padding:0 .5em;">
Folks at <font style="font-variant:small-caps;">HOBO Authentication Systems</font> implemented a new authentication system named <nobr>P.A.L.M. &trade;</nobr>

Prove that you can break it and find a pair of username and passcode to log on.

<h3>P.A.L.M. Authentication &trade;</h3>
<input type="text" name="username" id="puser" value="">
<input type="number" name="password" id="ppass" value="">
<input type="button" onclick="javascript:checkEntries();" value="Login" class="btn-dl">
</pre>
	<ul>
		<li class="dash">decoy js</li>
<pre class="wrap" style="word-break:break-all;"><code>function checkEntries() {
	var u = document.getElementById(&quot;puser&quot;).value;
	var p = document.getElementById(&quot;ppass&quot;).value;
	if (u === &quot;yolo&quot; &amp;amp;&amp;amp; p === &quot;1337&quot;) {
		document.location.href = &quot;challenge14_&quot; + u + &quot;_&quot; + p + &quot;.html&quot;;
	} else {
		alert(&quot;nope&quot;);
	}
}
var _0x549b = [&quot;value&quot;, &quot;puser&quot;, &quot;getElementById&quot;, &quot;ppass&quot;, &quot;rolo&quot;, &quot;length&quot;, &quot;charAt&quot;, &quot;href&quot;, &quot;location&quot;, &quot;challenge14_&quot;, &quot;_&quot;, &quot;.html&quot;, &quot;nope&quot;];
function checkEntries() {
	var u = document[_0x549b[2]](_0x549b[1])[_0x549b[0]];
	var p = document[_0x549b[2]](_0x549b[3])[_0x549b[0]];
	var ok = false;
	if (u === _0x549b[4]) {
		if (p &gt; 0 &amp;amp;&amp;amp; p[_0x549b[5]] == 10) {
			ok = true;
			for (i = 0; i &lt;= 9; i++) {
				var digit = p[_0x549b[6]](i);
				if (digit != 9 - i) {
					ok = false
				}
			}
		}
	};
	if (ok) {
		document[_0x549b[8]][_0x549b[7]] = _0x549b[9] + u + _0x549b[10] + p + _0x549b[11]
	} else {
		alert(_0x549b[12])
	}
};</code></pre>
		<li class="dash">@ btm of webpage HTML src</li>
<pre class="wrap" style="word-break:break-all;"><code>eval(atob("ZXZhbChmdW5jdGlvbihwLGEsYyxrLGUsZCl7ZT1mdW5jdGlvbihjKXtyZXR1cm4gYy50b1N0cmluZygzNil9O2lmKCEnJy5yZXBsYWNlKC9eLyxTdHJpbmcpKXt3aGlsZShjLS0pe2RbYy50b1N0cmluZyhhKV09a1tjXXx8Yy50b1N0cmluZyhhKX1rPVtmdW5jdGlvbihlKXtyZXR1cm4gZFtlXX1dO2U9ZnVuY3Rpb24oKXtyZXR1cm4nXFx3Kyd9O2M9MX07d2hpbGUoYy0tKXtpZihrW2NdKXtwPXAucmVwbGFjZShuZXcgUmVnRXhwKCdcXGInK2UoYykrJ1xcYicsJ2cnKSxrW2NdKX19cmV0dXJuIHB9KCdyIHEoKXsyIHU9Ny44KFwnd1wnKS5iOzIgcD03LjgoXCd2XCcpLmI7MiA0PVswLDAsMCwwLDAsMCwwLDAsMCwwXTsyIDU9YzszKHU9PT1cJ2dcJyl7MyhwPjAmJnAuaD09OSl7NT1qO2YoaT0xO2k8PTk7aSsrKXsyIDY9cC5rKGktMSk7MiBhPXAuZSgwLGkpOzMoNFs2XSE9MHx8YSVpIT0wKXs1PWN9Myg0WzZdPT0wKXs0WzZdPTF9fX19Myg1KXs3Lm0ubj1cJ29cJyt1K1wneFwnK3ArXCcuc1wnfXR7ZChcJ2xcJyl9fScsMzQsMzQsJ3x8dmFyfGlmfHVzZWR8b2t8ZGlnaXR8ZG9jdW1lbnR8Z2V0RWxlbWVudEJ5SWR8MTB8cGFydHx2YWx1ZXxmYWxzZXxhbGVydHxzdWJzdHJpbmd8Zm9yfGVsc2F8bGVuZ3RofHx0cnVlfGNoYXJBdHxub3BlfGxvY2F0aW9ufGhyZWZ8Y2hhbGxlbmdlMTRffHxjaGVja0VudHJpZXN8ZnVuY3Rpb258aHRtbHxlbHNlfHxwcGFzc3xwdXNlcnxfJy5zcGxpdCgnfCcpLDAse30pKQ=="));</code></pre></li>
<li>...becomes...</li>
<pre class="wrap" style="word-break:break-all;"><code>eval(eval(function(p,a,c,k,e,d){e=function(c){return c.toString(36)};if(!&#39;&#39;.replace(/^/,String)){while(c--){d[c.toString(a)]=k[c]||c.toString(a)}k=[function(e){return d[e]}];e=function(){return&#39;\\w+&#39;};c=1};while(c--){if(k[c]){p=p.replace(new RegExp(&#39;\\b&#39;+e(c)+&#39;\\b&#39;,&#39;g&#39;),k[c])}}return p}(&#39;r q(){2 u=7.8(\&#39;w\&#39;).b;2 p=7.8(\&#39;v\&#39;).b;2 4=[0,0,0,0,0,0,0,0,0,0];2 5=c;3(u===\&#39;g\&#39;){3(p&gt;0&amp;&amp;p.h==9){5=j;f(i=1;i&lt;=9;i++){2 6=p.k(i-1);2 a=p.e(0,i);3(4[6]!=0||a%i!=0){5=c}3(4[6]==0){4[6]=1}}}}3(5){7.m.n=\&#39;o\&#39;+u+\&#39;x\&#39;+p+\&#39;.s\&#39;}t{d(\&#39;l\&#39;)}}&#39;,34,34,&#39;||var|if|used|ok|digit|document|getElementById|10|part|value|false|alert|substring|for|elsa|length||true|charAt|nope|location|href|challenge14_||checkEntries|function|html|else||ppass|puser|_&#39;.split(&#39;|&#39;),0,{})))</code></pre>
<li> @ <a href="//jsbeautifier.org">//jsbeautifier.org</a></li>
<pre class="wrap"><code>function checkEntries() {
	var u = document.getElementById(&quot;puser&quot;).value;
	var p = document.getElementById(&quot;ppass&quot;).value;
	var used = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0];
	var ok = false;
	if (u === &quot;elsa&quot;) {
		if (p &gt; 0 &amp;&amp; p.length == 10) {
			ok = true;
			for (i = 1; i &lt;= 10; i++) {
				var digit = p.charAt(i - 1);
				var part = p.substring(0, i);
				if (used[digit] != 0 || part % i != 0) {
					ok = false;
				}
				if (used[digit] == 0) {
					used[digit] = 1;
				}
			}
		}
	}
	if (ok) {
		document.location.href = &quot;challenge14_&quot;+u+&quot;_&quot;+p+&quot;.html&quot;;
	} else {
		alert(&quot;nope&quot;);
	}
}</code></pre>
		<li class="dash ans">elsa / 3816547290</li>
	</ul>

	<hr class="print-hidden">
	<li id="qn15" class="qn print-before"><u>Big Bad Wolf</u></li>
<pre class="wrap" style="padding:0 .5em;">
Three little pigs have hidden in their house. You're the big, bad wolf, and your stomach is growling. Huff and puff and blow the pigs' house in! Get that juicy bacon!

Hints:
• the pigs have hidden in three different media types (image, sound, text)</li>
• no password cracking is necessary

<a href="file/disk.img"><button class="btn-dl">Download the pigs' file</button></a>
</pre>
	<ul>
		<li class="dash">file listing:</li>
		<ul>
			<li class="default">piglet.jpg</li>
			<li class="default">pigs.jpg</li>
			<li class="default ans">song.mp3</li>
			<li class="default">story.pdf</li>
			<li class="default ans">story.txt</li>
			<li class="default ans">wolf.jpg</li>
		</ul>
		<li class="dash">pig 1: <font class="ans">Filbert</font> @ <a href="//www.darkside.com.au/snow">SNOW</a> story.txt</li>
		<li class="dash">pig 2: <font class="ans">Cassadee</font> $ <code><a href="//www.sno.phy.queensu.ca/~phil/exiftool">exiftool</a> wolf.jpg | fgrep "XP Comment"</code></li>
		<li class="dash">pig 3: <font class="ans">Wynchell</font> @ <a href="//www.petitcolas.net/steganography/mp3stego">MP3Stego</a> $ <code>decode song.mp3</code></li>
	</ul>

	<hr class="print-hidden">
	<li id="qn16" class="qn print-before"><u>Egg Coloring</u> (<a href="file/ps.hacking.hackyeaster.android.apk">mobile</a>)</li>
<pre class="wrap" style="padding:0 .5em;">
Egg coloring is fun!

Can you get the yellow egg?

<a href="ps://color"><button class="btn-dl">Start coloring</button></a>
</pre>
	<ul>
		<li class="dash">@ <code>ps.hacking.hackyeaster.android.ColorActivity</code></li>
		<li class="dash"><code>echo -n "ffff00" | openssl sha1 -hmac "eggsited"</code> (or @ <a href="//www.freeformatter.com/hmac-generator.html">//www.freeformatter.com/hmac-generator.html</a>)</li>
		<li><code>1da02c68080863fa302c20c3312371f4e365a5f9</code></li>
		<li class="ans">@ <a href="//hackyeaster.hacking-lab.com/hackyeaster/egg?key=eggsited&code=ffff00&hmac=1da02c68080863fa302c20c3312371f4e365a5f9">//hackyeaster.hacking-lab.com/hackyeaster/egg?key=eggsited&code=ffff00&hmac=1da02c68080863fa302c20c3312371f4e365a5f9</a></li>
	</ul>

	<hr class="print-hidden">
	<li id="qn17" class="qn print-before"><u>Bunny Hop</u></li>
<pre class="wrap" style="padding:0 .5em;">
Wannabe programming guru Hazel B. Easterwood created a new programming language called &quot;Bunny Hop&quot;. You suspect Hazel to have cheated, because the language looks very familiar to you.

Download the following code and complete it! It will yield the QR code for egg 17.

<a href="file/egg17.bunny"><button class="btn-dl">Download the code</button></a>
</pre>
	<ul>
		<li class="dash">1-1 mapping from <a href="//en.wikipedia.org/wiki/Logo_(programming_language)">Logo programming language</a>, replace:</li>
			<ul>
				<li>`hop` = `fd`</li>
				<li>`backhop` = `bk`</li>
			</ul>
		<li class="dash">missing subroutine: <code>egg</code></li>
<pre class="wrap"><code>to egg
	pd
	fd 1
	bk 1
	pu
end</code></pre>
		<li class="dash">online tool: <a href="//logo.twentygototen.org">//logo.twentygototen.org</a></li>
		<li><img src="img/egg17-qrcode.png"></li>
		<li class="dash">...in ASCII, becomes <u>egg17-qrcode.txt</u>:
<pre class="wrap"><code>xxxxxxx..x.....xx.xxxxxxx
x.....x.xx.xxxxxx.x.....x
x.xxx.x..xxx..xx..x.xxx.x
x.xxx.x.xx.x.xxx..x.xxx.x
x.xxx.x...x.xx.xx.x.xxx.x
x.....x.x.x..xxxx.x.....x
xxxxxxx.x.x.x.x.x.xxxxxxx
............x.xxx........
xxxxx.xxxxx.x.x..x.x.x.x.
.x.xxx...x...x.xx.xx.x...
.xx...x.xx.xx.xx..x....xx
xx.x.x.xxxxx..xx.xxx.x.xx
xxx...x.xx.x....xxxx..x..
x..x...x.xx.xx..xxxx.x.xx
x.x.x.x...x..xxxx.xxx.xxx
x..x...xx.x.xx.x.xxxx....
x...x.x.....x.x.xxxxxxxx.
........x.......x...xxx..
xxxxxxx.xx.xx...x.x.x.xxx
x.....x...xx..x.x...x...x
x.xxx.x.x.xx...xxxxxx.xxx
x.xxx.x.x...xxxxxxx.x..xx
x.xxx.x.x.x..xx....x.x..x
x.....x.xx..xx..x.xx....x
xxxxxxx.x...x.xx.x...x.xx</code></pre>
		<li class="dash"><pre class="wrap"><code>#!/usr/bin/env python
#-*- coding: utf-8 -*-

import sys
import codecs
from PIL import Image

sys.stdout = codecs.getwriter(&quot;utf8&quot;)(sys.stdout)
sys.stderr = codecs.getwriter(&quot;utf8&quot;)(sys.stderr)

if __name__ == &quot;__main__&quot;:
	w, h = 75, 75
	im = Image.new(&quot;RGBA&quot;, (w, h), &quot;white&quot;)
	pix = im.load()
	grid = []
	with codecs.open(&quot;egg17-qrcode.txt&quot;, &quot;r&quot;, &quot;utf-8&quot;) as f:
		for r, line in enumerate(f):
			line = line.strip()
			if not line: continue
			row = []
			for c, ch in enumerate(line):
				color = (0,0,0,255) if ch == &quot;x&quot; else (255,255,255,255)
				row.append(color)
			grid.append(row)
	for r in xrange(w):
		for c in xrange(h):
			pix[r,c] = grid[r/(w/25)][c/(h/25)]
	im.save(&quot;egg17-qrcode.png&quot;)</code></pre></li>
	</ul>

	<hr class="print-hidden">
	<li id="qn18" class="qn print-before"><u>Bug Hunter</u></li>
<pre class="wrap" style="padding:0 .5em;">
Lacking of time, you were not able not complete your DeggCryptor program. In an act of desperation, you instructed Sammy, the junior programmer, to implement the missing key generation function.

As always, Sammy miserably failed. Can you fix his code? It's the KeyGen class. Pay attention to the comments!

<a href="file/sourcecode.zip"><button class="btn-dl">Source Code</button></a>
</pre>
	<ul>
		<li class="dash">file listing:</li>
		<ul>
			<li class="default">DeggCryptor.sln</li>
			<li class="default">DeggCryptor/AesHelper.cs</li>
			<li class="default">DeggCryptor/App.config</li>
			<li class="default">DeggCryptor/DeggCryptor.csproj</li>
			<li class="default ans">DeggCryptor/KeyGen.cs</li>
			<li class="default ans">DeggCryptor/MainForm.cs</li>
			<li class="default">DeggCryptor/MainForm.Designer.cs</li>
			<li class="default">DeggCryptor/MainForm.resx</li>
			<li class="default">DeggCryptor/Program.cs</li>
			<li class="default">DeggCryptor/Properties/AssemblyInfo.cs</li>
			<li class="default">DeggCryptor/Properties/Resources.Designer.cs</li>
			<li class="default">DeggCryptor/Properties/Resources.resx</li>
			<li class="default">DeggCryptor/Properties/Settings.Designer.cs</li>
			<li class="default">DeggCryptor/Properties/Settings.settings</li>
			<li class="default">DeggCryptor/Resources/egg_gray.png</li>
		</ul>
		<li class="dash">@ <code>DeggCryptor/KeyGen.cs</code> (original commented + fixed)</li>
<pre class="wrap"><code>public static string generateKey()
{
	// Init the four seed values. 1111 and multiples of it.
	int h1 = /*0x*/1111;
	int h2 = /*0x*/2222;
	int h3 = /*0x*/3333;
	int h4 = /*0x*/4444;

	// Init variables.
	int a = h1;
	int b = h2;
	int c = h3;
	int d = h4;

	// 1k iterations.
	//for (int i = 1; i &lt; 1000; i++)
	for (int i = 0; i &lt; 1000; i++)
	{
		// If c is greater than d, double c and d.
		// if (c &gt; d)
		// 	c *= 2;
		// 	d *= 2;
		if (c &gt; d) {
			c *= 2;
			d *= 2;
		}

		// Calculate new values.
		// a: Take sum of a and b, and c and d. Then, multiply the two values.
		// a = a + b * c + d;
		a = (a + b) * (c + d);

		// b: multiply with 3. Using two additions instead of multiplying -&gt; performance booooost!
		// b = b + b;
		// b = b + b;
		b *= 3;

		// c, d: Swap c and d
		// c = d;
		// d = c;
		int tmp = c;
		c = d;
		d = tmp;

		// Take last four digits (modulo 10000)
		a %= 10000;
		b %= 10000;
		c %= 10000;
		// d %= 100000;
		d %= 10000;
	}
	// Password: a,b,c and d with &quot;X&quot; in between
	return a + &quot;X&quot; + b + &quot;X&quot; + c + &quot;X&quot; + d;
}</code></pre>
		<li class="dash">key = 5792X2222X9104X5472</li>
<!--
#!/usr/bin/env python
#-*- coding: utf-8 -*-

import sys

if __name__ == "__main__":
	h1 = 1111
	h2 = 2222
	h3 = 3333
	h4 = 4444
	a = h1
	b = h2
	c = h3
	d = h4
	for _ in xrange(1000):
		if c > d:
			c = c+c
			d = d+d
		a = (a+b)*(c+d)
		b = b+b+b
		c, d = d, c
		a %= 10000
		b %= 10000
		c %= 10000
		d %= 10000
	print "X".join(map(str, [a,b,c,d]))
	# 5792X2222X9104X5472
-->
	<li class="dash"><code>encryptedEgg</code> @ <code>DeggCryptor/MainForm.cs</code></li>
	<!-- mcs -pkg:dotnet /reference:System.Drawing.dll MainForm.cs KeyGen.cs AesHelper.cs -->
<pre class="wrap"><code>public void egg18() {
	string key = KeyGen.generateKey();
	System.IO.MemoryStream streamBitmap = new System.IO.MemoryStream(
		AesHelper.Decrypt(Convert.FromBase64String(encryptedEgg), key)
	);
	Bitmap bitImage = new Bitmap((Bitmap)Image.FromStream(streamBitmap));
	String outputFilename = &quot;egg18.png&quot;;
	bitImage.Save(outputFilename);
	Console.WriteLine(&quot;=&gt; &quot;+outputFilename);
}</code></pre>
	</ul>

	<hr class="print-hidden">
	<li id="qn19" class="qn print-before"><u>Assemble This!</u></li>
<pre class="wrap" style="padding:0 .5em;">
In this challenge you must crack a server-side program. Lucky for you, you got the assembly file of the program. First, reverse-engineer the program and find a valid code! Then, submit the code to the server.

The server is located at:
<u>hackyeaster.hacking-lab.com:1234</u>

Important: Do not launch brute-force attacks on the server - you'll not be lucky with it!

<a href="file/assembly.txt"><button class="btn-dl">Download assembly file</button></a>
</pre>
	<ul>
		<li class="dash">used <a href="//www.hopperapp.com">Hopper</a> &amp; <a href="//www.hex-rays.com/products/ida/index.shtml">IDE Pro v6.6</a></li>
		<li class="dash">code not obfuscated; just highly optimised</li>
		<li class="dash">first few lines == preamble (gnu asm)</li>
		<li class="dash">can strip all lines beginning with `.cfi_*`~instrumentation, and `.p2align*`~alignment</li>
		<li class="dash">followed by `const` str</li>
		<li class="dash">then `main` subroutine</li>
		<ol>
			<li>initial <code>fgets()</code> from `stdin` of 20 chars</li>
			<li>first main code block == optimised <code>strlen()</code></li>
			<ul>
				<li class="dash">[chk]: 16 &lt; <code>strlen</code>(usr input str) ≤ 20 char (<code>cmp rdx, 16; jbe .L2</code>)</li>
				<li class="dash">incl. bit-twiddling hack</li>
				<li class="dash">[ref]: C-like pseudocode</li>
<pre class="wrap"><code>v3 = &amp;v19;
do
{
	v4 = *(_DWORD *)v3;
	v3 += 4;
	// @ <a href="//graphics.stanford.edu/~seander/bithacks.html">//graphics.stanford.edu/~seander/bithacks.html</a>
	// #define haszero(v) (((v) - 0x01010101UL) &amp; ~(v) &amp; 0x80808080UL)
	v5 = ~v4 &amp; (v4 - 16843009) &amp; 0x80808080; //16843009=0x1010101
}
while (!v5);
if (!(~v4 &amp; (v4 - 16843009) &amp; 0x8080))
	LOBYTE(v5) = v5 &gt;&gt; 16;
if (!(~v4 &amp; (v4 - 16843009) &amp; 0x8080))
	v3 += 2;</code></pre>
				<li class="dash">compare with @ <a href="//security.cs.pub.ro/hexcellents/wiki/writeups/pctf2014_bronies1">//security.cs.pub.ro/hexcellents/wiki/writeups/pctf2014_bronies1</a>, esp. magic `const` like <code>0x1010101</code></li>
			</ul>
			<li>infinite `while` loop containing main components:-</li>
			<ul>
				<li class="default">one if-check</li>
				<li class="default">one sort of if-else check</li>
				<li class="default">a bunch of expr stmts with the same fmt/patt, involving `shr` i.e. `>>31`, followed by `>>24`</li>
				<li class="default">another if-check that might `break` out of the loop</li>
				<li class="default">two more code sections</li>
			</ul>
<pre class="wrap"><code>v6 = v19;
v12 = v19;
v7 = 0; //&#39;\0&#39;;
v8 = 0;
v9 = 0;
v10 = 0;
v11 = 0;
while ( 1 )
{
	if ( v8 == 3 * (v8 / 3) ) // i.e. v8 % 3 == 0
		v10 += v6;

	v13 = v9 + v6;
	if ( (v8 &amp; 3) == 2 ) // i.e. (v8-2) % 4 == 0
		v9 = v13; // v9 += v6

	++v8; // v8:idx

	// 8-bit ASCII value
	v14 = (unsigned __int8)(((unsigned int)(v12 &gt;&gt; 31) &gt;&gt; 24) + v12) - ((unsigned int)(v12 &gt;&gt; 31) &gt;&gt; 24);
	v15 = (unsigned __int8)(v11 + ((unsigned int)(v11 &gt;&gt; 31) &gt;&gt; 24)) - ((unsigned int)(v11 &gt;&gt; 31) &gt;&gt; 24);
	v10 = (unsigned __int8)(((unsigned int)(v10 &gt;&gt; 31) &gt;&gt; 24) + v10) - ((unsigned int)(v10 &gt;&gt; 31) &gt;&gt; 24);
	v9 = (unsigned __int8)(((unsigned int)(v9 &gt;&gt; 31) &gt;&gt; 24) + v9) - ((unsigned int)(v9 &gt;&gt; 31) &gt;&gt; 24);

	if ( v8 == 16 ) // last char: idx 0-16; total len == 17
		break;

	// v7 = ptr to the curr pos into input str
	// v6 holds actual value
	// so, this line basically means: save, to v6, actual value stored @ addr v7
	v6 = *(_BYTE *)v7;

	v12 = v14 + v6; // no if-check here

	v11 = v15 + v6; // odd pos: v11=v15+v6;
	if ( !(v8 &amp; 1) ) // i.e. v8 even
		v11 = v15; // even pos: v11=v15

	++v7;
}</code></pre>
			<ul>
				<li class="default">notice loop termination/exit condition <code>v8 == 16</code>, and increment statement <code>++v8;</code></li>
				<li>=&gt; `v8`: loop counter variable</li>
				<li class="default">some sort of char chk by pos idx into usr input str happening</li>
				<li class="default">also another loop counter variable `v7` in the bottom half of the loop (hint: <code>++v7;</code>), although this won't terminate the loop</li>
				<li class="default">notice `v7` &quot;lags&quot; behind `v8` by one</li>
				<li class="default"><code>v6 = *(_BYTE *)v7;</code> means `v6` == ASCII value corresponding to the char @ index `v7`</li>
				<li class="default">lines of the form <code>v14 = (unsigned __int8)(((unsigned int)(v12 &gt;&gt; 31) &gt;&gt; 24) + v12) - ((unsigned int)(v12 &gt;&gt; 31) &gt;&gt; 24);</code> convert a char to its equivalent 7-bit ASCII value</li>
				<li class="default"><code>unsigned __int8</code>: 8-bit type-cast (i.e. range 0-255) => %256</li>
				<li class="default">first if-check involving magic constant <code>0x55555556</code> ~ fancy way of division by 3<br/>@ <a href="//stackoverflow.com/questions/25782270/is-this-how-a-compiler-divides-just-by-using-bit-wise-operations">//stackoverflow.com/questions/25782270/is-this-how-a-compiler-divides-just-by-using-bit-wise-operations</a></li>
			</ul>
			<li>final condition: <code>v14 == 133 &amp;&amp; v15 == 67 &amp;&amp; v10 == 79 &amp;&amp; v9 == 176</code></li>
			<ul>
				<li class="default">pseudocode: <code>if(success) {print flag in secret.txt} else {print failure message "nope" (with a little `usleep()` distraction)}</code></li>
			</ul>
		</ol>
		<li class="dash">instrumented asm</li>
		<ul>
			<li class="default">added `const` str: <code>.LC1-5</code></li>
			<ul>
				<li class="default">with corresponding `jmp`s</li>
			</ul>
			<li class="default">split individual terms of final condition</li>
			<li class="default">added &quot;discriminator&quot;</li>
			<ul>
				<li class="default">cycling through ASCII range 1-127 for each term</li>
				<li class="default">except null terminator byte '\0', and line feed '\n'</li>
			</ul>
			<li class="default">e.g. <code>v9 == 176</code>:</li>
<pre class="wrap"><code>&#8230;
cmp     esi, 176 # v9~esi
jb      .LL # <
jl      .LL
je      .LE # ==
ja      .LG # >
jg      .LG
jne     .L2 # !=
jmp     .L35 # catch-all jmp
&#x2026;</code></pre>
		</ul>
<pre class="wrap"><code>	.intel_syntax noprefix
	.section .rodata.str1.1,&quot;aMS&quot;,@progbits,1
.LC1:
	.string &quot;yep &acirc;&#156;&#147;&quot;
.LC2:
	.string &quot;nope &acirc;&#156;&#151;&quot;
.LC3:
	.string &quot;&lt;&quot;
.LC4:
	.string &quot;==&quot;
.LC5:
	.string &quot;&gt;&quot;

	.section .text.startup,&quot;ax&quot;,@progbits
	.globl  main
	.type   main, @function
main:
	push    rbx
	sub     rsp, 32

	mov     esi, 20
	mov     rdx, QWORD PTR stdin[rip]
	mov     rdi, rsp
	mov     rbx, rsp
	call    fgets #fgets(input, 20, stdin)
	test    rax, rax
	je      .L2

	mov     rdx, rsp
.L3:
	# 0x4004f8
	mov     ecx, DWORD PTR [rdx]
	add     rdx, 4

	# @ <a href="//bits.stephan-brumme.com/null.cpp">//bits.stephan-brumme.com/null.cpp</a>
	lea     eax, [rcx-16843009] #v3-0x01010101
	not     ecx
	and     eax, ecx
	and     eax, -2139062144 #0x80808080
	je      .L3

	mov     ecx, eax
	shr     ecx, 16 #&gt;&gt;16
	test    eax, 32896 #0x8080
	cmove   eax, ecx
	lea     rcx, [rdx+2]
	cmove   rdx, rcx
	add     al, al
	sbb     rdx, 3
	sub     rdx, rbx
	cmp     rdx, 16 #0x10
	jbe     .L2

	# 16 &lt; input str len &lt;= 20 #

	# 0x400537
	#mov     bx, 0C3EEh  ;Sign bit of bl is now 1: BH == 1100 0011, BL == 1110 1110
	#movsx   ebx, bx     ;Load signed 16-bit value into 32-bit register and sign-extend
	#                    ;EBX is now equal FFFFC3EEh
	movsx   r8d, BYTE PTR [rsp] #v7
	lea     r10, [rbx+1]
	xor     edi, edi #v8
	xor     esi, esi #v9
	xor     ecx, ecx #v10
	xor     ebx, ebx #v11
	mov     r11d, 1431655766 #0x55555556
	mov     r9d, r8d
	# 0x400551
	jmp     .L13

.L9:
	# 0x400553
	movsx   r8d, BYTE PTR [r10]
	lea     ebx, [rdx+r8]
	add     r9d, r8d
	test    dil, 1
	cmove   ebx, edx
	add     r10, 1

.L13:
	# 0x400569
	mov     eax, edi
	imul    r11d # 0x40056b
	mov     eax, edi
	sar     eax, 31 #0x1f

	sub     edx, eax
	lea     eax, [rcx+r8]
	lea     edx, [rdx+rdx*2]
	cmp     edi, edx

	cmove   ecx, eax
	mov     eax, edi #v8~edi
	add     r8d, esi
	and     eax, 3 #v8 &amp; 3
	cmp     eax, 2 #(v8&amp;3) == 2?

	mov     eax, r9d
	cmove   esi, r8d
	sar     eax, 31
	add     edi, 1
	shr     eax, 24 #0x18
	add     r9d, eax
	movzx   r9d, r9b #sign-extend w/ 0
	sub     r9d, eax

	mov     eax, ebx
	sar     eax, 31
	shr     eax, 24
	lea     edx, [rbx+rax]
	movzx   edx, dl
	sub     edx, eax

	mov     eax, ecx
	sar     eax, 31
	shr     eax, 24
	add     ecx, eax
	movzx   ecx, cl
	sub     ecx, eax

	mov     eax, esi
	sar     eax, 31
	shr     eax, 24
	add     esi, eax
	movzx   esi, sil
	sub     esi, eax

	cmp     edi, 16  #edi == 16 (0x10)?
	jne     .L9

	# cmp     esi, 176
	# jb      .LL
	# jl      .LL
	# je      .LE
	# ja      .LG
	# jg      .LG
	# jne     .L2
	# jmp     .L35

	# v14 == 133 &amp;&amp; v15 == 67 &amp;&amp; v10 == 79 &amp;&amp; v9 == 176 #
	cmp     ecx, 79  #v10~ecx
	jne     .L2
	cmp     esi, 176 #v9~esi
	jne     .L2
	cmp     r9d, 133 #v14~r9d
	jne     .L2
	cmp     edx, 67  #v15~edx
	jne     .L2
	jmp     .L35

.LL: #&lt;
	mov     edi, OFFSET FLAT:.LC3
	call    puts
	jmp     .LX
.LE: #==
	mov     edi, OFFSET FLAT:.LC4
	call    puts
	jmp     .LX
.LG: #&gt;
	mov     edi, OFFSET FLAT:.LC5
	call    puts
	jmp     .LX

.L2: #nope
	mov     edi, OFFSET FLAT:.LC2
	call    puts
	jmp     .LX
.L35: #yep
	mov     edi, OFFSET FLAT:.LC1
	call    puts
	jmp     .LX

.LX: #cleanup
	add     rsp, 32
	pop     rbx
	ret</code></pre>
		<li>[USAGE]: <code>rm -f egg19; gcc -c egg19.S -o egg19.o && gcc egg19.o -o egg19; for i in {1..255}; do echo -n "$i: "; python -c "import sys; sys.stdout.write(hex($i)+' ')"; python -c "import sys; sys.stdout.write(''.join(map(chr,[0x2c if (i-2)%4==0 else (${i} if i%2==0 else p) for i,p in enumerate(xrange(91,108))])))" | ./egg19; done</code></li>
		<li class="dash">which char pos idx in str is incl. in which term(s) of the final condition?</li>
<pre class="wrap"><code>for i in xrange(0,17):
	xs = []
	if i%3==0: xs.append(1)
	if (i&amp;3)==2: xs.append(2)
	if i&lt;16:
		xs.append(3)
		if i%2==1: xs.append(4)
	print str(i)+&quot;:&quot;, &quot; &quot;.join(map(str,xs))</code></pre>
		<li class="dash">validate proposed solution:</li>
<pre class="wrap"><code>xs = [49, 24, 44, 52, 25, 32, 44, 34, 19, 84, 44, 21, 53, 23, 44, 53, 21]
f1 = sum(map(int, [p for i,p in enumerate(xs) if i%3==0]))%256
f2 = sum(map(int, [p for i,p in enumerate(xs) if (i&amp;3)==2]))%256
f3 = sum(map(int, [p for i,p in enumerate(xs[:16])]))%256
f4 = sum(map(int, [p for i,p in enumerate(xs[:16]) if i%2==1]))%256
print (f1, f2, f3, f4), (79, 176, 133, 67), (f1, f2, f3, f4)==(79, 176, 133, 67)</code></pre>
		<li class="dash">exploit to profit</li>
<pre class="wrap"><code>#!/usr/env/env python
#-*- coding: utf-8 -*-

import sys
from pwn import *

data = &quot;&quot;.join(map(chr, [49, 24, 44, 52, 25, 32, 44, 34, 19, 84, 44, 21, 53, 23, 44, 53, 21]))
conn = remote(&quot;hackyeaster.hacking-lab.com&quot;, 1234)
conn.sendline(data)
print conn.recvall()
conn.close()</code></pre></li>
<!--
# @ http://pwntools.readthedocs.org/en/latest/tubes/processes.html
# p = process("cat /dev/zero | head -c8", shell=True, stderr=open("/dev/null", "w+"))
# p = process(["python","-c","import os; print os.read(2,1024)"], preexec_fn = lambda: os.dup2(0,2))
def local():
	proc = process([which("gcc"), "-c", "egg19.S", "-o", "egg19.o"])
	proc.wait_for_close()
	proc = process([which("gcc"), "egg19.o", "-o", "egg19"])
	proc.wait_for_close()
	proc = process("./egg19")
	proc.sendline(data)
	print proc.recvall()
	# proc.shutdown("send|recv")
	proc.wait_for_close()
	# proc.poll()
-->
		<li class="dash ans">ida.lo\/es.you</li>
	</ul>

	<hr class="print-hidden">
	<li id="qn20" class="qn print-before"><u>Humpty's Dump</u></li>
<pre class="wrap" style="padding:0 .5em;">
You got hold of a dump of Humpty Dumpty's secret egg database.

Search and extract the egg hidden in the dump!

<u>Hints</u>
• The `puzz` is not more than 8 chars, letters only.
• The decryption of the file can be done using AES_DECRYPT().

<a href="file/dump2.zip"><button class="btn-dl">Download the dump</button></a>
</pre>
	<ul>
		<li class="dash">`dump2.zip` contains:</li>
		<ul>
			<li class="default">humpty_fyle.sql</li>
			<li class="default">humpty_kee.sql</li>
			<li class="default">humpty_routines.sql</li>
			<li class="default">humpty_uzr.sql</li>
		</ul>
		<li class="dash"><code>docker run -p 3306:3306 --name mysql -e MYSQL_ROOT_PASSWORD=P@ssw0rd -d mysql:latest</code></li>
		<li><code>mysql&gt; CREATE DATABASE humpty;</code></li>
		<li><code>mysql&gt; SHOW TABLES;</code></li>
<pre class="wrap"><code>+------------------+
| Tables_in_humpty |
+------------------+
| fyle             |
| kee              |
| uzr              |
+------------------+</code></pre>
		<li><code>mysql&gt; DESCRIBE fyle;</code></li>
		<!-- mysql> SHOW CREATE TABLE fyle \G; -->
<pre class="wrap"><code>+-------+------------+------+-----+---------+-------+
| Field | Type       | Null | Key | Default | Extra |
+-------+------------+------+-----+---------+-------+
| id    | bigint(10) | NO   | PRI | NULL    |       |
| keeid | bigint(10) | NO   | MUL | NULL    |       |
| blahb | longblob   | YES  |     | NULL    |       |
+-------+------------+------+-----+---------+-------+</code></pre>
		<li><code>mysql&gt; SELECT id, keeid FROM fyle;</code></li>
<pre class="wrap"><code>+------+-------+
| id   | keeid |
+------+-------+
| 5182 |  1293 |
| 3475 |  1493 |
| 3492 |  2332 |
| 1374 |  4327 |
| 3481 |  7465 |
+------+-------+</code></pre>
		<li><code>mysql&gt; SELECT * FROM kee;</code></li>
<pre class="wrap"><code>+------+-------+------------------------------------------------------------------+
| id   | uzrid | kee                                                              |
+------+-------+------------------------------------------------------------------+
| 1293 |  1342 | 16B1917E3DC15E94D5956807F89874F0F90D2C778F1574F40E2DC75FA241CD15 |
| 1493 |  8944 | 8758597E209E6716877463D7605CB489DD0E62A61332CD022F5C07F5FD339A53 |
| 2332 |  3443 | 1ABF4B7CD25C61FDF0E74EC2BFB43BD1C2D8ECD803AFA3AA376F4C0000052813 |
| 4327 |  1875 | 4ED525F310E7A530D0BAA8FE3D54A5CF102D6AE8E9529289F664730FB248EF9A |
| 7465 |  5420 | A14EA5BDA9360D9E790B0935FFD21FA9B6BEBCDEAAFC8AADBD8A3A13643D5583 |
+------+-------+------------------------------------------------------------------+</code></pre>
		<li><code>mysql&gt; SELECT * FROM uzr;</code></li>
<pre class="wrap"><code>+------+--------+------------------------------------------+-------+
| id   | neighm | puzz                                     | sawlt |
+------+--------+------------------------------------------+-------+
| 1342 | stuart | de2278f5bcafcbb097ecc1fb54e5ab8a9e912c55 | efgh  |
| 1875 | beaver | 943f9ecbbd91306a561d0e3c15e18ee700007083 | abcd  |
| 3443 | chuck  | 0cf32f8f418659f23f8968d4f63ea5c98b39f833 | zyxw  |
| 5420 | yogo   | 1742ae4507fc480958e2437104e677e70aa5e857 | jklm  |
| 8944 | flint  | 915d253cb5ba6f0a220bca83e2d6d3258af15e68 | nmlk  |
+------+--------+------------------------------------------+-------+</code></pre>
		<li><code>mysql&gt; SELECT name FROM mysql.proc WHERE db=database() ORDER BY name;</code></li>
<pre class="wrap"><code>+-----------------+
| name            |
+-----------------+
| DeekryptKee     |
| GetPuzzMishMash |
| KryptKee        |
+-----------------+</code></pre>
		<li><code>mysql&gt; SHOW CREATE PROCEDURE DeekryptKee \G;</code></li>
<pre class="wrap"><code>PROCEDURE `DeekryptKee`(
    IN  p_puzz  VARCHAR(40),
    IN  p_cyfr  VARCHAR(64),
    OUT p_kee  VARCHAR(40)
)
BEGIN
    DECLARE p_tmp VARCHAR(64);
    DECLARE p_kountr INT;
    SET p_tmp := CONCAT(&#39;kee.&#39;, p_puzz, &#39;.kee&#39;);
    SET p_kountr := 1;
    WHILE p_kountr &lt;= 10000 DO
      SET p_tmp := SHA1(p_tmp);
      SET p_kountr := p_kountr + 1;
    END WHILE;
    SET p_tmp := AES_DECRYPT(UNHEX(p_cyfr), p_tmp);
    SELECT p_tmp INTO p_kee;
END</code></pre>
		<li><code>mysql&gt; SHOW CREATE PROCEDURE GetPuzzMishMash \G;</code></li>
<pre class="wrap"><code>PROCEDURE `GetPuzzMishMash`(
    IN  p_puzz      VARCHAR(40),
    IN  p_sawlt     VARCHAR(4),
    OUT p_mishmash  VARCHAR(40)
)
BEGIN
    DECLARE p_tmp VARCHAR(50);
    SET p_tmp := CONCAT(p_sawlt, &#39;.&#39;, p_puzz, &#39;.&#39;, p_sawlt);
    SELECT SHA1(p_tmp) INTO p_mishmash;
END</code></pre>
		<li><code>mysql&gt; SHOW CREATE PROCEDURE KryptKee \G;</code></li>
<pre class="wrap"><code>PROCEDURE `KryptKee`(
    IN  p_puzz  VARCHAR(40),
    IN  p_kee  VARCHAR(40),
    OUT p_cyfr   VARCHAR(64)
)
BEGIN
    DECLARE p_tmp VARCHAR(64);
    DECLARE p_kountr INT;
    SET p_tmp := CONCAT(&#39;kee.&#39;, p_puzz, &#39;.kee&#39;);
    SET p_kountr := 1;
    WHILE p_kountr &lt;= 10000 DO
      SET p_tmp := SHA1(p_tmp);
      SET p_kountr := p_kountr + 1;
    END WHILE;
    SET p_tmp := HEX(AES_ENCRYPT(p_kee, p_tmp));
    SELECT p_tmp INTO p_cyfr;
END</code></pre>
		<li class="dash"><code>cudaHashcat64.bin -m4900 -a3 hashfile.txt -1 ?l mask.txt</code></li>
		<li><u>hashfile.txt</u></li>
<pre class="wrap"><code>943f9ecbbd91306a561d0e3c15e18ee700007083:abcd
915d253cb5ba6f0a220bca83e2d6d3258af15e68:nmlk
1742ae4507fc480958e2437104e677e70aa5e857:jklm
0cf32f8f418659f23f8968d4f63ea5c98b39f833:zyxw (✓)
de2278f5bcafcbb097ecc1fb54e5ab8a9e912c55:efgh</code></pre>
		<li><u>mask.txt</u></li>
<pre class="wrap"><code>.?1?1?1?1?1?1?1?1.</code></pre>
		<li><code>mysql&gt; SELECT * FROM uzr WHERE id=3443;</code></li>
<pre class="wrap"><code>+------+--------+------------------------------------------+-------+
| id   | neighm | puzz                                     | sawlt |
+------+--------+------------------------------------------+-------+
| 3443 | chuck  | 0cf32f8f418659f23f8968d4f63ea5c98b39f833 | zyxw  |
+------+--------+------------------------------------------+-------+</code></pre>
		<li><code>SHA1(zyxw.snakeoil.zyxw) = 0cf32f8f418659f23f8968d4f63ea5c98b39f833</code></li>
		<li>...so <code>p_puzz = snakeoil</code></li>
		<li class="dash"><code>mysql&gt; SELECT * FROM kee WHERE uzrid=3443;</code></li>
<pre class="wrap"><code>+------+-------+------------------------------------------------------------------+
| id   | uzrid | kee                                                              |
+------+-------+------------------------------------------------------------------+
| 2332 |  3443 | 1ABF4B7CD25C61FDF0E74EC2BFB43BD1C2D8ECD803AFA3AA376F4C0000052813 |
+------+-------+------------------------------------------------------------------+</code></pre>
		<li><code>mysql&gt; SELECT id, keeid FROM fyle WHERE keeid=2332;</code></li>
<pre class="wrap"><code>+------+-------+
| id   | keeid |
+------+-------+
| 3492 |  2332 |
+------+-------+</code></pre>
		<li><pre class="wrap"><code>#!/usr/bin/env python
#-*- coding: utf-8 -*-

import sys
import pymysql
import pymysql.cursors

conn = pymysql.connect(
		host=&quot;localhost&quot;, port=3306,
		# unix_socket=&quot;/opt/local/var/run/mysql57/mysqld.sock&quot;,
		user=&quot;root&quot;,
		passwd=&quot;P@ssw0rd&quot;, password=&quot;P@ssw0rd&quot;,
		db=&quot;humpty&quot;,
		cursorclass=pymysql.cursors.DictCursor)

try:
	with conn.cursor() as cur:
		_id, uzrid = 2332, 3443
		sql = &quot;SELECT `kee` FROM `kee` WHERE `id`=%s AND `uzrid`=%s&quot;
		cur.execute(sql, (_id, uzrid,))
		kee = cur.fetchone()[&quot;kee&quot;]
 		# kee = 1ABF4B7CD25C61FDF0E74EC2BFB43BD1C2D8ECD803AFA3AA376F4C0000052813

 		# CALL DeekryptKee(&#39;snakeoil&#39;, &#39;1ABF4B7CD25C61FDF0E74EC2BFB43BD1C2D8ECD803AFA3AA376F4C0000052813&#39;, @p_kee); SELECT @p_kee;
 		sql = &quot;CALL DeekryptKee(%s, %s, @p_kee)&quot;
 		cur.execute(sql, (&quot;snakeoil&quot;, kee,))
 		sql = &quot;SELECT @p_kee&quot;
 		cur.execute(sql)
 		p_kee = cur.fetchone()[&quot;@p_kee&quot;]
		# p_kee = jpP8HeoEC5OCCBqdf9N3

		_id, keeid = 3492, 2332
		sql = &quot;SELECT AES_DECRYPT(`blahb`, %s) AS data FROM `fyle` WHERE `id`=%s and `keeid`=%s&quot;
		cur.execute(sql, (p_kee, _id, keeid,))
		fp = &quot;egg20.png&quot;
		with open(fp, &quot;wb&quot;) as f:
			f.write(cur.fetchone()[&quot;data&quot;])
		print&gt;&gt;sys.stderr, &quot;=&gt;&quot;, fp
finally: conn.close()</code></pre></li>
	</ul>

	<hr class="print-hidden">
	<li id="qn21" class="qn print-before"><u>Crypto Council</u></li>
<pre class="wrap" style="padding:0 .5em;">
Clever crypto brains had a little get-together. Find out who they are and break the riddles they created! Each plain text contains a password - once you've got them all, enter them in the Egg-O-Matic below. Lowercase only.

<img class="vmid no-border" src="img/head1.jpg" style="width:212px;height:270px">
DV D UXOH PHQ ZRUUB PRUH DERXW ZKDW WKHB FDQW VHH WKDQ DERXW ZKDW WKHB FDQ SDVVZRUG LV FDUWKDJR

<img class="vmid no-border" src="img/head2.jpg" style="width:212px;height:270px">
4423154215 2443 3334 52244433154343 4334 1442151114214531 3334 11131345431542 4334 4415424224123115 1143 442315 13343343132415331315 44231144 145215313143 2433 442315 2315114244 3421 1551154254 321133 3515313435343333154315 2443 442315 3511434352344214

<img class="vmid no-border" src="img/head3.jpg" style="width:212px;height:270px">
EHIIKT YFC FTEU QK PLTPWBY MQYTNVZW LAJ JGGN ZVLD A EWTAE WIEXLP QF IHV DAALROW DF JIACT GWMGCRQF WIJ NSIHVZ BTAE IJGAEOWS FFZ ZXM KW ZPVV I UAAJAARAC MVJCRBADN ZV HPRZA TAAZAW SE MQYTNVZW HTLLATD XZWTK RVV WESZWL UELWG AUZAPNLA LJREMTJS RVV YERV VDRRB SI TYM SVE FN SVE JMNTNKMWC HV MFIEIMV IHV LAELFUSIIT AWGVZKW PNU ZWBAZVWS TYMJT FFZ LWIIBQ NERZK UIMM QTAIA ACTF PAH CRZWTR YM SRCFUHPNZMV IHV NJTNTP WCVFG DDUZA SSHVUSG DV OJXGEIF IO KPW SIVB GU WFZEH AJ I BJNZWJ HETZWIAIG ZT EEBWGEU BZT SVZNXCV WX IHV LMZE FN FTVVZK PS YQK HETZWIAIG S EOJQLXOE PW WECL MCTZT LWE UMSIHJ WX IHV LMZE RVV WIJ AGC HV IDHO JMJKEU IK P SVKJTTRZQ IO YMFGY ZQA

<img class="vmid no-border" src="img/head4.jpg" style="width:212px;height:270px">
WEN XQWVIBQZ KGQEAL TWB WEH GKQCW QLTBAKBTU LKIQTME DWCOAKWZAKNB BKMETP WEW NOTHPA HWB GBXHCEWG IA OTTQPWD SEATWCWNBA NZW HTO BHQWG HIWAL MCMG LQWVIBQL TOF QLFVCHWG WEW XNW FM WET NGQEAL QWBDSCMF KO CPWCKWMAX
</pre>
	<ul>
		<li class="dash"><a href="//www.xarg.org/tools/caesar-cipher">Caesar Cipher</a>, key=23</li>
			<ul><li class="dash">as a rule men worry more about what they cant see than about what they can password is <font class="ans">carthago</font></li></ul>
		<li class="dash"><a href="//www.braingle.com/brainteasers/codes/polybius.php">Polybius Square</a></li>
			<ul><li class="dash">there is no witness so dreadful no accuser so terrible as the conscience that dwells in the heart of every man <font class="ans">peloponnese</font> is the password</li></ul>
		<li class="dash"><a href="//www.dcode.fr/vigenere-cipher">Vigenère Cipher</a>, key=paris</li>
			<ul><li class="dash">phrase you need is <font class="ans">alchemy</font> vigenere was born into a noble family in the village of saint pourcain his father jean arranged for him to have a classical education in paris blaise de vigenere studied greek and hebrew under adrianus turnebus and jean dorat at the age of age seventeen he entered the diplomatic service and remained there for thirty years five years into his career he accompanied the french envoy louis adhemar de grignan to the diet of worms as a junior secretary he entered the service of the duke of nevers as his secretary a position he held until the deaths of the duke and his son he also served as a secretary to henry iii</li></ul>
		<li class="dash"><a href="//bionsgadgets.appspot.com/ww_forms/playfair_ph_web_worker3.html">Playfair cipher</a>, key=ZUVXYTWHEACSONBKDFGIRLMPQ</li>
			<ul><li class="dash">the playfair cipher was the first practical digraph substitution cipher the scheme was invented by charles wheatstone but was named after lord playfair who promoted the use of the cipher password is <font class="ans">bletchley</font></li></ul>
	</ul>

	<hr class="print-hidden">
	<li id="qn22" class="qn print-before"><u>Dumpster Diving</u></li>
<pre class="wrap" style="padding:0 .5em;">
You've sniffed some password hashes of a web site:
	hash 1: fad202a6e094dd8f1d63da8bdf85b3ba099971d3
	hash 2: f71e1b0b9b3a57d864c2e9f7bd6dd90f66b5a7d6
	hash 3: 84c6bcb681b79b690b53f9f3a8ba24e1e970d348
	hash 4: 0d6bb0df8918168798ce6b770014aeb81ac6ce76

However, none of your tools succeeded in cracking the hashes. As a last resort, you inspected the dumpster of the software development company which created the web site. And indeed you found something: a paper with a part of the hash calculation code.

Can you crack the hashes now?

<img src="img/paper.png">
</pre>
	<ul>
		<li class="dash">standard SHA1 implementation, init with different const, i.e.</li>
		<ul>
			<li><code>h0 = <strike>0x67452301</strike> 0x10325476</code></li>
			<li><code>h1 = <strike>0xEFCDAB89</strike> 0x98BADCFE</code></li>
			<li><code>h2 = <strike>0x98BADCFE</strike> 0xEFCDAB89</code></li>
			<li><code>h3 = <strike>0x10325476</strike> 0x67452301</code></li>
			<li><code>h4 = <strike>0xC3D2E1F0</strike> 0x0F1E2D3C</code></li>
		</ul>
		<li class="dash"> @ <a href="//codereview.stackexchange.com/questions/37648/python-implementation-of-sha1">//codereview.stackexchange.com/questions/37648/python-implementation-of-sha1</a></li>
<pre class="wrap"><code>#!/usr/bin/env python
#-*- coding: utf-8 -*-

def sha1(data):
	bytes = &quot;&quot;

	h0 = 0x10325476
	h1 = 0x98BADCFE
	h2 = 0xEFCDAB89
	h3 = 0x67452301
	h4 = 0x0F1E2D3C

	for n in xrange(len(data)):
		bytes+=&quot;{0:08b}&quot;.format(ord(data[n]))
	bits = bytes+&quot;1&quot;
	pBits = bits
	while len(pBits)%512 != 448: pBits+=&quot;0&quot;
	pBits+=&quot;{0:064b}&quot;.format(len(bits)-1)
	def chunks(l, n):
		return [l[i:i+n] for i in xrange(0, len(l), n)]
	def rot_l(n, b):
		return ((n &lt;&lt; b) | (n &gt;&gt; (32 - b))) &amp; 0xffffffff
	for c in chunks(pBits, 512):
		words = chunks(c, 32)
		w = [0]*80
		for n in xrange(16):
			w[n] = int(words[n], 2)
		for i in xrange(16, 80):
			w[i] = rot_l((w[i-3] ^ w[i-8] ^ w[i-14] ^ w[i-16]), 1)
		a = h0
		b = h1
		c = h2
		d = h3
		e = h4
		for i in xrange(80):
			if 0 &lt;= i &lt;= 19:
				f = (b &amp; c) | ((~b) &amp; d)
				k = 0x5A827999
			elif 20 &lt;= i &lt;= 39:
				f = b ^ c ^ d
				k = 0x6ED9EBA1
			elif 40 &lt;= i &lt;= 59:
				f = (b &amp; c) | (b &amp; d) | (c &amp; d)
				k = 0x8F1BBCDC
			elif 60 &lt;= i &lt;= 79:
				f = b ^ c ^ d
				k = 0xCA62C1D6
			tmp = rot_l(a, 5) + f + e + k + w[i] &amp; 0xffffffff
			e = d
			d = c
			c = rot_l(b, 30)
			b = a
			a = tmp
		h0 = (h0+a) &amp; 0xffffffff
		h1 = (h1+b) &amp; 0xffffffff
		h2 = (h2+c) &amp; 0xffffffff
		h3 = (h3+d) &amp; 0xffffffff
		h4 = (h4+e) &amp; 0xffffffff
	return &quot;%08x%08x%08x%08x%08x&quot; %(h0,h1,h2,h3,h4)</code></pre>
		<li class="dash">bruteforce using this:</li>
		<ul>
			<li>fad202a6e094dd8f1d63da8bdf85b3ba099971d3: <font class="ans">zombie</font></li>
			<li>f71e1b0b9b3a57d864c2e9f7bd6dd90f66b5a7d6: <font class="ans">Denver1</font></li>
			<li>84c6bcb681b79b690b53f9f3a8ba24e1e970d348: <font class="ans">Placebo</font></li>
			<li>0d6bb0df8918168798ce6b770014aeb81ac6ce76: <font class="ans">SHADOWLAND</font></li>
		</ul>
	</ul>

	<hr class="print-hidden">
	<li id="qn23" class="qn print-before"><u>Heizohack</u></li>
<pre class="wrap" style="padding:0 .5em;">
Can you crack the Heizohack?

The password for the Egg-O-Matic is hidden in the image.

<img src="img/heizohack.bmp">
</pre>
	<ul>
		<li class="dash">LSB steganography</li>
<pre class="wrap"><code>#!/usr/bin/env python
#-*- coding: utf-8 -*-

import sys
from PIL import Image

bin_n = lambda x, n: format(x, &quot;b&quot;).zfill(n)

img = Image.open(&quot;<a href="img/heizohack.bmp">heizohack.bmp</a>&quot;)
pix = img.convert(&quot;RGBA&quot;).load()
w, h = img.size

pw, lsb = [], 7
for y in xrange(h):
	for x in xrange(w):
		r = bin_n(pix[x,y][0], 8)
		g = bin_n(pix[x,y][1], 8)
		b = bin_n(pix[x,y][2], 8)
		b = bin_n(pix[x,y][2], 8)
		pw.append(r[lsb])
		pw.append(g[lsb])
		pw.append(b[lsb])
mac = &quot;&quot;.join(pw)
print &quot;&quot;.join(chr(int(mac[i:i+8],2)) for i in xrange(0,len(mac),8))</code></pre>
		<li class="dash">produces:</li>
		<li><img src="img/egg23-heizohack-hidden.png"></li>
		<li class="dash">follow as instructed:</li>
<pre class="wrap"><code>#!/usr/bin/env python
#-*- coding: utf-8 -*-

import sys
from PIL import Image

bin_n = lambda x, n: format(x, &quot;b&quot;).zfill(n)

img = Image.open(&quot;<a href="img/egg23-heizohack-hidden.png">heizohack.png</a>&quot;)
pix = img.convert(&quot;RGBA&quot;).load()
w, h = img.size

pw, lsb = [], 7
for y in xrange(h):
	for x in xrange(w):
		r = bin_n(pix[x,y][0], 8)
		g = bin_n(pix[x,y][1], 8)
		b = bin_n(pix[x,y][2], 8)
		a = bin_n(pix[x,y][3], 8)
		if int(r[lsb]) ^ int(g[lsb]) ^ int(b[lsb]) ^ int(a[lsb]) == 1:
			pw.append(r[lsb])
mac = &quot;&quot;.join(pw)
print &quot;&quot;.join(chr(int(mac[i:i+8],2)) for i in xrange(0,len(mac),8))</code></pre>
		<li class="dash ans">lostinthewoooods</li>
	</ul>

	<hr class="print-hidden">
	<li id="qn24" class="qn print-before"><u>crunch.ly</u></li>
<pre class="wrap" style="padding:0 .5em;">
Do you know <i>crunch.ly</i>, the fancy new URL shortener? It was used to create a short URL for Hacky Easter. In order to lure people onto the web site of your alternative hacking competition "Evil Easter", you decide to attack this service.

What you know
• Short URL for Hacky Easter: <u>http://crunch.ly/IU66SMI</u>
• Web site of crunch.ly (not a real domain!): <a href="file/crunchly/crunchly.html">OPEN WEB SITE</a>
• Algorithms used on the web site: <a href="file/crunchly.txt">DOWNLOAD</a>

Your mission
1. find a URL <u>starting with http://evileaster.com</u>, which produces the same short URL
2. make the web site store your URL, instead of the original URL
3. open the short URL on the web site
4. do not bomb or DoS the server - you'll have no luck with it; cracking must happen offline
</pre>
	<ol>
		<li class="dash">possible URLs (pick any one):</li>
		<ul>
			<li><a href="http://evileaster.comaicqrnq">http://evileaster.comaicqrnq</a></li>
			<li><a href="http://evileaster.com/elL12H">http://evileaster.com/elL12H</a></li>
			<li><a href="http://evileaster.com/fUmtEX">http://evileaster.com/fUmtEX</a></li>
			<li><a href="http://evileaster.com/jhSuHe">http://evileaster.com/jhSuHe</a></li>
			<li><a href="http://evileaster.com/jKb8ih">http://evileaster.com/jKb8ih</a></li>
			<li><a href="http://evileaster.com/kUIg0v">http://evileaster.com/kUIg0v</a></li>
			<li><a href="http://evileaster.com/lYaPB3">http://evileaster.com/lYaPB3</a></li>
			<li><a href="http://evileaster.com/nAZ0N7">http://evileaster.com/nAZ0N7</a></li>
			<li><a href="http://evileaster.com/obH8dK">http://evileaster.com/obH8dK</a></li>
			<li><a href="http://evileaster.com/oLamSw">http://evileaster.com/oLamSw</a></li>
			<li><a href="http://evileaster.com/sSDFrt">http://evileaster.com/sSDFrt</a></li>
			<li><a href="http://evileaster.com/uYXR9o">http://evileaster.com/uYXR9o</a></li>
		</ul>
<pre class="wrap"><code>import java.io.*;
import java.lang.*;
import java.net.*;
import java.security.*;

import javax.crypto.*;
import javax.crypto.spec.*;

// @ <a href="//commons.apache.org/proper/commons-codec/download_codec.cgi">//commons.apache.org/proper/commons-codec/download_codec.cgi</a>
import org.apache.commons.codec.binary.*;

public class Crunchly {
	public void run() {
		bruteForceShortUrl(&quot;&quot;, 6, &quot;IU66SMI&quot;);
	}

	public static void main(String[] args) throws Exception {
		new Crunchly().run();
	}

	public void bruteForceShortUrl(String str, int maxlen, String match) {
		String charset = &quot;abcdefghijklmnopqrstuvwxyz&quot;+&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;+&quot;0123456789&quot;;//+&quot;/&quot;;
		if (str.length() &gt;= maxlen) {
			// base case
			String strUrl = &quot;http://evileaster.com/&quot;+str;
			String shortUrl = calculateShortUrl(strUrl);
			String matchUrl = &quot;http://crunch.ly/&quot;+match;
			if (shortUrl.equals(matchUrl)) {
				System.out.println(&quot;[done]: &quot;+strUrl);
				System.exit(0);
			}
			return;
		}

		// recursive case
		for (int i=0; i&lt;charset.length(); i++) {
			bruteForceShortUrl(str+charset.charAt(i), maxlen, match);
		}
	}

	// given code //
	private String calculateShortUrl(String url) {
		try {
			MessageDigest md = MessageDigest.getInstance(&quot;SHA-256&quot;);
			md.update(url.getBytes(&quot;UTF-8&quot;));
			byte[] hash = md.digest();
			byte[] part = new byte[4];
			System.arraycopy(hash, 0, part, 0, 4);
			String b32 = new String(new Base32().encode(part), &quot;UTF-8&quot;);
			b32 = b32.replaceAll(&quot;=&quot;, &quot;&quot;);
			return &quot;http://crunch.ly/&quot; + b32;
		} catch (Exception e) {
			e.printStackTrace();
		}
		return null;
	}
}</code></pre>
	</ol>
	<ul>
		<li class="dash">key: tKguF</li>
<pre class="wrap"><code>import java.io.*;
import java.lang.*;
import java.net.*;
import java.security.*;

import javax.crypto.*;
import javax.crypto.spec.*;

// @ <a href="//commons.apache.org/proper/commons-codec/download_codec.cgi">//commons.apache.org/proper/commons-codec/download_codec.cgi</a>
import org.apache.commons.codec.binary.*;

public class Crunchly {
	public void run() {
		// String keyFull = &quot;x&quot;+key+key+key; //128-bit
		// 128 bits = 16 bytes
		// "x" + key*3 = 16 chars
		// => key = 5 chars
		bruteForceKey(&quot;&quot;, 5);
	}

	public static void main(String[] args) throws Exception {
		new Crunchly().run();
	}

	public void bruteForceKey(String str, int maxlen) {
		String charset = &quot;abcdefghijklmnopqrstuvwxyz&quot;+&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;;
		if (str.length() &gt;= maxlen) {
			// base case: known testcase //
			String url = &quot;http://.&quot;;
			String shortUrl = &quot;http://crunch.ly/FN2ERFA&quot;;
			String tixActual = cryptTicket(url, shortUrl, str);
			String tixExpected = &quot;CNgdmr+C40sYmW2e07VycSsEbwDEteBwV5Da6/ERCySirkDHktUMZ7Ky+utNUkAk&quot;;
			if (tixActual.equals(tixExpected)) {
				System.out.println(&quot;[done]: &quot;+str);
				System.exit(0);
			}
			return;
		}

		// recursive case
		for (int i=0; i&lt;charset.length(); i++) {
			bruteForceKey(str+charset.charAt(i), maxlen);
		}
	}

	// given code //
	private static final String IV = &quot;hackyeasterisfun&quot;;
	private String cryptTicket(String url, String shortUrl, String key) {
		String keyFull = &quot;x&quot;+key+key+key; //128-bit
		try {
			Cipher cipher = Cipher.getInstance(&quot;AES/CBC/PKCS5Padding&quot;);
			SecretKeySpec keySpec = new SecretKeySpec(keyFull.getBytes(&quot;UTF-8&quot;), &quot;AES&quot;);
			cipher.init(Cipher.ENCRYPT_MODE, keySpec, new IvParameterSpec(IV.getBytes(&quot;UTF-8&quot;)));
			String plain = new String(Base64.encodeBase64(url.getBytes(&quot;UTF-8&quot;)), &quot;UTF-8&quot;);
			plain += &quot;@&quot; + new String(Base64.encodeBase64(shortUrl.getBytes(&quot;UTF-8&quot;)), &quot;UTF-8&quot;);
			byte[] crypted = cipher.doFinal(plain.getBytes(&quot;UTF-8&quot;));
			return Base64.encodeBase64String(crypted);
		} catch (Exception e) {
			e.printStackTrace();
		}
		return null;
	}
}</code></pre>
		<li class="dash"><code>curl -c cookies.txt -sL &quot;http://hackyeaster.hacking-lab.com/hackyeaster/crunch?service=save&amp;ticket=Hgo3UsPWbH%2B4kkfQwZ0dOAbQzQy7HXmhCcwLzE4m%2F06I3E5d4Zl2LJ7hLXVuOe6USoykVYjijBkc8Rv%2FtMXnJHkU66WiET3AEwka8zz%2BV%2Fs%3D&quot; &amp;&amp; curl -b cookies.txt -sL &quot;http://hackyeaster.hacking-lab.com/hackyeaster/crunch?service=go&amp;shorturl=http%3A%2F%2Fcrunch.ly%2FIU66SMI&quot;</code></li>
<pre class="wrap"><code>import java.io.*;
import java.lang.*;
import java.net.*;
import java.security.*;

import javax.crypto.*;
import javax.crypto.spec.*;

// @ <a href="//commons.apache.org/proper/commons-codec/download_codec.cgi">//commons.apache.org/proper/commons-codec/download_codec.cgi</a>
import org.apache.commons.codec.binary.*;

public class Crunchly {
	public void run() {
		String url = &quot;http://evileaster.com/elL12H&quot;;
		String shortUrl = &quot;http://crunch.ly/IU66SMI&quot;;

		String key = &quot;tKguF&quot;;

		String tix = cryptTicket(url, shortUrl, key);
		// Hgo3UsPWbH+4kkfQwZ0dOAbQzQy7HXmhCcwLzE4m/06I3E5d4Zl2LJ7hLXVuOe6USoykVYjijBkc8Rv/tMXnJHkU66WiET3AEwka8zz+V/s=

		String svcUrl = &quot;http://hackyeaster.hacking-lab.com/hackyeaster/crunch&quot;;
		// service=check: url=&lt;shortUrl&gt;
		// service=go: shorturl=&lt;shortUrl&gt;
		// service=save: ticket=&lt;tix&gt;

		try {
			String charset = java.nio.charset.StandardCharsets.UTF_8.name();

			String q = String.format(&quot;service=%s&amp;ticket=%s&quot;,
				URLEncoder.encode(&quot;save&quot;, charset),
				URLEncoder.encode(tix, charset));
			URLConnection conn = new URL(svcUrl+&quot;?&quot;+q).openConnection();
			conn.setRequestProperty(&quot;Accept-Charset&quot;, charset);

			String hdr = null;
			String cookie = null;
			for (int i=1; (hdr=conn.getHeaderFieldKey(i))!=null; i++) {
				if (hdr.equals(&quot;Set-Cookie&quot;)) {
					if (cookie == null) {
						cookie = conn.getHeaderField(i);
						cookie = cookie.substring(0, cookie.indexOf(&quot;;&quot;));
					}
				}
			}

			q = String.format(&quot;service=%s&amp;shorturl=%s&quot;,
				URLEncoder.encode(&quot;go&quot;, charset),
				URLEncoder.encode(shortUrl, charset));
			conn = new URL(svcUrl+&quot;?&quot;+q).openConnection();
			conn.setRequestProperty(&quot;Accept-Charset&quot;, charset);
			conn.setRequestProperty(&quot;Cookie&quot;, cookie);

			InputStream resp = conn.getInputStream();
			try (BufferedReader rdr = new BufferedReader(
				new InputStreamReader(resp, charset)
			)) {
				for (String line; (line=rdr.readLine())!=null;) {
					System.err.println(URLDecoder.decode(line, charset));
				}
			}
		} catch (IOException ex) {}
	}

	public static void main(String[] args) throws Exception {
		new Crunchly().run();
	}

	// given code //
	private static final String IV = &quot;hackyeasterisfun&quot;;
	private String cryptTicket(String url, String shortUrl, String key) {
		String keyFull = &quot;x&quot;+key+key+key; //128-bit
		try {
			Cipher cipher = Cipher.getInstance(&quot;AES/CBC/PKCS5Padding&quot;);
			SecretKeySpec keySpec = new SecretKeySpec(keyFull.getBytes(&quot;UTF-8&quot;), &quot;AES&quot;);
			cipher.init(Cipher.ENCRYPT_MODE, keySpec, new IvParameterSpec(IV.getBytes(&quot;UTF-8&quot;)));
			String plain = new String(Base64.encodeBase64(url.getBytes(&quot;UTF-8&quot;)), &quot;UTF-8&quot;);
			plain += &quot;@&quot; + new String(Base64.encodeBase64(shortUrl.getBytes(&quot;UTF-8&quot;)), &quot;UTF-8&quot;);
			byte[] crypted = cipher.doFinal(plain.getBytes(&quot;UTF-8&quot;));
			return Base64.encodeBase64String(crypted);
		} catch (Exception e) {
			e.printStackTrace();
		}
		return null;
	}
}</code></pre>
		<li class="ans">@ <a href="//hackyeaster.hacking-lab.com/hackyeaster/images/egg24_bHIrQh1VR141TPmapETM.png">//hackyeaster.hacking-lab.com/hackyeaster/images/egg24_bHIrQh1VR141TPmapETM.png</a></li>
	</ul>
</ul>

<br clear="both">
<div class="print-before"><img src="2016HE.png"></div>

<style type="text/css">
	#eggs {line-height:1.75em;font-size:13pt;}
	#eggs .eggImage{margin:-15px -30px;width:240px;height:240px;background-size:240px 240px;display:inline-block;}
	#eggs .easyEgg{background-image:url("img/egg_easy.png");}
	#eggs .mediumEgg{background-image:url("img/egg_medium.png");}
	#eggs .hardEgg{background-image:url("img/egg_hard.png");}
	#eggs .eggTitle,#eggs .eggQR{text-align:center;position:relative;width:100%;display:inline-block;}
	#eggs .eggTitle{top:50px;font-family:"Source Sans Pro";font-size:3.5em;font-weight:bold;color:#000;}
	#eggs .eggQR{top:64px;}
</style>
<div id="eggs" class="print-before" style="border:1px dashed #000;"></div>

<center class="print-hidden">--- <strong>FIN</strong> ---</center>
</div></div></div>
<script type="text/javascript" src="/js/jquery-1.12.4.min.js"></script>
<script type="text/javascript" src="/js/jquery.qrcode.min.js"></script>
<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.4.0/highlight.min.js"></script>
<script type="text/javascript">hljs.initHighlightingOnLoad();</script>
<script type="text/javascript" src="//vjs.zencdn.net/5.9.2/video.js"></script>
<script type="text/javascript" src="/js/sha1.js"></script>
<script type="text/javascript" src="/js/core-min.js"></script>
<script type="text/javascript" src="/js/enc-base64-min.js"></script>
<script type="text/javascript" src="js/biginteger.js"></script>
<script type="text/javascript">
	$(function () {
		"use strict";

		var qr_codes = [null, "1fQArOSgpdSCBr8zXove", "P2kVqrkD2ykiNcwWAAKv", "FUYEMZoOCLis7tPvs5pq", "dLYFunszMowTRHovQx2y", "X8pfJTkxJeRX0bMHZsTP", "mGMzyuWnqVnC014Irq5S", "3OgwkgZmzaFUvPBwnKr8", "B6gZYdONrcSnRlDlvQ03", "vgOObZR6VjxuwRkBVm2F", "QOXm6kvOYt3ATkc9rDnk", "wjlKxyRNWcLnyhdXhHCV", "kR4ZCgRneYR27YAYr8eE", "Jvl8olPUI9yfuJDWIJFi", "Qa5miycTGMkfXUe1iOeJ", "JMv1xX8LZGM0VspECD1b", "7dUDQDhMQkLYsQTMJq62", "nYa3ktAoTAQc6yxMAGoM", "83OHadUPAeWRfd6YBv6t", "WCeZB8yUTdgjayQol2KS", "PRKuX3CklkoZWwfOHbpK", "cH3zySmRf29wCQpE7FSK", "Jbpfr31iCjbpThSfHk6i", "mwBDDBrer7qemsD7RDSf", "avHJJ56JeUvZ8fr7wkGB"];
		for (var i=1; i<qr_codes.length; i++) {
			var lvl = (i<10)?("0"+i):i;
			var elem = $("<span>");
			var diff = null;
			if (1<=i && i<=9) {
				diff = "easy";
			} else if (10<=i && i<=18) {
				diff = "medium";
			} else {
				diff = "hard";
			}
			$(elem).attr("class", "eggImage "+diff+"Egg");
			$(elem).append("<span class='eggTitle'>"+lvl+"</span>");
			$(elem).append("<span id='egg-lvl"+lvl+"' class='eggQR'></span>");
			$("#eggs").append(elem);
			$("#eggs #egg-lvl"+lvl).qrcode({
				size: 75,
				left: 0, top: 0, fill: "#000",
				text: qr_codes[i],
				label: qr_codes[i]
			});
		}
	});
</script>
</body></html>
